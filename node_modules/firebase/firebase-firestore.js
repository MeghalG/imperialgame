!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(sg){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l,e=t(sg),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ie=l=l||{})[Ie.DEBUG=0]="DEBUG",Ie[Ie.VERBOSE=1]="VERBOSE",Ie[Ie.INFO=2]="INFO",Ie[Ie.WARN=3]="WARN",Ie[Ie.ERROR=4]="ERROR",Ie[Ie.SILENT=5]="SILENT";function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,u(["["+i+"]  "+t.name+":"],n))}}var o={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((Ee={})[l.DEBUG]="log",Ee[l.VERBOSE]="log",Ee[l.INFO]="info",Ee[l.WARN]="warn",Ee[l.ERROR]="error",Ee),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.DEBUG],t)),this._logHandler.apply(this,u([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.VERBOSE],t)),this._logHandler.apply(this,u([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.INFO],t)),this._logHandler.apply(this,u([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.WARN],t)),this._logHandler.apply(this,u([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.ERROR],t)),this._logHandler.apply(this,u([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=i,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O={},S=N||self;function D(){}function x(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),R=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function L(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:L).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function U(){return Date.now()}function j(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,P)&&t[P]||(t[P]=++R))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var W,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:e<t?1:0}t:{var X=S.navigator;if(X){X=X.userAgent;if(X){W=X;break t}}W=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=Y(W,"Opera"),it=Y(W,"Trident")||Y(W,"MSIE"),ot=Y(W,"Edge"),st=ot||it,ut=Y(W,"Gecko")&&!(Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge"))&&!(Y(W,"Trident")||Y(W,"MSIE"))&&!Y(W,"Edge"),at=Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge");function ct(){var t=S.document;return t?t.documentMode:void 0}t:{var ht="",ft=(ft=W,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(ht=ft?ft[1]:""),it){ft=ct();if(null!=ft&&ft>parseFloat(ht)){nt=String(ft);break t}}nt=ht}var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=H(String(nt)).split("."),n=H(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Q(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Q(0==o[2].length,0==s[2].length)||Q(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var dt=S.document&&it?ct()||(parseInt(nt,10)||void 0):void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},j(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var _t="closure_listenable_"+(1e6*Math.random()|0),It=0;function Et(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function Tt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Tt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Et(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var St="closure_lm_"+(1e6*Math.random()|0),Dt={};function xt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Ut(r);return e&&e[_t]?e.wa(n,r,k(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)xt(t,e[o],n,r,i);return null}return n=Ut(n),t&&t[_t]?t.va(e,n,k(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=Vt(t);if(c||(t[St]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Lt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[_t]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Vt(e))?(Nt(n,t),0==n.b&&(n.src=null,e[St]=null)):Tt(t)))}function Rt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Ct(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Pt(t),n.call(r,e)}function Lt(t,e){if(t.Y)return!0;if(yt)return Ct(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ct(t,e=new wt(e,this))}function Vt(t){return(t=t[St])instanceof At?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ut(e){return"function"==typeof e?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function jt(){q.call(this),this.c=new At(this),(this.J=this).C=null}function qt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new mt(e,t):e instanceof mt?e.target=e.target||t:(s=e,tt(e=new mt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Ft(o,r,!0,e)&&s;if(s=Ft(o=e.a=t,r,!0,e)&&s,s=Ft(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Ft(o=e.a=n[i],r,!1,e)&&s}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,q),jt.prototype[_t]=!0,(A=jt.prototype).addEventListener=function(t,e,n,r){xt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=Ut(r),e&&e[_t]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(Tt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Vt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&Pt(r))}(this,t,e,n,r)},A.G=function(){if(jt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Tt(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=S.JSON.stringify;function zt(){this.b=this.a=null}var Gt,Kt=(Wt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Wt(function(){return new Ht},function(t){t.reset()}));function Wt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Ht(){this.next=this.b=this.a=null}function Yt(t,e){var n;Gt||(n=S.Promise.resolve(void 0),Gt=function(){n.then(Jt)}),Qt||(Gt(),Qt=!0),Xt.add(t,e)}zt.prototype.add=function(t,e){var n=Kt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ht.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Qt=!(Ht.prototype.reset=function(){this.next=this.b=this.a=null}),Xt=new zt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Xt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Kt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Qt=!1}function $t(t,e){jt.call(this),this.b=t||1,this.a=e||S,this.f=V(this.Za,this),this.g=U()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==typeof t)n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}j($t,jt),(A=$t.prototype).aa=!1,A.M=null,A.Za=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),qt(this,"tick"),this.aa&&(Zt(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},A.G=function(){$t.X.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(E(ne=se,re=ee=q),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e){var n=ee.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ue(t){q.call(this),this.b=t,this.a={}}j(ue,q);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=xt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Pt(t)},t),t.a={}}function fe(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Bt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.X.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var pe={},de=null;function ye(){return de=de||new jt}function ve(t){mt.call(this,pe.Fa,t)}function ge(t){var e=ye();qt(e,new ve(e))}function me(t,e){mt.call(this,pe.STAT_EVENT,t),this.stat=e}function we(t){var e=ye();qt(e,new me(e,t))}function be(t){mt.call(this,pe.Ga,t)}function _e(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}pe.Fa="serverreachability",j(ve,mt),pe.STAT_EVENT="statevent",j(me,mt),pe.Ga="timingevent",j(be,mt);var Ie={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Ee={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Te(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Te.prototype.a=null;var Oe,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Se(){mt.call(this,"d")}function De(){mt.call(this,"c")}function xe(){}function ke(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ue(this),this.P=Pe,t=st?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}j(Se,mt),j(De,mt),j(xe,Te),Oe=new xe;var Pe=45e3,Re={},Ce={};function Le(t,e,n){t.H=1,t.i=nn(Xe(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=U(),Ue(t),t.l=Xe(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(V(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Xa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Me(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ce:(i=Number(u.substring(i,o)),isNaN(i)?Re:(o+=1)+i>u.length?Ce:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ce){4==e&&(t.h=4,we(14),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Re){t.h=4,we(15),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),ze(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(le(t.c,t.f,n,"[Invalid Chunked Response]"),Be(t),Fe(t))}function Ue(t){t.T=U()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=_e(V(t.Va,t),e)}function qe(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||ir(t.g,t)}function Be(t){qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function ze(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Wn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=_e(V(u.Sa,u),6e3));if(In(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!K(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=U()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(qe(o),Ue(o)),n.a=i):Zn(n),0<u.g.length&&Qn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Kn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ke(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ke)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=ke.prototype).setTimeout=function(t){this.P=t},A.Xa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),qe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Be(this),Fe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,ze(this,s)}this.I?(Me(this,e,n),st&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Wa),this.R.start())):(le(this.c,this.f,n,null),ze(this,n)),4==e&&Be(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Be(this),Fe(this)}}}catch(t){}var u,a,c,h,f,l},A.Wa=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(qe(this),Me(this,t,e),this.b&&4!=t&&Ue(this)))},A.cancel=function(){this.A=!0,Be(this)},A.Va=function(){this.o=null;var t,e,n=U();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Be(this),this.h=2,Fe(this)):je(this,this.T-n)},(A=Ke.prototype).K=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return We(this),this.a.concat()},A.get=function(t,e){return He(this.b,t)?this.b[t]:e},A.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Qe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Qe?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new Ke(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Xe(t){return new Qe(t)}function Je(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Qe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new Ke,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function yn(t,e){return pn(t),e=gn(t,e),He(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),G(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(A=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=z(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},A.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=function(t,e){this.b=t,this.a=e};function wn(t){this.g=t||bn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var bn=10;function _n(t){return t.b||t.a&&t.a.size>=t.f}function In(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function On(){}function Sn(){this.a=new On}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},On.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},On.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var xn=S.JSON.parse;function kn(t){jt.call(this),this.headers=new Ke,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}j(kn,jt);var Pn="",Rn=/^https?$/i,Cn=["POST","PUT"];function Ln(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Mn(t),jn(t)}function Mn(t){t.u||(t.u=!0,qt(t,"complete"),qt(t,"error"))}function Un(t){if(t.b&&void 0!==O&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))te(t.za,0,t);else if(qt(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(Ye)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Rn.test(i?i.toLowerCase():"")),e=n);if(e)qt(t,"complete"),qt(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Mn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||qt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function zn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=zn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=zn("baseRetryDelayMs",5e3,t),this.Ra=zn("retryDelaySeedMs",1e4,t),this.Ma=zn("forwardChannelMaxRetries",2,t),this.ma=zn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Kn(t){var e,n;Hn(t),3==t.v&&(e=t.R++,en(n=Xe(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Jn(t,n),(e=new ke(t,t.c,e,void 0)).H=2,e.i=nn(Xe(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=U(),Ue(e)),ur(t)}function Wn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Hn(t){Wn(t),t.j&&(S.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new mn(t.Oa++,e)),3==t.v&&Qn(t)}function Qn(t){_n(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Jn(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new ke(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),Le(n,r,e)}function Jn(t,n){t.f&&Ge({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Ge(t,function(t,e){var n=t;k(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Yt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=_e(V(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new ke(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Jn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Xe(e)),n.j=null,n.I=!0,Ve(n,t)}function rr(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=U()-e.u,n=t.u,qt(i=ye(),new be(i)),Qn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(In(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)))return t.h=_e(V(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=V(t.Ya,t),r||(r=new Qe("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Je(r,"https"),nn(r)),n=r.toString(),r=o,o=new fe,S.Image?((i=new Image).onload=M(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Dn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Hn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,G(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Qe?Xe(s):new Qe(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=S.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Qe(null,void 0),r&&Je(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&J(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Jn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.Na)).F=t.C,e}function hr(){}function fr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function lr(t,e){jt.call(this),this.a=new Gn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){De.call(this),this.status=1}function yr(t){this.a=t}(A=kn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(Oe),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Ke(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Ln,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=F(Cn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},A.xa=function(){void 0!==O&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,qt(this,"timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,qt(this,"complete"),qt(this,"abort"),jn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),kn.X.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Un(this):this.Ua())},A.Ua=function(){Un(this)},A.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Gn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ke(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Xe(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Jn(this,i),this.i&&r&&Bn(i,this.i,r),Tn(this.b,n),this.Ia&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Le(n,i,null)):Le(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||_n(this.b)||Xn(this))},A.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=_e(V(this.Ta,this),t))},A.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Wn(this),nr(this))},A.Sa=function(){null!=this.m&&(this.m=null,Wn(this),tr(this),we(19))},A.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(A=hr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ja=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},j(lr,jt),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Qn(t)},lr.prototype.close=function(){Kn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.l?((e={}).__data__=Bt(t),Yn(this.a,e)):Yn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,Kn(this.a),delete this.a,lr.X.G.call(this)},j(pr,Se),j(dr,De),j(yr,hr),yr.prototype.ta=function(){qt(this.a,"a")},yr.prototype.sa=function(t){qt(this.a,new pr(t))},yr.prototype.ra=function(t){qt(this.a,new dr)},yr.prototype.qa=function(){qt(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ne.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",jt.prototype.listen=jt.prototype.va,kn.prototype.listenOnce=kn.prototype.wa,kn.prototype.getLastError=kn.prototype.Qa,kn.prototype.getLastErrorCode=kn.prototype.ua,kn.prototype.getStatus=kn.prototype.W,kn.prototype.getResponseJson=kn.prototype.Pa,kn.prototype.getResponseText=kn.prototype.$,kn.prototype.send=kn.prototype.ba;var vr=ye,gr=Ie,mr=Ee,wr=pe,br=10,_r=11,Ir=Ne,Er=kn,Tr=(Ar.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ar.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ar.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ar);function Ar(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Nr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Or=(Object.defineProperty(xr.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),xr.prototype.isEqual=function(t){return t instanceof xr&&t.projectId===this.projectId&&t.database===this.database},xr),Sr=(Dr.prototype.u=function(){return null!=this.uid},Dr.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},Dr.prototype.isEqual=function(t){return t.uid===this.uid},Dr);function Dr(t){this.uid=t}function xr(t,e){this.projectId=t,this.database=e||"(default)"}Sr.UNAUTHENTICATED=new Sr(null),Sr.l=new Sr("google-credentials-uid"),Sr._=new Sr("first-party-uid");var kr=new h("@firebase/firestore");function Pr(){return kr.logLevel}function Rr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=l.DEBUG&&(e=n.map(Vr),kr.debug.apply(kr,s(["Firestore (8.1.1): "+t],e)))}function Cr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=l.ERROR&&(e=n.map(Vr),kr.error.apply(kr,s(["Firestore (8.1.1): "+t],e)))}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=l.WARN&&(e=n.map(Vr),kr.warn.apply(kr,s(["Firestore (8.1.1): "+t],e)))}function Vr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Mr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE (8.1.1) INTERNAL ASSERTION FAILED: "+t;throw Cr(t),new Error(t)}function Ur(t){t||Mr()}function jr(t,e){this.user=e,this.type="OAuth",this.T={},this.T.Authorization="Bearer "+t}var qr,Fr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Br=(n(Jr,qr=Error),Jr),zr=(Xr.prototype.getToken=function(){return Promise.resolve(null)},Xr.prototype.m=function(){},Xr.prototype.A=function(t){(this.I=t)(Sr.UNAUTHENTICATED)},Xr.prototype.R=function(){this.I=null},Xr),Gr=(Qr.prototype.getToken=function(){var e=this,n=this.V,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.V!==n?(Rr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Ur("string"==typeof t.accessToken),new jr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Qr.prototype.m=function(){this.forceRefresh=!0},Qr.prototype.A=function(t){this.I=t,this.g&&t(this.currentUser)},Qr.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.I=null},Qr.prototype.p=function(){var t=this.auth&&this.auth.getUid();return Ur(null===t||"string"==typeof t),new Sr(t)},Qr),Kr=(Object.defineProperty(Yr.prototype,"T",{get:function(){var t={"X-Goog-AuthUser":this.S},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Yr),Wr=(Hr.prototype.getToken=function(){return Promise.resolve(new Kr(this.v,this.S))},Hr.prototype.A=function(t){t(Sr._)},Hr.prototype.R=function(){},Hr.prototype.m=function(){},Hr);function Hr(t,e){this.v=t,this.S=e}function Yr(t,e){this.v=t,this.S=e,this.type="FirstParty",this.user=Sr._}function Qr(t){var e=this;this.P=null,this.currentUser=Sr.UNAUTHENTICATED,this.g=!1,this.V=0,this.I=null,this.forceRefresh=!1,this.P=function(){e.V++,e.currentUser=e.p(),e.g=!0,e.I&&e.I(e.currentUser)},this.V=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}function Xr(){this.I=null}function Jr(t,e){var n=this;return(n=qr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var $r=(Zr.D=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Zr);function Zr(){}function ti(t,e){return t<e?-1:e<t?1:0}function ei(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function ni(t){return t+"\0"}var ri,ii,oi=(vi.now=function(){return vi.fromMillis(Date.now())},vi.fromDate=function(t){return vi.fromMillis(t.getTime())},vi.fromMillis=function(t){var e=Math.floor(t/1e3);return new vi(e,1e6*(t-1e3*e))},vi.prototype.toDate=function(){return new Date(this.toMillis())},vi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},vi.prototype.C=function(t){return this.seconds===t.seconds?ti(this.nanoseconds,t.nanoseconds):ti(this.seconds,t.seconds)},vi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},vi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},vi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},vi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},vi),si=(yi.N=function(t){return new yi(t)},yi.min=function(){return new yi(new oi(0,0))},yi.prototype.F=function(t){return this.timestamp.C(t.timestamp)},yi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},yi.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},yi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},yi.prototype.M=function(){return this.timestamp},yi),Ie=(Object.defineProperty(di.prototype,"length",{get:function(){return this.k},enumerable:!1,configurable:!0}),di.prototype.isEqual=function(t){return 0===di.$(this,t)},di.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof di?t.forEach(function(t){e.push(t)}):e.push(t),this.L(e)},di.prototype.limit=function(){return this.offset+this.length},di.prototype.B=function(t){return t=void 0===t?1:t,this.L(this.segments,this.offset+t,this.length-t)},di.prototype.q=function(){return this.L(this.segments,this.offset,this.length-1)},di.prototype.U=function(){return this.segments[this.offset]},di.prototype.K=function(){return this.get(this.length-1)},di.prototype.get=function(t){return this.segments[this.offset+t]},di.prototype.W=function(){return 0===this.length},di.prototype.j=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},di.prototype.G=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},di.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},di.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},di.$=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},di),ui=(n(pi,ii=Ie),pi.prototype.L=function(t,e,n){return new pi(t,e,n)},pi.prototype.J=function(){return this.H().join("/")},pi.prototype.toString=function(){return this.J()},pi.Y=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Br(Fr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new pi(n)},pi.X=function(){return new pi([])},pi),ai=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ci=(n(li,ri=Ie),li.prototype.L=function(t,e,n){return new li(t,e,n)},li.Z=function(t){return ai.test(t)},li.prototype.J=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),li.Z(t)||(t="`"+t+"`"),t}).join(".")},li.prototype.toString=function(){return this.J()},li.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},li.et=function(){return new li(["__name__"])},li.nt=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Br(Fr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Br(Fr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Br(Fr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Br(Fr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new li(e)},li.X=function(){return new li([])},li),hi=(fi.st=function(t){return new fi(ui.Y(t))},fi.it=function(t){return new fi(ui.Y(t).B(5))},fi.prototype.rt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},fi.prototype.isEqual=function(t){return null!==t&&0===ui.$(this.path,t.path)},fi.prototype.toString=function(){return this.path.toString()},fi.$=function(t,e){return ui.$(t.path,e.path)},fi.ot=function(t){return t.length%2==0},fi.ct=function(t){return new fi(new ui(t.slice()))},fi);function fi(t){this.path=t}function li(){return null!==ri&&ri.apply(this,arguments)||this}function pi(){return null!==ii&&ii.apply(this,arguments)||this}function di(t,e,n){void 0===e?e=0:e>t.length&&Mr(),void 0===n?n=t.length-e:n>t.length-e&&Mr(),this.segments=t,this.offset=e,this.k=n}function yi(t){this.timestamp=t}function vi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Br(Fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Br(Fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Br(Fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Br(Fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function gi(t){return null==t}function mi(t){return 0===t&&1/t==-1/0}function wi(t){return"number"==typeof t&&Number.isInteger(t)&&!mi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var bi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ut=null};function _i(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new bi(t,e,n,r,i,o,s)}function Ii(t){var e=t;return null===e.ut&&(t=e.path.J(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.J()+t.op.toString()+Oo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.J()+t.dir}).join(","),gi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ia(e.startAt)),e.endAt&&(t+="|ub:",t+=ia(e.endAt)),e.ut=t),e.ut}function Ei(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Eo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!sa(t.startAt,e.startAt)&&sa(t.endAt,e.endAt)}function Ti(t){return hi.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ai=(Ni.fromBase64String=function(t){return new Ni(atob(t))},Ni.fromUint8Array=function(t){return new Ni(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ni.prototype.toBase64=function(){return t=this.at,btoa(t);var t},Ni.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},Ni.prototype.ht=function(){return 2*this.at.length},Ni.prototype.F=function(t){return ti(this.at,t.at)},Ni.prototype.isEqual=function(t){return this.at===t.at},Ni);function Ni(t){this.at=t}Ai.lt=new Ai("");function Oi(t){this.count=t}var Si,Di=(xi.prototype.dt=function(t){return new xi(this.target,this.targetId,this._t,t,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},xi.prototype.wt=function(t,e){return new xi(this.target,this.targetId,this._t,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},xi.prototype.Et=function(t){return new xi(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,t,this.resumeToken)},xi);function xi(t,e,n,r,i,o,s){void 0===i&&(i=si.min()),void 0===o&&(o=si.min()),void 0===s&&(s=Ai.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function ki(t){switch(t){case Fr.OK:return Mr(),0;case Fr.CANCELLED:case Fr.UNKNOWN:case Fr.DEADLINE_EXCEEDED:case Fr.RESOURCE_EXHAUSTED:case Fr.INTERNAL:case Fr.UNAVAILABLE:case Fr.UNAUTHENTICATED:return;case Fr.INVALID_ARGUMENT:case Fr.NOT_FOUND:case Fr.ALREADY_EXISTS:case Fr.PERMISSION_DENIED:case Fr.FAILED_PRECONDITION:case Fr.ABORTED:case Fr.OUT_OF_RANGE:case Fr.UNIMPLEMENTED:case Fr.DATA_LOSS:return 1;default:return Mr(),0}}function Pi(t){if(void 0===t)return Cr("GRPC error has no .code"),Fr.UNKNOWN;switch(t){case Si.OK:return Fr.OK;case Si.CANCELLED:return Fr.CANCELLED;case Si.UNKNOWN:return Fr.UNKNOWN;case Si.DEADLINE_EXCEEDED:return Fr.DEADLINE_EXCEEDED;case Si.RESOURCE_EXHAUSTED:return Fr.RESOURCE_EXHAUSTED;case Si.INTERNAL:return Fr.INTERNAL;case Si.UNAVAILABLE:return Fr.UNAVAILABLE;case Si.UNAUTHENTICATED:return Fr.UNAUTHENTICATED;case Si.INVALID_ARGUMENT:return Fr.INVALID_ARGUMENT;case Si.NOT_FOUND:return Fr.NOT_FOUND;case Si.ALREADY_EXISTS:return Fr.ALREADY_EXISTS;case Si.PERMISSION_DENIED:return Fr.PERMISSION_DENIED;case Si.FAILED_PRECONDITION:return Fr.FAILED_PRECONDITION;case Si.ABORTED:return Fr.ABORTED;case Si.OUT_OF_RANGE:return Fr.OUT_OF_RANGE;case Si.UNIMPLEMENTED:return Fr.UNIMPLEMENTED;case Si.DATA_LOSS:return Fr.DATA_LOSS;default:return Mr()}}(Ee=Si=Si||{})[Ee.OK=0]="OK",Ee[Ee.CANCELLED=1]="CANCELLED",Ee[Ee.UNKNOWN=2]="UNKNOWN",Ee[Ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ee[Ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ee[Ee.NOT_FOUND=5]="NOT_FOUND",Ee[Ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ee[Ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ee[Ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ee[Ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ee[Ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ee[Ee.ABORTED=10]="ABORTED",Ee[Ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ee[Ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ee[Ee.INTERNAL=13]="INTERNAL",Ee[Ee.UNAVAILABLE=14]="UNAVAILABLE",Ee[Ee.DATA_LOSS=15]="DATA_LOSS";var Ri=(Ui.prototype.Tt=function(t,e){return new Ui(this.$,this.root.Tt(t,e,this.$).copy(null,null,Li.It,null,null))},Ui.prototype.remove=function(t){return new Ui(this.$,this.root.remove(t,this.$).copy(null,null,Li.It,null,null))},Ui.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.$(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ui.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.$(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ui.prototype.W=function(){return this.root.W()},Object.defineProperty(Ui.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ui.prototype.At=function(){return this.root.At()},Ui.prototype.Rt=function(){return this.root.Rt()},Ui.prototype.Pt=function(t){return this.root.Pt(t)},Ui.prototype.forEach=function(n){this.Pt(function(t,e){return n(t,e),!1})},Ui.prototype.toString=function(){var n=[];return this.Pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ui.prototype.gt=function(t){return this.root.gt(t)},Ui.prototype.yt=function(){return new Ci(this.root,null,this.$,!1)},Ui.prototype.Vt=function(t){return new Ci(this.root,t,this.$,!1)},Ui.prototype.vt=function(){return new Ci(this.root,null,this.$,!0)},Ui.prototype.bt=function(t){return new Ci(this.root,t,this.$,!0)},Ui),Ci=(Mi.prototype.Ct=function(){var t=this.Dt.pop(),e={key:t.key,value:t.value};if(this.St)for(t=t.left;!t.W();)this.Dt.push(t),t=t.right;else for(t=t.right;!t.W();)this.Dt.push(t),t=t.left;return e},Mi.prototype.Nt=function(){return 0<this.Dt.length},Mi.prototype.xt=function(){if(0===this.Dt.length)return null;var t=this.Dt[this.Dt.length-1];return{key:t.key,value:t.value}},Mi),Li=(Vi.prototype.copy=function(t,e,n,r,i){return new Vi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Vi.prototype.W=function(){return!1},Vi.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},Vi.prototype.gt=function(t){return this.right.gt(t)||t(this.key,this.value)||this.left.gt(t)},Vi.prototype.min=function(){return this.left.W()?this:this.left.min()},Vi.prototype.At=function(){return this.min().key},Vi.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},Vi.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},Vi.prototype.Ot=function(){if(this.left.W())return Vi.EMPTY;var t=this;return t.left.Mt()||t.left.left.Mt()||(t=t.kt()),(t=t.copy(null,null,null,t.left.Ot(),null)).Ft()},Vi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.W()||r.left.Mt()||r.left.left.Mt()||(r=r.kt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Mt()&&(r=r.$t()),r.right.W()||r.right.Mt()||r.right.left.Mt()||(r=r.Lt()),0===e(t,r.key)){if(r.right.W())return Vi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Ot())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ft()},Vi.prototype.Mt=function(){return this.color},Vi.prototype.Ft=function(){var t=this;return t.right.Mt()&&!t.left.Mt()&&(t=t.Bt()),t.left.Mt()&&t.left.left.Mt()&&(t=t.$t()),t.left.Mt()&&t.right.Mt()&&(t=t.qt()),t},Vi.prototype.kt=function(){var t=this.qt();return t.right.left.Mt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.$t())).Bt()).qt()),t},Vi.prototype.Lt=function(){var t=this.qt();return t.left.left.Mt()&&(t=(t=t.$t()).qt()),t},Vi.prototype.Bt=function(){var t=this.copy(null,null,Vi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Vi.prototype.$t=function(){var t=this.copy(null,null,Vi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Vi.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Vi.prototype.Ut=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},Vi.prototype.Qt=function(){if(this.Mt()&&this.left.Mt())throw Mr();if(this.right.Mt())throw Mr();var t=this.left.Qt();if(t!==this.right.Qt())throw Mr();return t+(this.Mt()?0:1)},Vi);function Vi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Vi.RED,this.left=null!=r?r:Vi.EMPTY,this.right=null!=i?i:Vi.EMPTY,this.size=this.left.size+1+this.right.size}function Mi(t,e,n,r){this.St=r,this.Dt=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.St?t.left:t.right;else{if(0===i){this.Dt.push(t);break}this.Dt.push(t),t=this.St?t.right:t.left}}function Ui(t,e){this.$=t,this.root=e||Li.EMPTY}function ji(){this.size=0}Li.EMPTY=null,Li.RED=!0,Li.It=!1,Li.EMPTY=(Object.defineProperty(ji.prototype,"key",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"value",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"color",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"left",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"right",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),ji.prototype.copy=function(t,e,n,r,i){return this},ji.prototype.Tt=function(t,e,n){return new Li(t,e)},ji.prototype.remove=function(t,e){return this},ji.prototype.W=function(){return!0},ji.prototype.Pt=function(t){return!1},ji.prototype.gt=function(t){return!1},ji.prototype.At=function(){return null},ji.prototype.Rt=function(){return null},ji.prototype.Mt=function(){return!1},ji.prototype.Ut=function(){return!0},ji.prototype.Qt=function(){return 0},new ji);var qi=(Gi.prototype.has=function(t){return null!==this.data.get(t)},Gi.prototype.first=function(){return this.data.At()},Gi.prototype.last=function(){return this.data.Rt()},Object.defineProperty(Gi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Gi.prototype.indexOf=function(t){return this.data.indexOf(t)},Gi.prototype.forEach=function(n){this.data.Pt(function(t,e){return n(t),!1})},Gi.prototype.Kt=function(t,e){for(var n=this.data.Vt(t[0]);n.Nt();){var r=n.Ct();if(0<=this.$(r.key,t[1]))return;e(r.key)}},Gi.prototype.Wt=function(t,e){for(var n=void 0!==e?this.data.Vt(e):this.data.yt();n.Nt();)if(!t(n.Ct().key))return},Gi.prototype.jt=function(t){t=this.data.Vt(t);return t.Nt()?t.Ct().key:null},Gi.prototype.yt=function(){return new Fi(this.data.yt())},Gi.prototype.Vt=function(t){return new Fi(this.data.Vt(t))},Gi.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},Gi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Gi.prototype.W=function(){return this.data.W()},Gi.prototype.Gt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Gi.prototype.isEqual=function(t){if(!(t instanceof Gi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.yt(),n=t.data.yt();e.Nt();){var r=e.Ct().key,i=n.Ct().key;if(0!==this.$(r,i))return!1}return!0},Gi.prototype.H=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Gi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Gi.prototype.copy=function(t){var e=new Gi(this.$);return e.data=t,e},Gi),Fi=(zi.prototype.Ct=function(){return this.zt.Ct().key},zi.prototype.Nt=function(){return this.zt.Nt()},zi),Bi=new Ri(hi.$);function zi(t){this.zt=t}function Gi(t){this.$=t,this.data=new Ri(this.$)}var Ki=new Ri(hi.$);var Wi=new Ri(hi.$),Hi=new qi(hi.$);function Yi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Hi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Qi=new qi(ti);var Xi=(lo.Yt=function(t){return new lo(t.$)},lo.prototype.has=function(t){return null!=this.Ht.get(t)},lo.prototype.get=function(t){return this.Ht.get(t)},lo.prototype.first=function(){return this.Jt.At()},lo.prototype.last=function(){return this.Jt.Rt()},lo.prototype.W=function(){return this.Jt.W()},lo.prototype.indexOf=function(t){t=this.Ht.get(t);return t?this.Jt.indexOf(t):-1},Object.defineProperty(lo.prototype,"size",{get:function(){return this.Jt.size},enumerable:!1,configurable:!0}),lo.prototype.forEach=function(n){this.Jt.Pt(function(t,e){return n(t),!1})},lo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Jt.Tt(t,null))},lo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Jt.remove(e)):this},lo.prototype.isEqual=function(t){if(!(t instanceof lo))return!1;if(this.size!==t.size)return!1;for(var e=this.Jt.yt(),n=t.Jt.yt();e.Nt();){var r=e.Ct().key,i=n.Ct().key;if(!r.isEqual(i))return!1}return!0},lo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},lo.prototype.copy=function(t,e){var n=new lo;return n.$=this.$,n.Ht=t,n.Jt=e,n},lo),Ji=(fo.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);!n||0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):Mr()},fo.prototype.Zt=function(){var n=[];return this.Xt.Pt(function(t,e){n.push(e)}),n},fo),$i=(ho.ie=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new ho(t,e,Xi.Yt(e),i,n,r,!0,!1)},Object.defineProperty(ho.prototype,"hasPendingWrites",{get:function(){return!this.ee.W()},enumerable:!1,configurable:!0}),ho.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ne===t.ne&&this.ee.isEqual(t.ee)&&Ou(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.te.isEqual(t.te)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},ho),Zi=(co.ae=function(t,e){var n=new Map;return n.set(t,to.he(t,e)),new co(si.min(),n,Qi,Bi,Yi())},co),to=(ao.he=function(t,e){return new ao(Ai.lt,e,Yi(),Yi(),Yi())},ao),eo=function(t,e,n,r){this.we=t,this.removedTargetIds=e,this.key=n,this.Ee=r},no=function(t,e){this.targetId=t,this.Te=e},ro=function(t,e,n,r){void 0===n&&(n=Ai.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},io=(Object.defineProperty(uo.prototype,"le",{get:function(){return this.Re},enumerable:!1,configurable:!0}),Object.defineProperty(uo.prototype,"resumeToken",{get:function(){return this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(uo.prototype,"ge",{get:function(){return 0!==this.Ie},enumerable:!1,configurable:!0}),Object.defineProperty(uo.prototype,"ye",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),uo.prototype.Ve=function(t){0<t.ht()&&(this.Pe=!0,this.Ae=t)},uo.prototype.pe=function(){var n=Yi(),r=Yi(),i=Yi();return this.me.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Mr()}}),new to(this.Ae,this.Re,n,r,i)},uo.prototype.ve=function(){this.Pe=!1,this.me=yo()},uo.prototype.be=function(t,e){this.Pe=!0,this.me=this.me.Tt(t,e)},uo.prototype.Se=function(t){this.Pe=!0,this.me=this.me.remove(t)},uo.prototype.De=function(){this.Ie+=1},uo.prototype.Ce=function(){--this.Ie},uo.prototype.Ne=function(){this.Pe=!0,this.Re=!0},uo),oo=(so.prototype.$e=function(t){for(var e=0,n=t.we;e<n.length;e++){var r=n[e];t.Ee instanceof hu?this.Le(r,t.Ee):t.Ee instanceof fu&&this.Be(r,t.key,t.Ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Be(s,t.key,t.Ee)}},so.prototype.qe=function(n){var r=this;this.Ue(n,function(t){var e=r.Qe(t);switch(n.state){case 0:r.Ke(t)&&e.Ve(n.resumeToken);break;case 1:e.Ce(),e.ge||e.ve(),e.Ve(n.resumeToken);break;case 2:e.Ce(),e.ge||r.removeTarget(t);break;case 3:r.Ke(t)&&(e.Ne(),e.Ve(n.resumeToken));break;case 4:r.Ke(t)&&(r.We(t),e.Ve(n.resumeToken));break;default:Mr()}})},so.prototype.Ue=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Fe.forEach(function(t,e){r.Ke(e)&&n(e)})},so.prototype.je=function(t){var e=t.targetId,n=t.Te.count,t=this.Ge(e);t&&(Ti(t=t.target)?0===n?(t=new hi(t.path),this.Be(e,t,new fu(t,si.min()))):Ur(1===n):this.ze(e)!==n&&(this.We(e),this.ke=this.ke.add(e)))},so.prototype.He=function(r){var i=this,o=new Map;this.Fe.forEach(function(t,e){var n=i.Ge(e);n&&(t.le&&Ti(n.target)&&(n=new hi(n.target.path),null!==i.Oe.get(n)||i.Je(e,n)||i.Be(e,n,new fu(n,r))),t.ye&&(o.set(e,t.pe()),t.ve()))});var s=Yi();this.Me.forEach(function(t,e){var n=!0;e.Wt(function(t){t=i.Ge(t);return!t||2===t._t||(n=!1)}),n&&(s=s.add(t))});var t=new Zi(r,o,this.ke,this.Oe,s);return this.Oe=Bi,this.Me=po(),this.ke=new qi(ti),t},so.prototype.Le=function(t,e){var n;this.Ke(t)&&(n=this.Je(t,e.key)?2:0,this.Qe(t).be(e.key,n),this.Oe=this.Oe.Tt(e.key,e),this.Me=this.Me.Tt(e.key,this.Ye(e.key).add(t)))},so.prototype.Be=function(t,e,n){var r;this.Ke(t)&&(r=this.Qe(t),this.Je(t,e)?r.be(e,1):r.Se(e),this.Me=this.Me.Tt(e,this.Ye(e).delete(t)),n&&(this.Oe=this.Oe.Tt(e,n)))},so.prototype.removeTarget=function(t){this.Fe.delete(t)},so.prototype.ze=function(t){var e=this.Qe(t).pe();return this.xe.Xe(t).size+e._e.size-e.de.size},so.prototype.De=function(t){this.Qe(t).De()},so.prototype.Qe=function(t){var e=this.Fe.get(t);return e||(e=new io,this.Fe.set(t,e)),e},so.prototype.Ye=function(t){var e=this.Me.get(t);return e||(e=new qi(ti),this.Me=this.Me.Tt(t,e)),e},so.prototype.Ke=function(t){var e=null!==this.Ge(t);return e||Rr("WatchChangeAggregator","Detected inactive target",t),e},so.prototype.Ge=function(t){var e=this.Fe.get(t);return e&&e.ge?null:this.xe.Ze(t)},so.prototype.We=function(e){var n=this;this.Fe.set(e,new io),this.xe.Xe(e).forEach(function(t){n.Be(e,t,null)})},so.prototype.Je=function(t,e){return this.xe.Xe(t).has(e)},so);function so(t){this.xe=t,this.Fe=new Map,this.Oe=Bi,this.Me=po(),this.ke=new qi(ti)}function uo(){this.Ie=0,this.me=yo(),this.Ae=Ai.lt,this.Re=!1,this.Pe=!0}function ao(t,e,n,r,i){this.resumeToken=t,this.le=e,this._e=n,this.fe=r,this.de=i}function co(t,e,n,r,i){this.ft=t,this.re=e,this.oe=n,this.ce=r,this.ue=i}function ho(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.te=n,this.docChanges=r,this.ee=i,this.fromCache=o,this.ne=s,this.se=u}function fo(){this.Xt=new Ri(hi.$)}function lo(n){this.$=n?function(t,e){return n(t,e)||hi.$(t.key,e.key)}:function(t,e){return hi.$(t.key,e.key)},this.Ht=Ki,this.Jt=new Ri(this.$)}function po(){return new Ri(hi.$)}function yo(){return new Ri(hi.$)}function vo(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function go(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function mo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function wo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function bo(t){t=So(t.mapValue.fields.__local_write_time__.timestampValue);return new oi(t.seconds,t.nanos)}var _o=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Io(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?wo(t)?4:10:Mr()}function Eo(r,i){var t,e=Io(r);if(e!==Io(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return bo(r).isEqual(bo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=So(r.timestampValue),t=So(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,xo(r.bytesValue).isEqual(xo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Do((t=r).geoPointValue.latitude)===Do(e.geoPointValue.latitude)&&Do(t.geoPointValue.longitude)===Do(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Do(t.integerValue)===Do(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Do(t.doubleValue),e=Do(e.doubleValue);return t===e?mi(t)===mi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return ei(r.arrayValue.values||[],i.arrayValue.values||[],Eo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(vo(e)!==vo(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Eo(e[t],n[t])))return!1;return!0}();default:return Mr()}}function To(t,e){return void 0!==(t.values||[]).find(function(t){return Eo(t,e)})}function Ao(t,e){var n,r,i=Io(t),o=Io(e);if(i!==o)return ti(i,o);switch(i){case 0:return 0;case 1:return ti(t.booleanValue,e.booleanValue);case 2:return n=e,r=Do(t.integerValue||t.doubleValue),n=Do(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return No(t.timestampValue,e.timestampValue);case 4:return No(bo(t),bo(e));case 5:return ti(t.stringValue,e.stringValue);case 6:return function(t,e){t=xo(t),e=xo(e);return t.F(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ti(n[i],r[i]);if(0!==o)return o}return ti(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=ti(Do(i.latitude),Do(r.latitude)))?n:ti(Do(i.longitude),Do(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ao(n[i],r[i]);if(o)return o}return ti(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=ti(r[s],o[s]);if(0!==u)return u;u=Ao(n[r[s]],i[o[s]]);if(0!==u)return u}return ti(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Mr()}}function No(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ti(t,e);var n=So(t),t=So(e),e=ti(n.seconds,t.seconds);return 0!==e?e:ti(n.nanos,t.nanos)}function Oo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=So(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?xo(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,hi.it(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Mr();var e}(t)}function So(t){if(Ur(!!t),"string"!=typeof t)return{seconds:Do(t.seconds),nanos:Do(t.nanos)};var e=0,n=_o.exec(t);Ur(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Do(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function xo(t){return"string"==typeof t?Ai.fromBase64String(t):Ai.fromUint8Array(t)}function ko(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.J()}}function Po(t){return t&&"integerValue"in t}function Ro(t){return!!t&&"arrayValue"in t}function Co(t){return t&&"nullValue"in t}function Lo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vo(t){return t&&"mapValue"in t}var Mo={asc:"ASCENDING",desc:"DESCENDING"},Uo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jo=function(t,e){this.t=t,this.tn=e};function qo(t){return{integerValue:""+t}}function Fo(t,e){if(t.tn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mi(e)?"-0":e}}function Bo(t,e){return wi(e)?qo(e):Fo(t,e)}function zo(t,e){return t.tn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Go(t,e){return t.tn?e.toBase64():e.toUint8Array()}function Ko(t){return Ur(!!t),si.N((t=So(t),new oi(t.seconds,t.nanos)))}function Wo(t,e){return new ui(["projects",t.projectId,"databases",t.database]).child("documents").child(e).J()}function Ho(t){t=ui.Y(t);return Ur(fs(t)),t}function Yo(t,e){return Wo(t.t,e.path)}function Qo(t,e){e=Ho(e);if(e.get(1)!==t.t.projectId)throw new Br(Fr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Br(Fr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new hi(Zo(e))}function Xo(t,e){return Wo(t.t,e)}function Jo(t){t=Ho(t);return 4===t.length?ui.X():Zo(t)}function $o(t){return new ui(["projects",t.t.projectId,"databases",t.t.database]).J()}function Zo(t){return Ur(4<t.length&&"documents"===t.get(4)),t.B(5)}function ts(t,e,n){return{name:Yo(t,e),fields:n.proto.mapValue.fields}}function es(t,e){var n,r,i;if(e instanceof Bs)n={update:ts(t,e.key,e.value)};else if(e instanceof Zs)n={delete:Yo(t,e.key)};else if(e instanceof zs)n={update:ts(t,e.key,e.data),updateMask:(i=e.en,r=[],i.fields.forEach(function(t){return r.push(t.J())}),{fieldPaths:r})};else if(e instanceof Ys)n={transform:{document:Yo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ys)return{fieldPath:t.field.J(),setToServerValue:"REQUEST_TIME"};if(e instanceof vs)return{fieldPath:t.field.J(),appendMissingElements:{values:e.elements}};if(e instanceof _s)return{fieldPath:t.field.J(),removeAllFromArray:{values:e.elements}};if(e instanceof As)return{fieldPath:t.field.J(),increment:e.nn};throw Mr()})}};else{if(!(e instanceof tu))return Mr();n={verify:Yo(t,e.key)}}return e.rn.sn||(n.currentDocument=void 0!==(i=e.rn).updateTime?{updateTime:(e=t,t=i.updateTime,zo(e,t.M()))}:void 0!==i.exists?{exists:i.exists}:Mr()),n}function ns(e,t){var n=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?Rs.updateTime(Ko(o.updateTime)):void 0!==o.exists?Rs.exists(o.exists):Rs.on():Rs.on();if(t.update){t.update.name;var r=Qo(e,t.update.name),i=new eu({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new Ds(o.map(function(t){return ci.nt(t)})));return new zs(r,i,o,n)}return new Bs(r,i,n)}if(t.delete){var s=Qo(e,t.delete);return new Zs(s,n)}if(t.transform){i=Qo(e,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Ur("REQUEST_TIME"===e.setToServerValue),r=new ys):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new vs(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new _s(n)):"increment"in e?r=new As(t,e.increment):Mr();e=ci.nt(e.fieldPath);return new xs(e,r)}(e,t)});return Ur(!0===n.exists),new Ys(i,s)}if(t.verify){t=Qo(e,t.verify);return new tu(t,n)}return Mr()}function rs(t,e){return{documents:[Xo(t,e.path)]}}function is(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Xo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Xo(t,r.q()),n.structuredQuery.from=[{collectionId:r.K()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Lo(t.value))return{unaryFilter:{field:as(t.field),op:"IS_NAN"}};if(Co(t.value))return{unaryFilter:{field:as(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Lo(t.value))return{unaryFilter:{field:as(t.field),op:"IS_NOT_NAN"}};if(Co(t.value))return{unaryFilter:{field:as(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:as(t.field),op:(e=t.op,Uo[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:as((t=t).field),direction:(t=t.dir,Mo[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.tn||gi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ss(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ss(e.endAt)),n}function os(t){var e=Jo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Ur(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[hs(t)]:void 0!==t.fieldFilter?[(n=t,Ru.create(cs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Mr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Mr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new ua(cs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=gi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=us(n.startAt));var u=null;return n.endAt&&(u=us(n.endAt)),gu(e,i,t,o,r,"F",s,u)}function ss(t){return{before:t.before,values:t.position}}function us(t){var e=!!t.before,t=t.values||[];return new Zu(t,e)}function as(t){return{fieldPath:t.J()}}function cs(t){return ci.nt(t.fieldPath)}function hs(t){switch(t.unaryFilter.op){case"IS_NAN":var e=cs(t.unaryFilter.field);return Ru.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=cs(t.unaryFilter.field);return Ru.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=cs(t.unaryFilter.field);return Ru.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=cs(t.unaryFilter.field);return Ru.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Mr()}}function fs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}h=function(){this.cn=void 0};function ls(t,e){return t instanceof As?Po(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ps,ds,ys=(n(ms,ds=h),ms),vs=(n(gs,ps=h),gs);function gs(t){var e=this;return(e=ps.call(this)||this).elements=t,e}function ms(){return null!==ds&&ds.apply(this,arguments)||this}function ws(t,e){for(var n=Ss(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Eo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var bs,_s=(n(Is,bs=h),Is);function Is(t){var e=this;return(e=bs.call(this)||this).elements=t,e}function Es(t,e){for(var n=Ss(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Eo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Ts,As=(n(Ns,Ts=h),Ns);function Ns(t,e){var n=this;return(n=Ts.call(this)||this).serializer=t,n.nn=e,n}function Os(t){return Do(t.integerValue||t.doubleValue)}function Ss(t){return Ro(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ds=(ks.prototype.un=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].j(t))return!0;return!1},ks.prototype.isEqual=function(t){return ei(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ks),xs=function(t,e){this.field=t,this.transform=e};function ks(t){(this.fields=t).sort(ci.$)}function Ps(t,e){this.version=t,this.transformResults=e}var Rs=(Cs.on=function(){return new Cs},Cs.exists=function(t){return new Cs(void 0,t)},Cs.updateTime=function(t){return new Cs(t)},Object.defineProperty(Cs.prototype,"sn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Cs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Cs);function Cs(t,e){this.updateTime=t,this.exists=e}function Ls(t,e){return void 0!==t.updateTime?e instanceof hu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof hu}Ie=function(){};function Vs(t,e,n){return t instanceof Bs?new hu(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof zs?function(t,e,n){if(!Ls(t.rn,e))return new lu(t.key,n.version);e=Ws(t,e);return new hu(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Ys?function(t,e,n){if(Ur(null!=n.transformResults),!Ls(t.rn,e))return new lu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Ur(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof hu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof vs?ws(o,s):o instanceof _s?Es(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Xs(t,r.data(),e);return new hu(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new fu(t.key,n.version,{hasCommittedMutations:!0})}function Ms(t,e,n,r){return t instanceof Bs?function(t,e){if(!Ls(t.rn,e))return e;e=js(e);return new hu(t.key,e,t.value,{an:!0})}(t,e):t instanceof zs?function(t,e){if(!Ls(t.rn,e))return e;var n=js(e),e=Ws(t,e);return new hu(t.key,n,e,{an:!0})}(t,e):t instanceof Ys?function(t,e,n,r){if(!Ls(t.rn,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof hu&&(h=n.field(a.field)),null===h&&r instanceof hu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof ys?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof vs?ws(c,i):c instanceof _s?Es(c,i):(c=ls(h=c,i),i=Os(c)+Os(h.nn),Po(c)&&Po(h.nn)?qo(i):Fo(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Xs(t,i.data(),r);return new hu(t.key,i.version,r,{an:!0})}(t,e,r,n):(e=e,Ls((t=t).rn,e)?new fu(t.key,si.min()):e)}function Us(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.rn.isEqual(e.rn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.en.isEqual(e.en):2!==t.type||ei(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof vs&&e instanceof vs||t instanceof _s&&e instanceof _s?ei(t.elements,e.elements,Eo):t instanceof As&&e instanceof As?Eo(t.nn,e.nn):t instanceof ys&&e instanceof ys)}))}function js(t){return t instanceof hu?t.version:si.min()}var qs,Fs,Bs=(n(Ks,Fs=Ie),Ks),zs=(n(Gs,qs=Ie),Gs);function Gs(t,e,n,r){var i=this;return(i=qs.call(this)||this).key=t,i.data=e,i.en=n,i.rn=r,i.type=1,i}function Ks(t,e,n){var r=this;return(r=Fs.call(this)||this).key=t,r.value=e,r.rn=n,r.type=0,r}function Ws(t,e){return n=t,e=e instanceof hu?e.data():eu.empty(),r=new nu(e),n.en.fields.forEach(function(t){var e;t.W()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.hn();var n,r}var Hs,Ys=(n(Qs,Hs=Ie),Qs);function Qs(t,e){var n=this;return(n=Hs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.rn=Rs.exists(!0),n}function Xs(t,e,n){for(var r=new nu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.hn()}var Js,$s,Zs=(n(su,$s=Ie),su),tu=(n(ou,Js=Ie),ou),eu=(iu.empty=function(){return new iu({mapValue:{}})},iu.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Vo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.K()])||null},iu.prototype.isEqual=function(t){return Eo(this.proto,t.proto)},iu),nu=(ru.prototype.set=function(t,e){return this.fn(t,e),this},ru.prototype.delete=function(t){return this.fn(t,null),this},ru.prototype.fn=function(t,e){for(var n=this._n,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Io(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.K(),e)},ru.prototype.hn=function(){var t=this.dn(ci.X(),this._n);return null!=t?new eu(t):this.ln},ru.prototype.dn=function(r,t){var i=this,o=!1,e=this.ln.field(r),s=Vo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.dn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},ru);function ru(t){void 0===t&&(t=eu.empty()),this.ln=t,this._n=new Map}function iu(t){this.proto=t}function ou(t,e){var n=this;return(n=Js.call(this)||this).key=t,n.rn=e,n.type=4,n}function su(t,e){var n=this;return(n=$s.call(this)||this).key=t,n.rn=e,n.type=3,n}var uu,au,cu,Ee=function(t,e){this.key=t,this.version=e},hu=(n(vu,cu=Ee),vu.prototype.field=function(t){return this.wn.field(t)},vu.prototype.data=function(){return this.wn},vu.prototype.En=function(){return this.wn.proto},vu.prototype.isEqual=function(t){return t instanceof vu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.an===t.an&&this.hasCommittedMutations===t.hasCommittedMutations&&this.wn.isEqual(t.wn)},vu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.wn.toString()+", {hasLocalMutations: "+this.an+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(vu.prototype,"hasPendingWrites",{get:function(){return this.an||this.hasCommittedMutations},enumerable:!1,configurable:!0}),vu),fu=(n(yu,au=Ee),yu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(yu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),yu.prototype.isEqual=function(t){return t instanceof yu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},yu),lu=(n(du,uu=Ee),du.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(du.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),du.prototype.isEqual=function(t){return t instanceof du&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},du),pu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Tn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.In=null,this.mn=null,this.startAt,this.endAt};function du(){return null!==uu&&uu.apply(this,arguments)||this}function yu(t,e,n){var r=this;return(r=au.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function vu(t,e,n,r){var i=this;return(i=cu.call(this,t,e)||this).wn=n,i.an=!!r.an,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function gu(t,e,n,r,i,o,s,u){return new pu(t,e,n,r,i,o,s,u)}function mu(t){return new pu(t)}function wu(t){return!gi(t.limit)&&"F"===t.limitType}function bu(t){return!gi(t.limit)&&"L"===t.limitType}function _u(t){return 0<t.Tn.length?t.Tn[0].field:null}function Iu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.An())return r.field}return null}function Eu(t){return null!==t.collectionGroup}function Tu(t){var e=t;if(null===e.In){e.In=[];var n=Iu(e),t=_u(e);if(null!==n&&null===t)n.tt()||e.In.push(new ua(n)),e.In.push(new ua(ci.et(),"asc"));else{for(var r=!1,i=0,o=e.Tn;i<o.length;i++){var s=o[i];e.In.push(s),s.field.tt()&&(r=!0)}r||(n=0<e.Tn.length?e.Tn[e.Tn.length-1].dir:"asc",e.In.push(new ua(ci.et(),n)))}}return e.In}function Au(t){var e=t;if(!e.mn)if("F"===e.limitType)e.mn=_i(e.path,e.collectionGroup,Tu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Tu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ua(o.field,s))}var u=e.endAt?new Zu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Zu(e.startAt.position,!e.startAt.before):null;e.mn=_i(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.mn}function Nu(t,e,n){return new pu(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ou(t,e){return Ei(Au(t),Au(e))&&t.limitType===e.limitType}function Su(t){return Ii(Au(t))+"|lt:"+t.limitType}function Du(t){return"Query(target="+(e=Au(t),n=e.path.J(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.J()+" "+t.op+" "+Oo(t.value)}).join(", ")+"]"),gi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.J()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ia(e.startAt)),e.endAt&&(n+=", endAt: "+ia(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function xu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.rt(e.collectionGroup)&&e.path.j(n):hi.ot(e.path)?e.path.isEqual(n):e.path.G(n))&&function(t){for(var e=0,n=i.Tn;e<n.length;e++){var r=n[e];if(!r.field.tt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||oa(t.startAt,Tu(t),n))&&(!t.endAt||!oa(t.endAt,Tu(t),n)));var e,n}function ku(u){return function(t,e){for(var n=!1,r=0,i=Tu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.tt()?hi.$(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Ao(n,t):Mr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Mr()}}(o,t,e);if(0!==s)return s;n=n||o.field.tt()}return 0}}var Pu,Ru=(n(Cu,Pu=function(){}),Cu.create=function(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.Rn(t,e,n):new Uu(t,e,n):"array-contains"===e?new Qu(t,n):"in"===e?new Xu(t,n):"not-in"===e?new Ju(t,n):"array-contains-any"===e?new $u(t,n):new Cu(t,e,n)},Cu.Rn=function(t,e,n){return new("in"===e?ju:qu)(t,n)},Cu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.Pn(Ao(t,this.value)):null!==t&&Io(this.value)===Io(t)&&this.Pn(Ao(t,this.value))},Cu.prototype.Pn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Mr()}},Cu.prototype.An=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Cu);function Cu(t,e,n){var r=this;return(r=Pu.call(this)||this).field=t,r.op=e,r.value=n,r}var Lu,Vu,Mu,Uu=(n(zu,Mu=Ru),zu.prototype.matches=function(t){t=hi.$(t.key,this.key);return this.Pn(t)},zu),ju=(n(Bu,Vu=Ru),Bu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Bu),qu=(n(Fu,Lu=Ru),Fu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Fu);function Fu(t,e){var n=this;return(n=Lu.call(this,t,"not-in",e)||this).keys=Gu(0,e),n}function Bu(t,e){var n=this;return(n=Vu.call(this,t,"in",e)||this).keys=Gu(0,e),n}function zu(t,e,n){var r=this;return(r=Mu.call(this,t,e,n)||this).key=hi.it(n.referenceValue),r}function Gu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return hi.it(t.referenceValue)})}var Ku,Wu,Hu,Yu,Qu=(n(ra,Yu=Ru),ra.prototype.matches=function(t){t=t.field(this.field);return Ro(t)&&To(t.arrayValue,this.value)},ra),Xu=(n(na,Hu=Ru),na.prototype.matches=function(t){t=t.field(this.field);return null!==t&&To(this.value.arrayValue,t)},na),Ju=(n(ea,Wu=Ru),ea.prototype.matches=function(t){if(To(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!To(this.value.arrayValue,t)},ea),$u=(n(ta,Ku=Ru),ta.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Ro(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return To(e.value.arrayValue,t)})},ta),Zu=function(t,e){this.position=t,this.before=e};function ta(t,e){return Ku.call(this,t,"array-contains-any",e)||this}function ea(t,e){return Wu.call(this,t,"not-in",e)||this}function na(t,e){return Hu.call(this,t,"in",e)||this}function ra(t,e){return Yu.call(this,t,"array-contains",e)||this}function ia(t){return(t.before?"b":"a")+":"+t.position.map(Oo).join(",")}function oa(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.tt()?hi.$(hi.it(s.referenceValue),n.key):Ao(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function sa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Eo(t.position[n],e.position[n]))return!1;return!0}var ua=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var aa=(ga.prototype.yn=function(t,e,n){for(var r=n.Vn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Vs(o,e,r[i]))}return e},ga.prototype.pn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ms(i,e,e,this.gn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ms(a,e,o,this.gn))}return e},ga.prototype.vn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.pn(t.key,n.get(t.key));e&&(i=i.Tt(t.key,e))}),i},ga.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Yi())},ga.prototype.isEqual=function(t){return this.batchId===t.batchId&&ei(this.mutations,t.mutations,Us)&&ei(this.baseMutations,t.baseMutations,Us)},ga),ca=(va.from=function(t,e,n){Ur(t.mutations.length===n.length);for(var r=Wi,i=t.mutations,o=0;o<i.length;o++)r=r.Tt(i[o].key,n[o].version);return new va(t,e,n,r)},va),ha=(ya.prototype.get=function(t){var e=this.Dn(t),e=this.Nn[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.Cn(o,t))return i}},ya.prototype.has=function(t){return void 0!==this.get(t)},ya.prototype.set=function(t,e){var n=this.Dn(t),r=this.Nn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Cn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Nn[n]=[[t,e]]},ya.prototype.delete=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Cn(n[r][0],t))return 1===n.length?delete this.Nn[e]:n.splice(r,1),!0;return!1},ya.prototype.forEach=function(s){go(this.Nn,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},ya.prototype.W=function(){return mo(this.Nn)},ya),fa=(da.prototype.catch=function(t){return this.next(void 0,t)},da.prototype.next=function(r,i){var o=this;return this.Mn&&Mr(),this.Mn=!0,this.On?this.error?this.kn(i,this.error):this.$n(r,this.result):new da(function(e,n){o.xn=function(t){o.$n(r,t).next(e,n)},o.Fn=function(t){o.kn(i,t).next(e,n)}})},da.prototype.Ln=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},da.prototype.Bn=function(t){try{var e=t();return e instanceof da?e:da.resolve(e)}catch(t){return da.reject(t)}},da.prototype.$n=function(t,e){return t?this.Bn(function(){return t(e)}):da.resolve(e)},da.prototype.kn=function(t,e){return t?this.Bn(function(){return t(e)}):da.reject(e)},da.resolve=function(n){return new da(function(t,e){t(n)})},da.reject=function(n){return new da(function(t,e){e(n)})},da.qn=function(t){return new da(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},da.Un=function(t){for(var n=da.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?da.resolve(t):e()})}(r[e]);return n},da.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qn(i)},da),h=(pa.prototype.Wn=function(t){t=this.Qn.get(t);return t?t.readTime:si.min()},pa.prototype.jn=function(t,e){this.Gn(),this.Qn.set(t.key,{zn:t,readTime:e})},pa.prototype.Hn=function(t,e){void 0===e&&(e=null),this.Gn(),this.Qn.set(t,{zn:null,readTime:e})},pa.prototype.Jn=function(t,e){this.Gn();var n=this.Qn.get(e);return void 0!==n?fa.resolve(n.zn):this.Yn(t,e)},pa.prototype.getEntries=function(t,e){return this.Xn(t,e)},pa.prototype.apply=function(t){return this.Gn(),this.Kn=!0,this.Zn(t)},pa.prototype.Gn=function(){},pa),la=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})};function pa(){this.Qn=new ha(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Kn=!1}function da(t){var e=this;this.xn=null,this.Fn=null,this.result=void 0,this.error=void 0,this.On=!1,this.Mn=!1,t(function(t){e.On=!0,e.result=t,e.xn&&e.xn(t)},function(t){e.On=!0,e.error=t,e.Fn&&e.Fn(t)})}function ya(t,e){this.Dn=t,this.Cn=e,this.Nn={}}function va(t,e,n,r){this.batch=t,this.bn=e,this.Vn=n,this.Sn=r}function ga(t,e,n,r){this.batchId=t,this.gn=e,this.baseMutations=n,this.mutations=r}function ma(t){return new jo(t,!0)}function wa(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var ba="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ie=(Oa.prototype.es=function(t){this.ts.push(t)},Oa.prototype.ns=function(){this.ts.forEach(function(t){return t()})},Oa),_a=(Na.prototype.cs=function(e,n){var r=this;return this.rs.us(e,n).next(function(t){return r.hs(e,n,t)})},Na.prototype.hs=function(t,r,i){return this.ss.Jn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].pn(r,t);return t})},Na.prototype.ls=function(t,e,i){var o=Bi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].pn(t,e);o=o.Tt(t,e)}),o},Na.prototype._s=function(e,t){var n=this;return this.ss.getEntries(e,t).next(function(t){return n.fs(e,t)})},Na.prototype.fs=function(e,r){var i=this;return this.rs.ds(e,r).next(function(t){var t=i.ls(e,r,t),n=Bi;return t.forEach(function(t,e){e=e||new fu(t,si.min()),n=n.Tt(t,e)}),n})},Na.prototype.ws=function(t,e,n){return r=e,hi.ot(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Es(t,e.path):Eu(e)?this.Ts(t,e,n):this.Is(t,e,n);var r},Na.prototype.Es=function(t,e){return this.cs(t,new hi(e)).next(function(t){var e=Ki;return t instanceof hu&&(e=e.Tt(t.key,t)),e})},Na.prototype.Ts=function(n,r,i){var o=this,s=r.collectionGroup,u=Ki;return this.os.As(n,s).next(function(t){return fa.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new pu(t,null,e.Tn.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Is(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Tt(t,e)})})}).next(function(){return u})})},Na.prototype.Is=function(e,n,t){var c,h,r=this;return this.ss.ws(e,n,t).next(function(t){return c=t,r.rs.Rs(e,n)}).next(function(t){return h=t,r.Ps(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=Ms(s,a,a,r.gn);c=a instanceof hu?c.Tt(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){xu(n,e)||(c=c.remove(t))}),c})},Na.prototype.Ps=function(t,e,n){for(var r=Yi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof zs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.ss.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof hu&&(c=c.Tt(t,e))}),c})},Na),Ia=(Aa.Vs=function(t,e){for(var n=Yi(),r=Yi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Aa(t,e.fromCache,n,r)},Aa),Ea=(Ta.prototype.vs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ta.prototype.next=function(){var t=++this.previousValue;return this.bs&&this.bs(t),t},Ta);function Ta(t,e){var n=this;this.previousValue=t,e&&(e.ps=function(t){return n.vs(t)},this.bs=function(t){return e.Ss(t)})}function Aa(t,e,n,r){this.targetId=t,this.fromCache=e,this.gs=n,this.ys=r}function Na(t,e,n){this.ss=t,this.rs=e,this.os=n}function Oa(){this.ts=[]}Ea.Ds=-1;var Sa,Da=(Va.prototype.reset=function(){this.Ms=0},Va.prototype.Ls=function(){this.Ms=this.Os},Va.prototype.Bs=function(t){var e=this;this.cancel();var n=Math.floor(this.Ms+this.qs()),r=Math.max(0,Date.now()-this.$s),i=Math.max(0,n-r);0<i&&Rr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ms+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ks=this.Cs.Us(this.Ns,i,function(){return e.$s=Date.now(),t()}),this.Ms*=this.Fs,this.Ms<this.xs&&(this.Ms=this.xs),this.Ms>this.Os&&(this.Ms=this.Os)},Va.prototype.Qs=function(){null!==this.ks&&(this.ks.Ks(),this.ks=null)},Va.prototype.cancel=function(){null!==this.ks&&(this.ks.cancel(),this.ks=null)},Va.prototype.qs=function(){return(Math.random()-.5)*this.Ms},Va),xa=(La.delete=function(t){return Rr("SimpleDb","Removing database:",t),Ba(window.indexedDB.deleteDatabase(t)).Ln()},La.Gs=function(){if("undefined"==typeof indexedDB)return!1;if(La.zs())return!0;var t=p(),e=La.js(t),n=0<e&&e<10,e=La.Hs(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},La.zs=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Js)},La.Ys=function(t,e){return t.store(e)},La.js=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},La.Hs=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},La.prototype.Xs=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Rr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new Pa(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new Br(Fr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new Pa(o,t))},r.onupgradeneeded=function(t){Rr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Ws.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Rr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Zs&&(this.db.onversionchange=function(t){return i.Zs(t)}),this.db)]}})})},La.prototype.ti=function(e){this.Zs=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},La.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Xs(u)];case 2:return s.db=t.sent(),e=Ua.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),fa.reject(t)}).Ln(),r={},n.catch(function(){}),[4,e.ei];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Rr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},La.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},La),ka=(Object.defineProperty(Ca.prototype,"On",{get:function(){return this.si},enumerable:!1,configurable:!0}),Object.defineProperty(Ca.prototype,"ri",{get:function(){return this.ii},enumerable:!1,configurable:!0}),Object.defineProperty(Ca.prototype,"cursor",{set:function(t){this.ni=t},enumerable:!1,configurable:!0}),Ca.prototype.done=function(){this.si=!0},Ca.prototype.oi=function(t){this.ii=t},Ca.prototype.delete=function(){return Ba(this.ni.delete())},Ca),Pa=(n(Ra,Sa=Br),Ra);function Ra(t,e){var n=this;return(n=Sa.call(this,Fr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function Ca(t){this.ni=t,this.si=!1,this.ii=null}function La(t,e,n){this.name=t,this.version=e,this.Ws=n,12.2===La.js(p())&&Cr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Va(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Cs=t,this.Ns=e,this.xs=n,this.Fs=r,this.Os=i,this.Ms=0,this.ks=null,this.$s=Date.now(),this.reset()}function Ma(t){return"IndexedDbTransactionError"===t.name}var Ua=(Fa.open=function(t,e,n,r){try{return new Fa(e,t.transaction(r,n))}catch(t){throw new Pa(e,t)}},Object.defineProperty(Fa.prototype,"ei",{get:function(){return this.ci.promise},enumerable:!1,configurable:!0}),Fa.prototype.abort=function(t){t&&this.ci.reject(t),this.aborted||(Rr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Fa.prototype.store=function(t){t=this.transaction.objectStore(t);return new ja(t)},Fa),ja=(qa.prototype.put=function(t,e){t=void 0!==e?(Rr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Rr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return Ba(t)},qa.prototype.add=function(t){return Rr("SimpleDb","ADD",this.store.name,t,t),Ba(this.store.add(t))},qa.prototype.get=function(e){var n=this;return Ba(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Rr("SimpleDb","GET",n.store.name,e,t),t})},qa.prototype.delete=function(t){return Rr("SimpleDb","DELETE",this.store.name,t),Ba(this.store.delete(t))},qa.prototype.count=function(){return Rr("SimpleDb","COUNT",this.store.name),Ba(this.store.count())},qa.prototype.ui=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.ai(e,function(t,e){n.push(e)}).next(function(){return n})},qa.prototype.hi=function(t,e){Rr("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.li=!1;e=this.cursor(e);return this.ai(e,function(t,e,n){return n.delete()})},qa.prototype._i=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.ai(n,e)},qa.prototype.fi=function(r){var t=this.cursor({});return new fa(function(n,e){t.onerror=function(t){t=Ga(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},qa.prototype.ai=function(t,i){var o=[];return new fa(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new ka(n),(t=i(n.primaryKey,n.value,e))instanceof fa&&(t=t.catch(function(t){return e.done(),fa.reject(t)}),o.push(t)),e.On?r():null===e.ri?n.continue():n.continue(e.ri)):r()}}).next(function(){return fa.qn(o)})},qa.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},qa.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.li?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},qa);function qa(t){this.store=t}function Fa(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.ci=new la,this.transaction.oncomplete=function(){n.ci.resolve()},this.transaction.onabort=function(){t.error?n.ci.reject(new Pa(e,t.error)):n.ci.resolve()},this.transaction.onerror=function(t){t=Ga(t.target.error);n.ci.reject(new Pa(e,t))}}function Ba(t){return new fa(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=Ga(t.target.error);n(t)}})}var za=!1;function Ga(t){var e=xa.js(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new Br("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return za||(za=!0,setTimeout(function(){throw n},0)),n}}return t}function Ka(){return"undefined"!=typeof window?window:null}function Wa(){return"undefined"!=typeof document?document:null}var Ha=(Xa.Ii=function(t,e,n,r,i){i=new Xa(t,e,Date.now()+n,r,i);return i.start(n),i},Xa.prototype.start=function(t){var e=this;this.mi=setTimeout(function(){return e.Ai()},t)},Xa.prototype.Ks=function(){return this.Ai()},Xa.prototype.cancel=function(t){null!==this.mi&&(this.clearTimeout(),this.Ti.reject(new Br(Fr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Xa.prototype.Ai=function(){var e=this;this.di.Ri(function(){return null!==e.mi?(e.clearTimeout(),e.op().then(function(t){return e.Ti.resolve(t)})):Promise.resolve()})},Xa.prototype.clearTimeout=function(){null!==this.mi&&(this.Ei(this),clearTimeout(this.mi),this.mi=null)},Xa),Ya=(Object.defineProperty(Qa.prototype,"Ci",{get:function(){return this.yi},enumerable:!1,configurable:!0}),Qa.prototype.Ri=function(t){this.enqueue(t)},Qa.prototype.Ni=function(t){this.xi(),this.Fi(t)},Qa.prototype.Oi=function(){var t;this.yi||(this.yi=!0,(t=Wa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Di))},Qa.prototype.enqueue=function(t){return this.xi(),this.yi?new Promise(function(t){}):this.Fi(t)},Qa.prototype.Mi=function(t){var e=this;this.Ri(function(){return e.gi.push(t),e.ki()})},Qa.prototype.ki=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.gi.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.gi[0]()];case 2:return t.sent(),this.gi.shift(),this.Si.reset(),[3,4];case 3:if(!Ma(e=t.sent()))throw e;return Rr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.gi.length&&this.Si.Bs(function(){return n.ki()}),t.label=5;case 5:return[2]}})})},Qa.prototype.Fi=function(t){var r=this,e=this.Pi.then(function(){return r.vi=!0,t().catch(function(t){throw r.pi=t,r.vi=!1,Cr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.vi=!1,t})});return this.Pi=e},Qa.prototype.Us=function(t,e,n){var r=this;this.xi(),-1<this.bi.indexOf(t)&&(e=0);n=Ha.Ii(this,t,e,n,function(t){return r.$i(t)});return this.Vi.push(n),n},Qa.prototype.xi=function(){this.pi&&Mr()},Qa.prototype.Li=function(){},Qa.prototype.Bi=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Pi];case 1:t.sent(),t.label=2;case 2:if(e!==this.Pi)return[3,0];t.label=3;case 3:return[2]}})})},Qa.prototype.qi=function(t){for(var e=0,n=this.Vi;e<n.length;e++)if(n[e].Ns===t)return!0;return!1},Qa.prototype.Ui=function(r){var i=this;return this.Bi().then(function(){i.Vi.sort(function(t,e){return t.wi-e.wi});for(var t=0,e=i.Vi;t<e.length;t++){var n=e[t];if(n.Ks(),"all"!==r&&n.Ns===r)break}return i.Bi()})},Qa.prototype.Qi=function(t){this.bi.push(t)},Qa.prototype.$i=function(t){t=this.Vi.indexOf(t);this.Vi.splice(t,1)},Qa);function Qa(){var e=this;this.Pi=Promise.resolve(),this.gi=[],this.yi=!1,this.Vi=[],this.pi=null,this.vi=!1,this.bi=[],this.Si=new Da(this,"async_queue_retry"),this.Di=function(){var t=Wa();t&&Rr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Si.Qs()};var t=Wa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Di)}function Xa(t,e,n,r,i){this.di=t,this.Ns=e,this.wi=n,this.op=r,this.Ei=i,this.Ti=new la,this.then=this.Ti.promise.then.bind(this.Ti.promise),this.Ti.promise.catch(function(t){})}function Ja(t,e){if(Cr("AsyncQueue",e+": "+t),Ma(t))return new Br(Fr.UNAVAILABLE,e+": "+t);throw t}function $a(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=ti(n,t);return 0===t?ti(r,e):t}var Za=(rc.prototype.ji=function(){return++this.Wi},rc.prototype.Gi=function(t){var e=[t,this.ji()];this.buffer.size<this.Ki?this.buffer=this.buffer.add(e):$a(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(rc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),rc),tc={zi:!1,Hi:0,Ji:0,Yi:0},ec=(nc.er=function(t){return new nc(t,nc.nr,nc.sr)},nc);function nc(t,e,n){this.Xi=t,this.Zi=e,this.tr=n}function rc(t){this.Ki=t,this.buffer=new qi($a),this.Wi=0}ec.nr=10,ec.sr=1e3,ec.ir=new ec(41943040,ec.nr,ec.sr),ec.rr=new ec(-1,0,0);var ic=(uc.prototype.start=function(t){-1!==this.cr.params.Xi&&this.hr(t)},uc.prototype.stop=function(){this.ar&&(this.ar.cancel(),this.ar=null)},Object.defineProperty(uc.prototype,"lr",{get:function(){return null!==this.ar},enumerable:!1,configurable:!0}),uc.prototype.hr=function(n){var t=this,e=this.ur?3e5:6e4;Rr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.ar=this.di.Us("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.ar=null,this.ur=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n._r(this.cr)];case 2:return t.sent(),[3,7];case 3:return Ma(e=t.sent())?(Rr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Yh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.hr(n)];case 8:return t.sent(),[2]}})})})},uc),oc=(sc.prototype.wr=function(t,e){return this.dr.Er(t).next(function(t){return Math.floor(e/100*t)})},sc.prototype.Tr=function(t,e){var n=this;if(0===e)return fa.resolve(Ea.Ds);var r=new Za(e);return this.dr.Ue(t,function(t){return r.Gi(t.sequenceNumber)}).next(function(){return n.dr.Ir(t,function(t){return r.Gi(t)})}).next(function(){return r.maxValue})},sc.prototype.mr=function(t,e,n){return this.dr.mr(t,e,n)},sc.prototype.Ar=function(t,e){return this.dr.Ar(t,e)},sc.prototype.Rr=function(e,n){var r=this;return-1===this.params.Xi?(Rr("LruGarbageCollector","Garbage collection skipped; disabled"),fa.resolve(tc)):this.Pr(e).next(function(t){return t<r.params.Xi?(Rr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Xi),tc):r.gr(e,n)})},sc.prototype.Pr=function(t){return this.dr.Pr(t)},sc.prototype.gr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.wr(e,this.params.Zi).next(function(t){return i=t>h.params.tr?(Rr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.tr+" from "+t),h.params.tr):t,s=Date.now(),h.Tr(e,i)}).next(function(t){return r=t,u=Date.now(),h.mr(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.Ar(e,r)}).next(function(t){return c=Date.now(),Pr()<=l.DEBUG&&Rr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),fa.resolve({zi:!0,Hi:i,Ji:o,Yi:t})})},sc);function sc(t,e){this.dr=t,this.params=e}function uc(t,e){this.cr=t,this.di=e,this.ur=!1,this.ar=null}function ac(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=cc(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return cc(e)}function cc(t){return t+"\x01\x01"}function hc(t){var e=t.length;if(Ur(2<=e),2===e)return Ur("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),ui.X();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Mr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Mr()}o=s+2}return new ui(r)}var fc=function(t){this.yr=t};function lc(t,e){if(e.document)return n=t.yr,r=e.document,i=!!e.hasCommittedMutations,t=Qo(n,r.name),n=Ko(r.updateTime),r=new eu({mapValue:{fields:r.fields}}),new hu(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=hi.ct(e.noDocument.path),o=gc(e.noDocument.readTime);return new fu(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){o=hi.ct(e.unknownDocument.path),e=gc(e.unknownDocument.version);return new lu(o,e)}return Mr()}function pc(t,e,n){var r=dc(n),n=e.key.path.q().H();if(e instanceof hu){var i={name:Yo(i=t.yr,(o=e).key),fields:o.En().mapValue.fields,updateTime:zo(i,o.version.M())},o=e.hasCommittedMutations;return new $c(null,null,i,o,r,n)}if(e instanceof fu){var i=e.key.path.H(),o=vc(e.version),s=e.hasCommittedMutations;return new $c(null,new Xc(i,o),null,s,r,n)}if(e instanceof lu){s=e.key.path.H(),e=vc(e.version);return new $c(new Jc(s,e),null,null,!0,r,n)}return Mr()}function dc(t){t=t.M();return[t.seconds,t.nanoseconds]}function yc(t){t=new oi(t[0],t[1]);return si.N(t)}function vc(t){t=t.M();return new Fc(t.seconds,t.nanoseconds)}function gc(t){t=new oi(t.seconds,t.nanoseconds);return si.N(t)}function mc(e,t){var n=(t.baseMutations||[]).map(function(t){return ns(e.yr,t)}),r=t.mutations.map(function(t){return ns(e.yr,t)}),i=oi.fromMillis(t.localWriteTimeMs);return new aa(t.batchId,i,n,r)}function wc(t){var e=gc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?gc(t.lastLimboFreeSnapshotVersion):si.min(),r=void 0!==t.query.documents?(Ur(1===(r=t.query).documents.length),Au(mu(Jo(r.documents[0])))):Au(os(t.query));return new Di(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Ai.fromBase64String(t.resumeToken))}function bc(t,e){var n=vc(e.ft),r=vc(e.lastLimboFreeSnapshotVersion),i=(Ti(e.target)?rs:is)(t.yr,e.target),t=e.resumeToken.toBase64();return new th(e.targetId,Ii(e.target),n,t,e.sequenceNumber,r,i)}function _c(t){var e=os({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Nu(e,e.limit,"L"):e}var Ic=(Ec.vr=function(t,e,n,r){return Ur(""!==t.uid),new Ec(t.u()?t.uid:"",e,n,r)},Ec.prototype.br=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Nc(t)._i({index:Hc.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Ec.prototype.Sr=function(d,y,v,g){var m=this,w=Oc(d),b=Nc(d);return b.add({}).next(function(t){Ur("number"==typeof t);for(var e,n,r,i,o,s=new aa(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return es(e.yr,t)}),o=r.mutations.map(function(t){return es(e.yr,t)}),new Hc(n,r.batchId,r.gn.toMillis(),i,o)),a=[],c=new qi(function(t,e){return ti(t.J(),e.J())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Yc.key(m.userId,l.key.path,t),c=c.add(l.key.path.q());a.push(b.put(u)),a.push(w.put(p,Yc.PLACEHOLDER))}return c.forEach(function(t){a.push(m.os.Dr(d,t))}),d.es(function(){m.pr[t]=s.keys()}),fa.qn(a).next(function(){return s})})},Ec.prototype.Cr=function(t,e){var n=this;return Nc(t).get(e).next(function(t){return t?(Ur(t.userId===n.userId),mc(n.serializer,t)):null})},Ec.prototype.Nr=function(t,e){var n=this;return this.pr[e]?fa.resolve(this.pr[e]):this.Cr(t,e).next(function(t){if(t){t=t.keys();return n.pr[e]=t}return null})},Ec.prototype.Fr=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Nc(t)._i({index:Hc.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Ur(e.batchId>=i),o=mc(r.serializer,e)),n.done()}).next(function(){return o})},Ec.prototype.Or=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Nc(t)._i({index:Hc.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Ec.prototype.Mr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Nc(t).ui(Hc.userMutationsIndex,n).next(function(t){return t.map(function(t){return mc(e.serializer,t)})})},Ec.prototype.us=function(o,s){var u=this,t=Yc.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Oc(o)._i({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=hc(i);if(r===u.userId&&s.path.isEqual(i))return Nc(o).get(t).next(function(t){if(!t)throw Mr();Ur(t.userId===u.userId),a.push(mc(u.serializer,t))});n.done()}).next(function(){return a})},Ec.prototype.ds=function(e,t){var s=this,u=new qi(ti),n=[];return t.forEach(function(o){var t=Yc.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Oc(e)._i({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=hc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),fa.qn(n).next(function(){return s.kr(e,u)})},Ec.prototype.Rs=function(t,e){var o=this,s=e.path,u=s.length+1,e=Yc.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new qi(ti);return Oc(t)._i({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=hc(i);r===o.userId&&s.j(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.kr(t,a)})},Ec.prototype.kr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Nc(e).get(t).next(function(t){if(null===t)throw Mr();Ur(t.userId===n.userId),r.push(mc(n.serializer,t))}))}),fa.qn(i).next(function(){return r})},Ec.prototype.$r=function(e,n){var r=this;return Ac(e.Lr,this.userId,n).next(function(t){return e.es(function(){r.Br(n.batchId)}),fa.forEach(t,function(t){return r.Vr.qr(e,t)})})},Ec.prototype.Br=function(t){delete this.pr[t]},Ec.prototype.Ur=function(e){var i=this;return this.br(e).next(function(t){if(!t)return fa.resolve();var t=IDBKeyRange.lowerBound(Yc.prefixForUser(i.userId)),r=[];return Oc(e)._i({range:t},function(t,e,n){t[0]===i.userId?(t=hc(t[1]),r.push(t)):n.done()}).next(function(){Ur(0===r.length)})})},Ec.prototype.Qr=function(t,e){return Tc(t,this.userId,e)},Ec.prototype.Kr=function(t){var e=this;return Sc(t).get(this.userId).next(function(t){return t||new Wc(e.userId,-1,"")})},Ec);function Ec(t,e,n,r){this.userId=t,this.serializer=e,this.os=n,this.Vr=r,this.pr={}}function Tc(t,o,e){var e=Yc.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return Oc(t)._i({range:e,li:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Ac(t,e,n){var r=t.store(Hc.store),i=t.store(Yc.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r._i({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Ur(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=Yc.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return fa.qn(o).next(function(){return u})}function Nc(t){return Nh.Ys(t,Hc.store)}function Oc(t){return Nh.Ys(t,Yc.store)}function Sc(t){return Nh.Ys(t,Wc.store)}var Dc,xc=(Rc.prototype.jn=function(t,e,n){return Lc(t).put(Vc(e),n)},Rc.prototype.Hn=function(t,e){t=Lc(t),e=Vc(e);return t.delete(e)},Rc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Wr(e,t)})},Rc.prototype.Jn=function(t,e){var n=this;return Lc(t).get(Vc(e)).next(function(t){return n.jr(t)})},Rc.prototype.Gr=function(t,e){var n=this;return Lc(t).get(Vc(e)).next(function(t){var e=n.jr(t);return e?{zn:e,size:Mc(t)}:null})},Rc.prototype.getEntries=function(t,e){var n=this,r=Bi;return this.zr(t,e,function(t,e){e=n.jr(e);r=r.Tt(t,e)}).next(function(){return r})},Rc.prototype.Hr=function(t,e){var r=this,i=Bi,o=new Ri(hi.$);return this.zr(t,e,function(t,e){var n=r.jr(e);o=n?(i=i.Tt(t,n),o.Tt(t,Mc(e))):(i=i.Tt(t,null),o.Tt(t,0))}).next(function(){return{Jr:i,Yr:o}})},Rc.prototype.zr=function(t,e,i){if(e.W())return fa.resolve();var n=IDBKeyRange.bound(e.first().path.H(),e.last().path.H()),o=e.yt(),s=o.Ct();return Lc(t)._i({range:n},function(t,e,n){for(var r=hi.ct(t);s&&hi.$(s,r)<0;)i(s,null),s=o.Ct();s&&s.isEqual(r)&&(i(s,e),s=o.Nt()?o.Ct():null),s?n.oi(s.path.H()):n.done()}).next(function(){for(;s;)i(s,null),s=o.Nt()?o.Ct():null})},Rc.prototype.ws=function(t,r,e){var n,i=this,o=Ki,s=r.path.length+1,u={};return e.isEqual(si.min())?(n=r.path.H(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.H(),e=dc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=$c.collectionReadTimeIndex),Lc(t)._i(u,function(t,e,n){t.length===s&&(e=lc(i.serializer,e),r.path.j(e.key.path)?e instanceof hu&&xu(r,e)&&(o=o.Tt(e.key,e)):n.done())}).next(function(){return o})},Rc.prototype.Xr=function(t){return new kc(this,!!t&&t.Zr)},Rc.prototype.eo=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Rc.prototype.getMetadata=function(t){return Cc(t).get(Zc.key).next(function(t){return Ur(!!t),t})},Rc.prototype.Wr=function(t,e){return Cc(t).put(Zc.key,e)},Rc.prototype.jr=function(t){if(t){t=lc(this.serializer,t);return t instanceof fu&&t.version.isEqual(si.min())?null:t}return null},Rc),kc=(n(Pc,Dc=h),Pc.prototype.Zn=function(i){var o=this,s=[],u=0,a=new qi(function(t,e){return ti(t.J(),e.J())});return this.Qn.forEach(function(t,e){var n,r=o.so.get(t);e.zn?(n=pc(o.no.serializer,e.zn,o.Wn(t)),a=a.add(t.path.q()),e=Mc(n),u+=e-r,s.push(o.no.jn(i,t,n))):(u-=r,o.Zr?(r=pc(o.no.serializer,new fu(t,si.min()),o.Wn(t)),s.push(o.no.jn(i,t,r))):s.push(o.no.Hn(i,t)))}),a.forEach(function(t){s.push(o.no.os.Dr(i,t))}),s.push(this.no.updateMetadata(i,u)),fa.qn(s)},Pc.prototype.Yn=function(t,e){var n=this;return this.no.Gr(t,e).next(function(t){return null===t?(n.so.set(e,0),null):(n.so.set(e,t.size),t.zn)})},Pc.prototype.Xn=function(t,e){var n=this;return this.no.Hr(t,e).next(function(t){var e=t.Jr;return t.Yr.forEach(function(t,e){n.so.set(t,e)}),e})},Pc);function Pc(t,e){var n=this;return(n=Dc.call(this)||this).no=t,n.Zr=e,n.so=new ha(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Rc(t,e){this.serializer=t,this.os=e}function Cc(t){return Nh.Ys(t,Zc.store)}function Lc(t){return Nh.Ys(t,$c.store)}function Vc(t){return t.path.H()}function Mc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Mr();e=t.noDocument}return JSON.stringify(e).length}var Uc=(Kc.prototype.Dr=function(t,e){return this.io.add(e),fa.resolve()},Kc.prototype.As=function(t,e){return fa.resolve(this.io.getEntries(e))},Kc),jc=(Gc.prototype.add=function(t){var e=t.K(),n=t.q(),r=this.index[e]||new qi(ui.$),t=!r.has(n);return this.index[e]=r.add(n),t},Gc.prototype.has=function(t){var e=t.K(),t=t.q(),e=this.index[e];return e&&e.has(t)},Gc.prototype.getEntries=function(t){return(this.index[t]||new qi(ui.$)).H()},Gc),qc=(zc.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Ur(t<r&&0<=t&&r<=11);var o=new Ua("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Bc.store),(s=e).createObjectStore(Wc.store,{keyPath:Wc.keyPath}),s.createObjectStore(Hc.store,{keyPath:Hc.keyPath,autoIncrement:!0}).createIndex(Hc.userMutationsIndex,Hc.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Yc.store),ih(e),e.createObjectStore($c.store));var s,u=fa.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(eh.store),s.deleteObjectStore(th.store),s.deleteObjectStore(nh.store),ih(e)),u=u.next(function(){return t=o.store(nh.store),e=new nh(0,0,si.min().M(),0),t.put(nh.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Hc.store).ui().next(function(t){n.deleteObjectStore(Hc.store),n.createObjectStore(Hc.store,{keyPath:Hc.keyPath,autoIncrement:!0}).createIndex(Hc.userMutationsIndex,Hc.userMutationsKeyPath,{unique:!0});var e=r.store(Hc.store),t=t.map(function(t){return e.put(t)});return fa.qn(t)});var n,r})),u=u.next(function(){e.createObjectStore(oh.store,{keyPath:oh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Zc.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore($c.store)).createIndex($c.readTimeIndex,$c.readTimeIndexPath,{unique:!1}),t.createIndex($c.collectionReadTimeIndex,$c.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(sh.store,{keyPath:sh.keyPath}),e.createObjectStore(uh.store,{keyPath:uh.keyPath})})),u},zc.prototype.addDocumentGlobal=function(e){var n=0;return e.store($c.store)._i(function(t,e){n+=Mc(e)}).next(function(){var t=new Zc(n);return e.store(Zc.store).put(Zc.key,t)})},zc.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(Wc.store),i=n.store(Hc.store);return t.ui().next(function(t){return fa.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.ui(Hc.userMutationsIndex,t).next(function(t){return fa.forEach(t,function(t){Ur(t.userId===e.userId);t=mc(r.serializer,t);return Ac(n,e.userId,t).next(function(){})})})})})},zc.prototype.ensureSequenceNumbers=function(t){var o=t.store(eh.store),e=t.store($c.store);return t.store(nh.store).get(nh.key).next(function(r){var i=[];return e._i(function(t,e){var n=new ui(t),t=[0,ac(n)];i.push(o.get(t).next(function(t){return t?fa.resolve():o.put(new eh(0,ac(n),r.highestListenSequenceNumber))}))}).next(function(){return fa.qn(i)})})},zc.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(rh.store,{keyPath:rh.keyPath});function r(t){if(i.add(t)){var e=t.K(),t=t.q();return n.put({collectionId:e,parent:ac(t)})}}var n=e.store(rh.store),i=new jc;return e.store($c.store)._i({li:!0},function(t,e){t=new ui(t);return r(t.q())}).next(function(){return e.store(Yc.store)._i({li:!0},function(t,e){t[0];var n=t[1],n=(t[2],hc(n));return r(n.q())})})},zc.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(th.store);return r._i(function(t,e){e=wc(e),e=bc(n.serializer,e);return r.put(e)})},zc),Fc=function(t,e){this.seconds=t,this.nanoseconds=e},Bc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function zc(t){this.serializer=t}function Gc(){this.index={}}function Kc(){this.io=new jc}Bc.store="owner",Bc.key="owner";var Wc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Wc.store="mutationQueues",Wc.keyPath="userId";var Hc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Hc.store="mutations",Hc.keyPath="batchId",Hc.userMutationsIndex="userMutationsIndex",Hc.userMutationsKeyPath=["userId","batchId"];var Yc=(Qc.prefixForUser=function(t){return[t]},Qc.prefixForPath=function(t,e){return[t,ac(e)]},Qc.key=function(t,e,n){return[t,ac(e),n]},Qc);function Qc(){}Yc.store="documentMutations",Yc.PLACEHOLDER=new Yc;var Xc=function(t,e){this.path=t,this.readTime=e},Jc=function(t,e){this.path=t,this.version=e},$c=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};$c.store="remoteDocuments",$c.readTimeIndex="readTimeIndex",$c.readTimeIndexPath="readTime",$c.collectionReadTimeIndex="collectionReadTimeIndex",$c.collectionReadTimeIndexPath=["parentPath","readTime"];var Zc=function(t){this.byteSize=t};Zc.store="remoteDocumentGlobal",Zc.key="remoteDocumentGlobalKey";var th=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};th.store="targets",th.keyPath="targetId",th.queryTargetsIndexName="queryTargetsIndex",th.queryTargetsKeyPath=["canonicalId","targetId"];var eh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};eh.store="targetDocuments",eh.keyPath=["targetId","path"],eh.documentTargetsIndex="documentTargetsIndex",eh.documentTargetsKeyPath=["path","targetId"];var nh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};nh.key="targetGlobalKey",nh.store="targetGlobal";var rh=function(t,e){this.collectionId=t,this.parent=e};function ih(t){t.createObjectStore(eh.store,{keyPath:eh.keyPath}).createIndex(eh.documentTargetsIndex,eh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(th.store,{keyPath:th.keyPath}).createIndex(th.queryTargetsIndexName,th.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(nh.store)}rh.store="collectionParents",rh.keyPath=["collectionId","parent"];var oh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};oh.store="clientMetadata",oh.keyPath="clientId";var sh=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};sh.store="bundles",sh.keyPath="bundleId";var uh=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};uh.store="namedQueries",uh.keyPath="name";var ah=s(s(s(s([Wc.store,Hc.store,Yc.store,$c.store,th.store,Bc.store,nh.store,eh.store],[oh.store]),[Zc.store]),[rh.store]),[sh.store,uh.store]),ch=(hh.prototype.ro=function(t,e){return fh(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:gc(t.createTime),version:t.version}})},hh.prototype.oo=function(t,e){return fh(t).put({bundleId:(e=e).id,createTime:vc(Ko(e.createTime)),version:e.version})},hh.prototype.co=function(t,e){return lh(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:_c(t.bundledQuery),readTime:gc(t.readTime)}})},hh.prototype.uo=function(t,e){return lh(t).put({name:(e=e).name,readTime:vc(Ko(e.readTime)),bundledQuery:e.bundledQuery})},hh);function hh(t){this.serializer=t}function fh(t){return Nh.Ys(t,sh.store)}function lh(t){return Nh.Ys(t,uh.store)}var ph=(dh.prototype.Dr=function(t,e){var n=this;if(this.ao.has(e))return fa.resolve();var r=e.K(),i=e.q();t.es(function(){n.ao.add(e)});i={collectionId:r,parent:ac(i)};return yh(t).put(i)},dh.prototype.As=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[ni(i),""],!1,!0);return yh(t).ui(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(hc(r.parent))}return o})},dh);function dh(){this.ao=new jc}function yh(t){return Nh.Ys(t,rh.store)}var vh=(wh.prototype.next=function(){return this.ho+=2,this.ho},wh.lo=function(){return new wh(0)},wh._o=function(){return new wh(-1)},wh),gh=(mh.prototype.fo=function(n){var r=this;return this.wo(n).next(function(t){var e=new vh(t.highestTargetId);return t.highestTargetId=e.next(),r.Eo(n,t).next(function(){return t.highestTargetId})})},mh.prototype.To=function(t){return this.wo(t).next(function(t){return si.N(new oi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},mh.prototype.Io=function(t){return this.wo(t).next(function(t){return t.highestListenSequenceNumber})},mh.prototype.mo=function(e,n,r){var i=this;return this.wo(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.M()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Eo(e,t)})},mh.prototype.Ao=function(e,n){var r=this;return this.Ro(e,n).next(function(){return r.wo(e).next(function(t){return t.targetCount+=1,r.Po(n,t),r.Eo(e,t)})})},mh.prototype.yo=function(t,e){return this.Ro(t,e)},mh.prototype.Vo=function(e,t){var n=this;return this.po(e,t.targetId).next(function(){return bh(e).delete(t.targetId)}).next(function(){return n.wo(e)}).next(function(t){return Ur(0<t.targetCount),--t.targetCount,n.Eo(e,t)})},mh.prototype.mr=function(n,r,i){var o=this,s=0,u=[];return bh(n)._i(function(t,e){e=wc(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.Vo(n,e)))}).next(function(){return fa.qn(u)}).next(function(){return s})},mh.prototype.Ue=function(t,n){return bh(t)._i(function(t,e){e=wc(e);n(e)})},mh.prototype.wo=function(t){return _h(t).get(nh.key).next(function(t){return Ur(null!==t),t})},mh.prototype.Eo=function(t,e){return _h(t).put(nh.key,e)},mh.prototype.Ro=function(t,e){return bh(t).put(bc(this.serializer,e))},mh.prototype.Po=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},mh.prototype.vo=function(t){return this.wo(t).next(function(t){return t.targetCount})},mh.prototype.bo=function(t,r){var e=Ii(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return bh(t)._i({range:e,index:th.queryTargetsIndexName},function(t,e,n){e=wc(e);Ei(r,e.target)&&(i=e,n.done())}).next(function(){return i})},mh.prototype.So=function(n,t,r){var i=this,o=[],s=Ih(n);return t.forEach(function(t){var e=ac(t.path);o.push(s.put(new eh(r,e))),o.push(i.Vr.Do(n,r,t))}),fa.qn(o)},mh.prototype.Co=function(n,t,r){var i=this,o=Ih(n);return fa.forEach(t,function(t){var e=ac(t.path);return fa.qn([o.delete([r,e]),i.Vr.No(n,r,t)])})},mh.prototype.po=function(t,e){t=Ih(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},mh.prototype.xo=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Ih(t),r=Yi();return t._i({range:e,li:!0},function(t,e,n){t=hc(t[1]),t=new hi(t);r=r.add(t)}).next(function(){return r})},mh.prototype.Qr=function(t,e){var e=ac(e.path),e=IDBKeyRange.bound([e],[ni(e)],!1,!0),i=0;return Ih(t)._i({index:eh.documentTargetsIndex,li:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},mh.prototype.Ze=function(t,e){return bh(t).get(e).next(function(t){return t?wc(t):null})},mh);function mh(t,e){this.Vr=t,this.serializer=e}function wh(t){this.ho=t}function bh(t){return Nh.Ys(t,th.store)}function _h(t){return Nh.Ys(t,nh.store)}function Ih(t){return Nh.Ys(t,eh.store)}var Eh,Th="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ah=(n(Sh,Eh=Ie),Sh),Nh=(Oh.Ys=function(t,e){if(t instanceof Ah)return xa.Ys(t.Lr,e);throw Mr()},Oh.prototype.start=function(){var e=this;return this.Ho().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Br(Fr.FAILED_PRECONDITION,Th);return e.Jo(),e.Yo(),e.Xo(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.jo.Io(t)})}).then(function(t){e.ko=new Ea(t,e.Oo)}).then(function(){e.$o=!0}).catch(function(t){return e.Wo&&e.Wo.close(),Promise.reject(t)})},Oh.prototype.Zo=function(n){var t=this;return this.Qo=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.lr?[2,n(e)]:[2]})})},n(this.isPrimary)},Oh.prototype.tc=function(n){var t=this;this.Wo.ti(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Oh.prototype.ec=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Cs.Ri(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.lr?[4,this.Ho()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Oh.prototype.Ho=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return xh(e).put(new oh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.nc(e).next(function(t){t||(n.isPrimary=!1,n.Cs.Mi(function(){return n.Qo(!1)}))})}).next(function(){return n.sc(e)}).next(function(t){return n.isPrimary&&!t?n.ic(e).next(function(){return!1}):!!t&&n.rc(e).next(function(){return!0})})}).catch(function(t){if(Ma(t))return Rr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Rr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Cs.Mi(function(){return n.Qo(t)}),n.isPrimary=t})},Oh.prototype.nc=function(t){var e=this;return Dh(t).get(Bc.key).next(function(t){return fa.resolve(e.oc(t))})},Oh.prototype.cc=function(t){return xh(t).delete(this.clientId)},Oh.prototype.uc=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ac(this.Uo,18e5)?[3,2]:(this.Uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Oh.Ys(t,oh.store);return r.ui().next(function(t){var e=o.hc(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return fa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.zo)for(n=0,r=e;n<r.length;n++)i=r[n],this.zo.removeItem(this.lc(i.clientId));t.label=2;case 2:return[2]}})})},Oh.prototype.Xo=function(){var t=this;this.qo=this.Cs.Us("client_metadata_refresh",4e3,function(){return t.Ho().then(function(){return t.uc()}).then(function(){return t.Xo()})})},Oh.prototype.oc=function(t){return!!t&&t.ownerId===this.clientId},Oh.prototype.sc=function(e){var r=this;return this.Mo?fa.resolve(!0):Dh(e).get(Bc.key).next(function(t){if(null!==t&&r.ac(t.leaseTimestampMs,5e3)&&!r._c(t.ownerId)){if(r.oc(t)&&r.networkEnabled)return!0;if(!r.oc(t)){if(!t.allowTabSynchronization)throw new Br(Fr.FAILED_PRECONDITION,Th);return!1}}return!(!r.networkEnabled||!r.inForeground)||xh(e).ui().next(function(t){return void 0===r.hc(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Rr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Oh.prototype.fc=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.$o=!1,this.dc(),this.qo&&(this.qo.cancel(),this.qo=null),this.wc(),this.Ec(),[4,this.Wo.runTransaction("shutdown","readwrite",[Bc.store,oh.store],function(t){var e=new Ah(t,Ea.Ds);return n.ic(e).next(function(){return n.cc(e)})})];case 1:return t.sent(),this.Wo.close(),this.Tc(),[2]}})})},Oh.prototype.hc=function(t,e){var n=this;return t.filter(function(t){return n.ac(t.updateTimeMs,e)&&!n._c(t.clientId)})},Oh.prototype.Ic=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return xh(t).ui().next(function(t){return e.hc(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Oh.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),Oh.prototype.mc=function(t){return Ic.vr(t,this.serializer,this.os,this.Vr)},Oh.prototype.Ac=function(){return this.jo},Oh.prototype.Rc=function(){return this.ss},Oh.prototype.Pc=function(){return this.os},Oh.prototype.gc=function(){return this.Go},Oh.prototype.runTransaction=function(e,n,r){var i=this;Rr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wo.runTransaction(e,t,ah,function(t){return o=new Ah(t,i.ko?i.ko.next():Ea.Ds),"readwrite-primary"===n?i.nc(o).next(function(t){return!!t||i.sc(o)}).next(function(t){if(!t)throw Cr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Cs.Mi(function(){return i.Qo(!1)}),new Br(Fr.FAILED_PRECONDITION,ba);return r(o)}).next(function(t){return i.rc(o).next(function(){return t})}):i.yc(o).next(function(){return r(o)})}).then(function(t){return o.ns(),t})},Oh.prototype.yc=function(t){var e=this;return Dh(t).get(Bc.key).next(function(t){if(null!==t&&e.ac(t.leaseTimestampMs,5e3)&&!e._c(t.ownerId)&&!e.oc(t)&&!(e.Mo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Br(Fr.FAILED_PRECONDITION,Th)})},Oh.prototype.rc=function(t){var e=new Bc(this.clientId,this.allowTabSynchronization,Date.now());return Dh(t).put(Bc.key,e)},Oh.Gs=function(){return xa.Gs()},Oh.prototype.ic=function(t){var e=this,n=Dh(t);return n.get(Bc.key).next(function(t){return e.oc(t)?(Rr("IndexedDbPersistence","Releasing primary lease."),n.delete(Bc.key)):fa.resolve()})},Oh.prototype.ac=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Cr("Detected an update time that is in the future: "+t+" > "+n),1))},Oh.prototype.Jo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Bo=function(){t.Cs.Ri(function(){return t.inForeground="visible"===t.document.visibilityState,t.Ho()})},this.document.addEventListener("visibilitychange",this.Bo),this.inForeground="visible"===this.document.visibilityState)},Oh.prototype.wc=function(){this.Bo&&(this.document.removeEventListener("visibilitychange",this.Bo),this.Bo=null)},Oh.prototype.Yo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Lo=function(){e.dc(),e.Cs.Ri(function(){return e.fc()})},this.window.addEventListener("unload",this.Lo))},Oh.prototype.Ec=function(){this.Lo&&(this.window.removeEventListener("unload",this.Lo),this.Lo=null)},Oh.prototype._c=function(t){try{var e=null!==(null===(e=this.zo)||void 0===e?void 0:e.getItem(this.lc(t)));return Rr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Cr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Oh.prototype.dc=function(){if(this.zo)try{this.zo.setItem(this.lc(this.clientId),String(Date.now()))}catch(t){Cr("Failed to set zombie client id.",t)}},Oh.prototype.Tc=function(){if(this.zo)try{this.zo.removeItem(this.lc(this.clientId))}catch(t){}},Oh.prototype.lc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Oh);function Oh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Cs=i,this.window=o,this.document=s,this.Oo=a,this.Mo=c,this.ko=null,this.$o=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Lo=null,this.inForeground=!1,this.Bo=null,this.qo=null,this.Uo=Number.NEGATIVE_INFINITY,this.Qo=function(t){return Promise.resolve()},!Oh.Gs())throw new Br(Fr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Vr=new kh(this,r),this.Ko=e+"main",this.serializer=new fc(u),this.Wo=new xa(this.Ko,11,new qc(this.serializer)),this.jo=new gh(this.Vr,this.serializer),this.os=new ph,this.ss=(e=this.serializer,u=this.os,new xc(e,u)),this.Go=new ch(this.serializer),this.window&&this.window.localStorage?this.zo=this.window.localStorage:(this.zo=null,!1===c&&Cr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Sh(t,e){var n=this;return(n=Eh.call(this)||this).Lr=t,n.Fo=e,n}function Dh(t){return Nh.Ys(t,Bc.store)}function xh(t){return Nh.Ys(t,oh.store)}var kh=(Ph.prototype.Er=function(t){var n=this.Vc(t);return this.db.Ac().vo(t).next(function(e){return n.next(function(t){return e+t})})},Ph.prototype.Vc=function(t){var e=0;return this.Ir(t,function(t){e++}).next(function(){return e})},Ph.prototype.Ue=function(t,e){return this.db.Ac().Ue(t,e)},Ph.prototype.Ir=function(t,n){return this.vc(t,function(t,e){return n(e)})},Ph.prototype.Do=function(t,e,n){return Rh(t,n)},Ph.prototype.No=function(t,e,n){return Rh(t,n)},Ph.prototype.mr=function(t,e,n){return this.db.Ac().mr(t,e,n)},Ph.prototype.qr=Rh,Ph.prototype.bc=function(t,e){return r=e,i=!1,Sc(n=t).fi(function(t){return Tc(n,t,r).next(function(t){return t&&(i=!0),fa.resolve(!t)})}).next(function(){return i});var n,r,i},Ph.prototype.Ar=function(n,r){var i=this,o=this.db.Rc().Xr(),s=[],u=0;return this.vc(n,function(e,t){t<=r&&(t=i.bc(n,e).next(function(t){if(!t)return u++,o.Jn(n,e).next(function(){return o.Hn(e),Ih(n).delete([0,ac(e.path)])})}),s.push(t))}).next(function(){return fa.qn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Ph.prototype.removeTarget=function(t,e){e=e.dt(t.Fo);return this.db.Ac().yo(t,e)},Ph.prototype.Sc=Rh,Ph.prototype.vc=function(t,r){var i,t=Ih(t),o=Ea.Ds;return t._i({index:eh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==Ea.Ds&&r(new hi(hc(i)),o),o=e,i=t):o=Ea.Ds}).next(function(){o!==Ea.Ds&&r(new hi(hc(i)),o)})},Ph.prototype.Pr=function(t){return this.db.Rc().eo(t)},Ph);function Ph(t,e){this.db=t,this.cr=new oc(this,e)}function Rh(t,e){return Ih(t).put((t=t.Fo,new eh(0,ac(e.path),t)))}function Ch(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Lh=(Vh.prototype._r=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Rr(t,n.Cc)})},Vh);function Vh(t,e,n,r){this.persistence=t,this.Dc=e,this.serializer=r,this.Cc=new Ri(ti),this.Nc=new ha(Ii,Ei),this.xc=si.min(),this.rs=t.mc(n),this.Fc=t.Rc(),this.jo=t.Ac(),this.Oc=new _a(this.Fc,this.rs,this.persistence.Pc()),this.Go=t.gc(),this.Dc.Mc(this.Oc)}function Mh(t,e,n,r){return new Lh(t,e,n,r)}function Uh(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).rs,m=e.Oc,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.rs.Mr(v).next(function(t){return g=t,n=e.persistence.mc(o),m=new _a(e.Fc,n,e.persistence.Pc()),n.Mr(v)}).next(function(t){for(var e=[],n=[],r=Yi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m._s(v,r).next(function(t){return{kc:t,$c:e,Lc:n}})})})];case 1:return r=t.sent(),[2,(e.rs=n,e.Oc=m,e.Dc.Mc(e.Oc),r)]}})})}function jh(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Fc.Xr({Zr:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=fa.resolve(),n.forEach(function(n){u=u.next(function(){return o.Jn(r,n)}).next(function(t){var e=t,t=i.Sn.get(n);Ur(null!==t),(!e||e.version.F(t)<0)&&(e=s.yn(n,e,i))&&o.jn(e,i.bn)})}),u.next(function(){return e.rs.$r(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.rs.Ur(t)}).next(function(){return f.Oc._s(t,a)})})}function qh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.jo.To(t)})}function Fh(t,o){var h=t,f=o.ft,l=h.Cc;return h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=h.Fc.Xr({Zr:!0});l=h.Cc;var u=[];o.re.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.jo.Co(s,t.de,e).next(function(){return h.jo.So(s,t._e,e)})),0<(i=t.resumeToken).ht()&&(n=o.wt(i,f).dt(s.Fo),l=l.Tt(e,n),r=o,i=t,Ur(0<(o=n).resumeToken.ht()),(0===r.resumeToken.ht()||3e8<=o.ft.O()-r.ft.O()||0<i._e.size+i.fe.size+i.de.size)&&u.push(h.jo.yo(s,n))))});var e,a,n,c,r,i=Bi;return o.ce.forEach(function(t,e){o.ue.has(t)&&u.push(h.persistence.Vr.Sc(s,t))}),u.push((e=s,a=t,n=o.ce,c=f,r=Yi(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=Bi;return n.forEach(function(t,e){var n=i.get(t),r=c;e instanceof fu&&e.version.isEqual(si.min())?(a.Hn(t,r),o=o.Tt(t,e)):null==n||0<e.version.F(n.version)||0===e.version.F(n.version)&&n.hasPendingWrites?(a.jn(e,r),o=o.Tt(t,e)):Rr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),f.isEqual(si.min())||(e=h.jo.To(s).next(function(t){return h.jo.mo(s,s.Fo,f)}),u.push(e)),fa.qn(u).next(function(){return t.apply(s)}).next(function(){return h.Oc.fs(s,i)})}).then(function(t){return h.Cc=l,t})}function Bh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.jo.bo(e,r).next(function(t){return t?(n=t,fa.resolve(n)):i.jo.fo(e).next(function(t){return n=new Di(r,t,0,e.Fo),i.jo.Ao(e,n).next(function(){return n})})})}).then(function(t){var e=i.Cc.get(t.targetId);return(null===e||0<t.ft.F(e.ft))&&(i.Cc=i.Cc.Tt(t.targetId,t),i.Nc.set(r,t.targetId)),t})}function zh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Cc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Vr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ma(r=t.sent()))throw r;return Rr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Cc=e.Cc.remove(o),e.Nc.delete(n.target),[2]}})})}function Gh(t,o,s){var u=t,a=si.min(),c=Yi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Au(o),(void 0!==(t=(i=t).Nc.get(r))?fa.resolve(i.Cc.get(t)):i.jo.bo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.jo.xo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.Dc.ws(e,o,s?a:si.min(),s?c:Yi())}).next(function(t){return{documents:t,Bc:c}});var t,n,r,i})}function Kh(t,e){var n=t,r=n.jo,t=n.Cc.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ze(t,e).next(function(t){return t?t.target:null})})}function Wh(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Fc,n=t,t=s.xc,r=e,i=Bi,o=dc(t),t=Lc(n),n=IDBKeyRange.lowerBound(o,!0),t._i({index:$c.readTimeIndex,range:n},function(t,e){var n=lc(r.serializer,e);i=i.Tt(n.key,n),o=e.readTime}).next(function(){return{qc:i,readTime:yc(o)}});var e,n,r,i,o}).then(function(t){var e=t.qc,t=t.readTime;return s.xc=t,e})}function Hh(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Lc(t),r=si.min(),t._i({index:$c.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=yc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.xc=t})]})})}function Yh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Fr.FAILED_PRECONDITION||e.message!==ba)throw e;return Rr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Qh(t,e,n,r,i){var o=this;this.Cu=t,this.Nu=e,this.di=n,this.xu={},this.Fu=[],this.Ou=new Map,this.Mu=new Set,this.ku=[],this.$u=i,this.$u.Lu(function(t){n.Ri(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return gf(this)?(Rr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Mu.add(4),[4,hf(e)];case 1:return t.sent(),e.Bu.set("Unknown"),e.Mu.delete(4),[4,cf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Bu=new nf(n,r)}var Xh,Jh,$h,Ee=(af.prototype.Gc=function(){return 1===this.state||2===this.state||4===this.state},af.prototype.zc=function(){return 2===this.state},af.prototype.start=function(){3!==this.state?this.auth():this.Hc()},af.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Gc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},af.prototype.Jc=function(){this.state=0,this.Si.reset()},af.prototype.Yc=function(){var t=this;this.zc()&&null===this.jc&&(this.jc=this.Cs.Us(this.Uc,6e4,function(){return t.Xc()}))},af.prototype.Zc=function(t){this.tu(),this.stream.send(t)},af.prototype.Xc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.zc()?[2,this.close(0)]:[2]})})},af.prototype.tu=function(){this.jc&&(this.jc.cancel(),this.jc=null)},af.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.tu(),this.Si.cancel(),this.Wc++,3!==e?this.Si.reset():n&&n.code===Fr.RESOURCE_EXHAUSTED?(Cr(n.toString()),Cr("Using maximum backoff delay to prevent overloading the backend."),this.Si.Ls()):n&&n.code===Fr.UNAUTHENTICATED&&this.Kc.m(),null!==this.stream&&(this.eu(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.nu(n)];case 1:return t.sent(),[2]}})})},af.prototype.eu=function(){},af.prototype.auth=function(){var n=this;this.state=1;var t=this.su(this.Wc),e=this.Wc;this.Kc.getToken().then(function(t){n.Wc===e&&n.iu(t)},function(e){t(function(){var t=new Br(Fr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ru(t)})})},af.prototype.iu=function(t){var e=this,n=this.su(this.Wc);this.stream=this.ou(t),this.stream.cu(function(){n(function(){return e.state=2,e.listener.cu()})}),this.stream.nu(function(t){n(function(){return e.ru(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},af.prototype.Hc=function(){var t=this;this.state=4,this.Si.Bs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},af.prototype.ru=function(t){return Rr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},af.prototype.su=function(e){var n=this;return function(t){n.Cs.Ri(function(){return n.Wc===e?t():(Rr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},af),Zh=(n(uf,$h=Ee),uf.prototype.ou=function(t){return this.Qc.uu("Listen",t)},uf.prototype.onMessage=function(t){this.Si.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Mr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.tn?(Ur(void 0===o||"string"==typeof o),Ai.fromBase64String(o||"")):(Ur(void 0===o||o instanceof Uint8Array),Ai.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Fr.UNKNOWN:Pi(s.code),new Br(o,s.message||"")),r=new ro(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=Qo(t,u.document.name),a=Ko(u.document.updateTime),s=new eu({mapValue:{fields:u.document.fields}}),a=new hu(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new eo(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=Qo(t,u.document),c=u.readTime?Ko(u.readTime):si.min(),c=new fu(a,c),u=u.removedTargetIds||[];r=new eo([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;c=e.documentRemove;c.document;var h=Qo(t,c.document),c=c.removedTargetIds||[];r=new eo([],c,h,null)}else{if(!("filter"in e))return Mr();e.filter;h=e.filter;h.targetId;e=h.count||0,e=new Oi(e),h=h.targetId;r=new no(h,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return si.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Ko(t.readTime):si.min()}(t);return this.listener.au(e,t)},uf.prototype.hu=function(t){var e,n,r,i={};i.database=$o(this.serializer),i.addTarget=(e=this.serializer,(r=Ti(r=(n=t).target)?{documents:rs(e,r)}:{query:is(e,r)}).targetId=n.targetId,0<n.resumeToken.ht()?r.resumeToken=Go(e,n.resumeToken):0<n.ft.F(si.min())&&(r.readTime=zo(e,n.ft.M())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o._t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Mr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.Zc(i)},uf.prototype.lu=function(t){var e={};e.database=$o(this.serializer),e.removeTarget=t,this.Zc(e)},uf),tf=(n(sf,Jh=Ee),Object.defineProperty(sf.prototype,"fu",{get:function(){return this._u},enumerable:!1,configurable:!0}),sf.prototype.start=function(){this._u=!1,this.lastStreamToken=void 0,Jh.prototype.start.call(this)},sf.prototype.eu=function(){this._u&&this.du([])},sf.prototype.ou=function(t){return this.Qc.uu("Write",t)},sf.prototype.onMessage=function(t){if(Ur(!!t.streamToken),this.lastStreamToken=t.streamToken,this._u){this.Si.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Ur(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Ko(t.updateTime):Ko(e);n.isEqual(si.min())&&(n=Ko(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Ps(n,e)}(t,r)})):[]),n=Ko(t.commitTime);return this.listener.wu(n,e)}var n,r;return Ur(!t.writeResults||0===t.writeResults.length),this._u=!0,this.listener.Eu()},sf.prototype.Tu=function(){var t={};t.database=$o(this.serializer),this.Zc(t)},sf.prototype.du=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return es(e.serializer,t)})};this.Zc(t)},sf),ef=(n(of,Xh=function(){}),of.prototype.mu=function(){if(this.Iu)throw new Br(Fr.FAILED_PRECONDITION,"The client has already been terminated.")},of.prototype.Au=function(e,n,r){var i=this;return this.mu(),this.credentials.getToken().then(function(t){return i.Qc.Au(e,n,r,t)}).catch(function(t){throw t.code===Fr.UNAUTHENTICATED&&i.credentials.m(),t})},of.prototype.Ru=function(e,n,r){var i=this;return this.mu(),this.credentials.getToken().then(function(t){return i.Qc.Ru(e,n,r,t)}).catch(function(t){throw t.code===Fr.UNAUTHENTICATED&&i.credentials.m(),t})},of.prototype.terminate=function(){this.Iu=!1},of),nf=(rf.prototype.pu=function(){var t=this;0===this.gu&&(this.vu("Unknown"),this.yu=this.di.Us("online_state_timeout",1e4,function(){return t.yu=null,t.bu("Backend didn't respond within 10 seconds."),t.vu("Offline"),Promise.resolve()}))},rf.prototype.Su=function(t){"Online"===this.state?this.vu("Unknown"):(this.gu++,1<=this.gu&&(this.Du(),this.bu("Connection failed 1 times. Most recent error: "+t.toString()),this.vu("Offline")))},rf.prototype.set=function(t){this.Du(),this.gu=0,"Online"===t&&(this.Vu=!1),this.vu(t)},rf.prototype.vu=function(t){t!==this.state&&(this.state=t,this.Pu(t))},rf.prototype.bu=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vu?(Cr(t),this.Vu=!1):Rr("OnlineStateTracker",t)},rf.prototype.Du=function(){null!==this.yu&&(this.yu.cancel(),this.yu=null)},rf);function rf(t,e){this.di=t,this.Pu=e,this.state="Unknown",this.gu=0,this.yu=null,this.Vu=!0}function of(t,e,n){var r=this;return(r=Xh.call(this)||this).credentials=t,r.Qc=e,r.serializer=n,r.Iu=!1,r}function sf(t,e,n,r,i){var o=this;return(o=Jh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o._u=!1,o}function uf(t,e,n,r,i){var o=this;return(o=$h.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function af(t,e,n,r,i,o){this.Cs=t,this.Uc=n,this.Qc=r,this.Kc=i,this.listener=o,this.state=0,this.Wc=0,this.jc=null,this.stream=null,this.Si=new Da(t,e)}function cf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!gf(r))return[3,4];e=0,n=r.ku,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function hf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ku,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function ff(t,e){t.Ou.has(e.targetId)||(t.Ou.set(e.targetId,e),vf(t)?yf(t):Nf(t).zc()&&pf(t,e))}function lf(t,e){var n=t,t=Nf(n);n.Ou.delete(e),t.zc()&&df(n,e),0===n.Ou.size&&(t.zc()?t.Yc():gf(n)&&n.Bu.set("Unknown"))}function pf(t,e){t.qu.De(e.targetId),Nf(t).hu(e)}function df(t,e){t.qu.De(e),Nf(t).lu(e)}function yf(e){e.qu=new oo({Xe:function(t){return e.xu.Xe(t)},Ze:function(t){return e.Ou.get(t)||null}}),Nf(e).start(),e.Bu.pu()}function vf(t){return gf(t)&&!Nf(t).Gc()&&0<t.Ou.size}function gf(t){return 0===t.Mu.size}function mf(t){t.qu=void 0}function wf(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Bu.set("Online"),!(u instanceof ro&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Ou.has(i)?[4,o.xu.Uu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Ou.delete(i),o.qu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Rr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,bf(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof eo?s.qu.$e(u):u instanceof no?s.qu.je(u):s.qu.qe(u),a.isEqual(si.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,qh(s.Cu)];case 8:return o=t.sent(),0<=a.F(o)?[4,(i=a,(e=(r=s).qu.He(i)).re.forEach(function(t,e){var n;0<t.resumeToken.ht()&&((n=r.Ou.get(e))&&r.Ou.set(e,n.wt(t.resumeToken,i)))}),e.oe.forEach(function(t){var e=r.Ou.get(t);e&&(r.Ou.set(t,e.wt(Ai.lt,e.ft)),df(r,t),e=new Di(e.target,t,1,e.sequenceNumber),pf(r,e))}),r.xu.Qu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Rr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,bf(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function bf(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Ma(r))throw r;return n.Mu.add(1),[4,hf(n)];case 1:return t.sent(),n.Bu.set("Offline"),i=i||function(){return qh(n.Cu)},n.di.Mi(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Rr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Mu.delete(1),[4,cf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function _f(e,n){return n().catch(function(t){return bf(e,t,n)})}function If(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Of(i=a),s=0<i.Fu.length?i.Fu[i.Fu.length-1].batchId:-1,t.label=1;case 1:if(!(gf(i)&&i.Fu.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Cu,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.rs.Fr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Fu.length&&o.Yc(),[3,7]):(s=u.batchId,function(t,e){t.Fu.push(e);t=Of(t);t.zc()&&t.fu&&t.du(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,bf(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Ef(i)&&Tf(i),[2]}var e,n,r})})}function Ef(t){return gf(t)&&!Of(t).Gc()&&0<t.Fu.length}function Tf(t){Of(t).start()}function Af(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Mu.delete(2),[4,cf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Mu.add(2),[4,hf(e)]);case 3:t.sent(),e.Bu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Nf(n){var t,e,r,i=this;return n.ju||(n.ju=(t=n.Nu,e=n.di,r={cu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Ou.forEach(function(t,e){pf(n,t)}),[2]})})}.bind(null,n),nu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return mf(e),vf(e)?(e.Bu.Su(n),yf(e)):e.Bu.set("Unknown"),[2]})})}.bind(null,n),au:wf.bind(null,n)},t.mu(),new Zh(e,t.Qc,t.credentials,t.serializer,r)),n.ku.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ju.Jc(),vf(n)?yf(n):n.Bu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.ju.stop()];case 2:t.sent(),mf(n),t.label=3;case 3:return[2]}})})})),n.ju}function Of(n){var t,e,r,i=this;return n.Gu||(n.Gu=(t=n.Nu,e=n.di,r={cu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Of(e).Tu(),[2]})})}.bind(null,n),nu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Of(e).fu?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return ki(n=i.code)&&n!==Fr.ABORTED?(e=r.Fu.shift(),Of(r).Jc(),[4,_f(r,function(){return r.xu.Wu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,If(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Ef(e)&&Tf(e),[2]}})})}.bind(null,n),Eu:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Of(o),n=0,r=o.Fu;n<r.length;n++)i=r[n],e.du(i.mutations);return[2]})})}.bind(null,n),wu:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Fu.shift(),n=ca.from(e,i,o),[4,_f(r,function(){return r.xu.Ku(n)})];case 1:return t.sent(),[4,If(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.mu(),new tf(e,t.Qc,t.credentials,t.serializer,r)),n.ku.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Gu.Jc(),[4,If(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Gu.stop()];case 3:t.sent(),0<n.Fu.length&&(Rr("RemoteStore","Stopping write stream with "+n.Fu.length+" pending writes"),n.Fu=[]),t.label=4;case 4:return[2]}})})})),n.Gu}function Sf(){this.queries=new ha(Su,Ou),this.onlineState="Unknown",this.Hu=new Set}var Df=function(){this.zu=void 0,this.listeners=[]};function xf(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Df),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Ju(n)];case 2:return o.zu=t.sent(),[3,4];case 3:return o=t.sent(),o=Ja(o,"Initialization of query '"+Du(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Yu(e.onlineState),i.zu&&u.Xu(i.zu)&&Pf(e),[2]}})})}function kf(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Zu(n))]:[2]})})}function Pf(t){t.Hu.forEach(function(t){t.next()})}var Rf=(Uf.prototype.Xu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new $i(t.query,t.docs,t.te,e,t.ee,t.fromCache,t.ne,!0)}var o=!1;return this.ea?this.sa(t)&&(this.ta.next(t),o=!0):this.ia(t,this.onlineState)&&(this.ra(t),o=!0),this.na=t,o},Uf.prototype.onError=function(t){this.ta.error(t)},Uf.prototype.Yu=function(t){this.onlineState=t;var e=!1;return this.na&&!this.ea&&this.ia(this.na,t)&&(this.ra(this.na),e=!0),e},Uf.prototype.ia=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.oa&&n||t.docs.W()&&"Offline"!==e)},Uf.prototype.sa=function(t){if(0<t.docChanges.length)return!0;var e=this.na&&this.na.hasPendingWrites!==t.hasPendingWrites;return!(!t.ne&&!e)&&!0===this.options.includeMetadataChanges},Uf.prototype.ra=function(t){t=$i.ie(t.query,t.docs,t.ee,t.fromCache),this.ea=!0,this.ta.next(t)},Uf),Cf=(Mf.prototype.W=function(){return this.ca.W()},Mf.prototype.Do=function(t,e){e=new Lf(t,e);this.ca=this.ca.add(e),this.aa=this.aa.add(e)},Mf.prototype.la=function(t,e){var n=this;t.forEach(function(t){return n.Do(t,e)})},Mf.prototype.No=function(t,e){this._a(new Lf(t,e))},Mf.prototype.fa=function(t,e){var n=this;t.forEach(function(t){return n.No(t,e)})},Mf.prototype.da=function(t){var e=this,n=new hi(new ui([])),r=new Lf(n,t),t=new Lf(n,t+1),i=[];return this.aa.Kt([r,t],function(t){e._a(t),i.push(t.key)}),i},Mf.prototype.wa=function(){var e=this;this.ca.forEach(function(t){return e._a(t)})},Mf.prototype._a=function(t){this.ca=this.ca.delete(t),this.aa=this.aa.delete(t)},Mf.prototype.Ea=function(t){var e=new hi(new ui([])),n=new Lf(e,t),t=new Lf(e,t+1),r=Yi();return this.aa.Kt([n,t],function(t){r=r.add(t.key)}),r},Mf.prototype.Qr=function(t){var e=new Lf(t,0),e=this.ca.jt(e);return null!==e&&t.isEqual(e.key)},Mf),Lf=(Vf.ua=function(t,e){return hi.$(t.key,e.key)||ti(t.Ta,e.Ta)},Vf.ha=function(t,e){return ti(t.Ta,e.Ta)||hi.$(t.key,e.key)},Vf);function Vf(t,e){this.key=t,this.Ta=e}function Mf(){this.ca=new qi(Lf.ua),this.aa=new qi(Lf.ha)}function Uf(t,e,n){this.query=t,this.ta=e,this.ea=!1,this.na=null,this.onlineState="Unknown",this.options=n||{}}function jf(t,e){return"firestore_clients_"+t+"_"+e}function qf(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.u()&&(n+="_"+e.uid),n}function Ff(t,e){return"firestore_targets_"+t+"_"+e}var Bf=(cl.Ia=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Br(r.error.code,r.error.message)),i?new cl(t,e,r.state,o):(Cr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},cl.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},cl),zf=(al.Ia=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Br(n.error.code,n.error.message)),r?new al(t,n.state,i):(Cr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},al.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},al),Gf=(ul.Ia=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Qi,o=0;r&&o<n.activeTargetIds.length;++o)r=wi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new ul(t,i):(Cr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},ul),Kf=(sl.Ia=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new sl(e.clientId,e.onlineState):(Cr("SharedClientState","Failed to parse online state: "+t),null)},sl),Wf=(ol.prototype.Aa=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},ol.prototype.Ra=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},ol.prototype.ma=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},ol),Hf=(il.Gs=function(t){return!(!t||!t.localStorage)},il.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.ga.Ic()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Pa&&(i=this.getItem(jf(this.persistenceKey,r)))&&(o=Gf.Ia(r,i))&&(this.pa=this.pa.Tt(o.clientId,o));for(this.Oa(),(s=this.storage.getItem(this.xa))&&(u=this.Ma(s))&&this.ka(u),a=0,c=this.va;a<c.length;a++)h=c[a],this.Va(h);return this.va=[],this.window.addEventListener("unload",function(){return f.fc()}),this.lr=!0,[2]}})})},il.prototype.Ss=function(t){this.setItem(this.Sa,JSON.stringify(t))},il.prototype.$a=function(){return this.La(this.pa)},il.prototype.Ba=function(n){var r=!1;return this.pa.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},il.prototype.qa=function(t){this.Ua(t,"pending")},il.prototype.Qa=function(t,e,n){this.Ua(t,e,n),this.Ka(t)},il.prototype.Wa=function(t){var e,n="not-current";return this.Ba(t)&&(!(e=this.storage.getItem(Ff(this.persistenceKey,t)))||(e=zf.Ia(t,e))&&(n=e.state)),this.ja.Aa(t),this.Oa(),n},il.prototype.Ga=function(t){this.ja.Ra(t),this.Oa()},il.prototype.za=function(t){return this.ja.activeTargetIds.has(t)},il.prototype.Ha=function(t){this.removeItem(Ff(this.persistenceKey,t))},il.prototype.Ja=function(t,e,n){this.Ya(t,e,n)},il.prototype.Xa=function(t,e,n){var r=this;e.forEach(function(t){r.Ka(t)}),this.currentUser=t,n.forEach(function(t){r.qa(t)})},il.prototype.Za=function(t){this.th(t)},il.prototype.eh=function(){this.nh()},il.prototype.fc=function(){this.lr&&(this.window.removeEventListener("storage",this.ya),this.removeItem(this.ba),this.lr=!1)},il.prototype.getItem=function(t){var e=this.storage.getItem(t);return Rr("SharedClientState","READ",t,e),e},il.prototype.setItem=function(t,e){Rr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},il.prototype.removeItem=function(t){Rr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},il.prototype.Va=function(t){var e=this,o=t;if(o.storageArea===this.storage){if(Rr("SharedClientState","EVENT",o.key,o.newValue),o.key===this.ba)return void Cr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Cs.Mi(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.lr){if(null!==o.key)if(this.Da.test(o.key)){if(null==o.newValue)return e=this.sh(o.key),[2,this.ih(e,null)];if(e=this.rh(o.key,o.newValue))return[2,this.ih(e.clientId,e)]}else if(this.Ca.test(o.key)){if(null!==o.newValue&&(n=this.oh(o.key,o.newValue)))return[2,this.uh(n)]}else if(this.Na.test(o.key)){if(null!==o.newValue&&(r=this.ah(o.key,o.newValue)))return[2,this.hh(r)]}else if(o.key===this.xa){if(null!==o.newValue&&(i=this.Ma(o.newValue)))return[2,this.ka(i)]}else if(o.key===this.Sa)(i=function(t){var e=Ea.Ds;if(null!=t)try{var n=JSON.parse(t);Ur("number"==typeof n),e=n}catch(t){Cr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==Ea.Ds&&this.ps(i);else if(o.key===this.Fa)return[2,this.ga.lh()]}else this.va.push(o);return[2]})})})}},Object.defineProperty(il.prototype,"ja",{get:function(){return this.pa.get(this.Pa)},enumerable:!1,configurable:!0}),il.prototype.Oa=function(){this.setItem(this.ba,this.ja.ma())},il.prototype.Ua=function(t,e,n){n=new Bf(this.currentUser,t,e,n),t=qf(this.persistenceKey,this.currentUser,t);this.setItem(t,n.ma())},il.prototype.Ka=function(t){t=qf(this.persistenceKey,this.currentUser,t);this.removeItem(t)},il.prototype.th=function(t){t={clientId:this.Pa,onlineState:t};this.storage.setItem(this.xa,JSON.stringify(t))},il.prototype.Ya=function(t,e,n){var r=Ff(this.persistenceKey,t),n=new zf(t,e,n);this.setItem(r,n.ma())},il.prototype.nh=function(){this.setItem(this.Fa,"value-not-used")},il.prototype.sh=function(t){t=this.Da.exec(t);return t?t[1]:null},il.prototype.rh=function(t,e){t=this.sh(t);return Gf.Ia(t,e)},il.prototype.oh=function(t,e){var n=this.Ca.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return Bf.Ia(new Sr(n),t,e)},il.prototype.ah=function(t,e){t=this.Na.exec(t),t=Number(t[1]);return zf.Ia(t,e)},il.prototype.Ma=function(t){return Kf.Ia(t)},il.prototype.uh=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.ga._h(e.batchId,e.state,e.error)]:(Rr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},il.prototype.hh=function(t){return this.ga.fh(t.targetId,t.state,t.error)},il.prototype.ih=function(t,e){var n=this,r=e?this.pa.Tt(t,e):this.pa.remove(t),i=this.La(this.pa),o=this.La(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.ga.dh(s,u).then(function(){n.pa=r})},il.prototype.ka=function(t){this.pa.get(t.clientId)&&this.Pu(t.onlineState)},il.prototype.La=function(t){var n=Qi;return t.forEach(function(t,e){n=n.Gt(e.activeTargetIds)}),n},il),Yf=(rl.prototype.qa=function(t){},rl.prototype.Qa=function(t,e,n){},rl.prototype.Wa=function(t){return this.wh.Aa(t),this.Eh[t]||"not-current"},rl.prototype.Ja=function(t,e,n){this.Eh[t]=e},rl.prototype.Ga=function(t){this.wh.Ra(t)},rl.prototype.za=function(t){return this.wh.activeTargetIds.has(t)},rl.prototype.Ha=function(t){delete this.Eh[t]},rl.prototype.$a=function(){return this.wh.activeTargetIds},rl.prototype.Ba=function(t){return this.wh.activeTargetIds.has(t)},rl.prototype.start=function(){return this.wh=new Wf,Promise.resolve()},rl.prototype.Xa=function(t,e,n){},rl.prototype.Za=function(t){},rl.prototype.fc=function(){},rl.prototype.Ss=function(t){},rl.prototype.eh=function(){},rl),Qf=function(t){this.key=t},Xf=function(t){this.key=t},Jf=(Object.defineProperty(nl.prototype,"Ph",{get:function(){return this.Th},enumerable:!1,configurable:!0}),nl.prototype.gh=function(t,e){var s=this,u=e?e.yh:new Ji,a=(e||this).Rh,c=(e||this).ee,h=a,f=!1,l=wu(this.query)&&a.size===this.query.limit?a.last():null,p=bu(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pt(function(t,e){var n=a.get(t),r=(r=e instanceof hu?e:null)&&(xu(s.query,r)?r:null),i=!!n&&s.ee.has(n.key),o=!!r&&(r.an||s.ee.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Vh(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.Ah(r,l)||p&&s.Ah(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),wu(this.query)||bu(this.query))for(;h.size>this.query.limit;){var n=wu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Rh:h,yh:u,ph:f,ee:c}},nl.prototype.Vh=function(t,e){return t.an&&e.hasCommittedMutations&&!e.an},nl.prototype.Zn=function(t,e,n){var o=this,r=this.Rh;this.Rh=t.Rh,this.ee=t.ee;var i=t.yh.Zt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Ah(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Mr()}}var r,i}),this.bh(n);var s=e?this.Sh():[],n=0===this.mh.size&&this.le?1:0,e=n!==this.Ih;return this.Ih=n,0!==i.length||e?{snapshot:new $i(this.query,t.Rh,r,i,t.ee,0==n,e,!1),Dh:s}:{Dh:s}},nl.prototype.Yu=function(t){return this.le&&"Offline"===t?(this.le=!1,this.Zn({Rh:this.Rh,yh:new Ji,ee:this.ee,ph:!1},!1)):{Dh:[]}},nl.prototype.Ch=function(t){return!this.Th.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).an},nl.prototype.bh=function(t){var e=this;t&&(t._e.forEach(function(t){return e.Th=e.Th.add(t)}),t.fe.forEach(function(t){}),t.de.forEach(function(t){return e.Th=e.Th.delete(t)}),this.le=t.le)},nl.prototype.Sh=function(){var e=this;if(!this.le)return[];var n=this.mh;this.mh=Yi(),this.Rh.forEach(function(t){e.Ch(t.key)&&(e.mh=e.mh.add(t.key))});var r=[];return n.forEach(function(t){e.mh.has(t)||r.push(new Xf(t))}),this.mh.forEach(function(t){n.has(t)||r.push(new Qf(t))}),r},nl.prototype.Nh=function(t){this.Th=t.Bc,this.mh=Yi();t=this.gh(t.documents);return this.Zn(t,!0)},nl.prototype.xh=function(){return $i.ie(this.query,this.Rh,this.ee,0===this.Ih)},nl),$f=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Zf=function(t){this.key=t,this.Fh=!1},tl=(Object.defineProperty(el.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),el);function el(t,e,n,r,i,o){this.Cu=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new ha(Su,Ou),this.qh=new Map,this.Uh=[],this.Qh=new Ri(hi.$),this.Kh=new Map,this.Wh=new Cf,this.jh={},this.Gh=new Map,this.zh=vh._o(),this.onlineState="Unknown",this.Hh=void 0}function nl(t,e){this.query=t,this.Th=e,this.Ih=null,this.le=!1,this.mh=Yi(),this.ee=Yi(),this.Ah=ku(t),this.Rh=new Xi(this.Ah)}function rl(){this.wh=new Wf,this.Eh={},this.Pu=null,this.ps=null}function il(t,e,n,r,i){this.window=t,this.Cs=e,this.persistenceKey=n,this.Pa=r,this.ga=null,this.Pu=null,this.ps=null,this.ya=this.Va.bind(this),this.pa=new Ri(ti),this.lr=!1,this.va=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ba=jf(this.persistenceKey,this.Pa),this.Sa="firestore_sequence_number_"+this.persistenceKey,this.pa=this.pa.Tt(this.Pa,new Wf),this.Da=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Ca=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Na=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.xa="firestore_online_state_"+this.persistenceKey,this.Fa="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.ya)}function ol(){this.activeTargetIds=Qi}function sl(t,e){this.clientId=t,this.onlineState=e}function ul(t,e){this.clientId=t,this.activeTargetIds=e}function al(t,e,n){this.targetId=t,this.state=e,this.error=n}function cl(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function hl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Yh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.gh(o)).ph?[4,Gh(r.Cu,i.query,!1).then(function(t){t=t.documents;return i.view.gh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.re.get(i.targetId),n=i.view.Zn(e,r.Jh,n),[2,(bl(r,i.targetId,n.Dh),n.snapshot)]}})})}(i,t,e,n)},[4,Gh(i.Cu,o,!0)];case 1:return n=t.sent(),r=new Jf(o,n.Bc),e=r.gh(n.documents),n=to.he(s,u&&"Offline"!==i.onlineState),n=r.Zn(e,i.Jh,n),bl(i,s,n.Dh),r=new $f(o,s,r),[2,(i.Bh.set(o,r),i.qh.has(s)?i.qh.get(s).push(o):i.qh.set(s,[o]),n.snapshot)]}})})}function fl(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=Dl(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Cu,a=p,h=i,f=oi.now(),o=a.reduce(function(t,e){return t.add(e.key)},Yi()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Oc._s(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Ys?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof hu?t.field(i.field):void 0,o=ls(i.transform,o||null);null!=o&&(e=(null==e?new nu:e).set(i.field,o))}return e?e.hn():null}(o):null);null!=o&&e.push(new zs(i.key,o,function s(t){var u=[];return go(t.fields||{},function(t,e){var n=new ci([t]);if(Vo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ds(u)}(o.proto.mapValue),Rs.exists(!0)))}return h.rs.Sr(u,f,e,a)})}).then(function(t){var e=t.vn(c);return{batchId:t.batchId,Qn:e}}))];case 2:return s=t.sent(),u.kh.qa(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.jh[e.currentUser.h()])||new Ri(ti)).Tt(n,r),e.jh[e.currentUser.h()]=i,[4,Il(u,s.Qn)];case 3:return t.sent(),[4,If(u.Oh)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Ja(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function ll(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Fh(n.Cu,i)];case 2:return e=t.sent(),i.re.forEach(function(t,e){e=n.Kh.get(e);e&&(Ur(t._e.size+t.fe.size+t.de.size<=1),0<t._e.size?e.Fh=!0:0<t.fe.size?Ur(e.Fh):0<t.de.size&&(Ur(e.Fh),e.Fh=!1))}),[4,Il(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Yh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function pl(t,n,e){var r,t=t;(t.Jh&&0===e||!t.Jh&&1===e)&&(r=[],t.Bh.forEach(function(t,e){e=e.view.Yu(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Yu(i)&&(o=!0)}),o&&Pf(t)}(t.Mh,n),r.length&&t.Lh.au(r),t.onlineState=n,t.Jh&&t.kh.Za(n))}function dl(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Cu,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.rs.Cr(e,r).next(function(t){return Ur(null!==t),n=t.keys(),i.rs.$r(e,t)}).next(function(){return i.rs.Ur(e)}).next(function(){return i.Oc._s(e,n)})}))];case 2:return o=t.sent(),gl(n,u,a),vl(n,u),n.kh.Qa(u,"rejected",a),[4,Il(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Yh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function yl(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:gf((n=o).Oh)||Rr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Cu).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.rs.Or(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Gh.get(r)||[]).push(s),n.Gh.set(r,i),[3,4]);case 3:return i=t.sent(),i=Ja(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function vl(t,e){(t.Gh.get(e)||[]).forEach(function(t){t.resolve()}),t.Gh.delete(e)}function gl(t,e,n){var r=t,i=r.jh[r.currentUser.h()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.jh[r.currentUser.h()]=i)}function ml(e,t,n){void 0===n&&(n=null),e.kh.Ga(t);for(var r=0,i=e.qh.get(t);r<i.length;r++){var o=i[r];e.Bh.delete(o),n&&e.Lh.Xh(o,n)}e.qh.delete(t),e.Jh&&e.Wh.da(t).forEach(function(t){e.Wh.Qr(t)||wl(e,t)})}function wl(t,e){var n=t.Qh.get(e);null!==n&&(lf(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),_l(t))}function bl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Qf?(t.Wh.Do(o.key,e),function(t,e){e=e.key;t.Qh.get(e)||(Rr("SyncEngine","New document in limbo: "+e),t.Uh.push(e),_l(t))}(t,o)):o instanceof Xf?(Rr("SyncEngine","Document no longer in limbo: "+o.key),t.Wh.No(o.key,e),t.Wh.Qr(o.key)||wl(t,o.key)):Mr()}}function _l(t){for(;0<t.Uh.length&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new Zf(e)),t.Qh=t.Qh.Tt(e,n),ff(t.Oh,new Di(Au(mu(e.path)),n,2,Ea.Ds))}}function Il(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Bh.W()?[3,3]:(n.Bh.forEach(function(t,e){o.push(n.Yh(e,s,u).then(function(t){t&&(n.Jh&&n.kh.Ja(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Ia.Vs(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Lh.au(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return fa.forEach(c,function(e){return fa.forEach(e.gs,function(t){return r.persistence.Vr.Do(n,e.targetId,t)}).next(function(){return fa.forEach(e.ys,function(t){return r.persistence.Vr.No(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ma(e=t.sent()))throw e;return Rr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Cc.get(o),u=s.ft,u=s.Et(u),r.Cc=r.Cc.Tt(o,u));return[2]}})})}(n.Cu,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function El(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Rr("SyncEngine","User change. New user:",o.h()),[4,Uh(n.Cu,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Gh.forEach(function(t){t.forEach(function(t){t.reject(new Br(Fr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Gh.clear(),n.kh.Xa(o,r.$c,r.Lc),[4,Il(n,r.kc)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Tl(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Cu,n=a,i=(r=e).rs,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Nr(e,n).next(function(t){return t?r.Oc._s(e,t):fa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,If(o.Oh)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(gl(o,a,h||null),vl(o,a),o.Cu.rs.Br(a)):Mr(),t.label=4;case 4:return[4,Il(o,s)];case 5:return t.sent(),[3,7];case 6:Rr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function Al(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return Sl(r=h),Dl(r),!0!==f||!0===r.Hh?[3,3]:(e=r.kh.$a(),[4,Nl(r,e.H())]);case 1:return i=t.sent(),r.Hh=!0,[4,Af(r.Oh,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],ff(r.Oh,u);return[3,7];case 3:return!1!==f||!1===r.Hh?[3,7]:(a=[],c=Promise.resolve(),r.qh.forEach(function(t,e){r.kh.za(e)?a.push(e):c=c.then(function(){return ml(r,e),zh(r.Cu,e,!0)}),lf(r.Oh,e)}),[4,c]);case 4:return t.sent(),[4,Nl(r,a)];case 5:return t.sent(),(n=r).Kh.forEach(function(t,e){lf(n.Oh,e)}),n.Wh.wa(),n.Kh=new Map,n.Qh=new Ri(hi.$),r.Hh=!1,[4,Af(r.Oh,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function Nl(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.qh.get(s))&&0!==a.length?[4,Bh(e.Cu,Au(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Bh.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Gh((e=r).Cu,i.query,!0)];case 1:return n=t.sent(),n=i.view.Nh(n),[2,(e.Jh&&bl(e,i.targetId,n.Dh),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Kh(e.Cu,s)];case 8:return l=t.sent(),[4,Bh(e.Cu,l)];case 9:return u=t.sent(),[4,hl(e,Ol(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Lh.au(r),n)]}})})}function Ol(t){return gu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Sl(t){return t.Oh.xu.Qu=ll.bind(null,t),t.Oh.xu.Xe=function(t,e){var n=t;if((t=n.Kh.get(e))&&t.Fh)return Yi().add(t.key);var r=Yi();if(!(e=n.qh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Bh.get(s),r=r.Gt(s.view.Ph);return r}.bind(null,t),t.Oh.xu.Uu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).kh.Ja(s,"rejected",u),i=e.Kh.get(s),(n=i&&i.key)?(r=(r=new Ri(hi.$)).Tt(n,new fu(n,si.min())),i=Yi().add(n),i=new Zi(si.min(),new Map,new qi(ti),r,i),[4,ll(e,i)]):[3,2];case 1:return t.sent(),e.Qh=e.Qh.remove(n),e.Kh.delete(s),_l(e),[3,4];case 2:return[4,zh(e.Cu,s,!1).then(function(){return ml(e,s,u)}).catch(Yh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Lh.au=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Xu(s)&&(r=!0);u.zu=s}}r&&Pf(n)}.bind(null,t.Mh),t.Lh.Xh=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.Mh),t}function Dl(t){return t.Oh.xu.Ku=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,jh(e.Cu,o)];case 2:return r=t.sent(),gl(e,n,null),vl(e,n),e.kh.Qa(n,"acknowledged"),[4,Il(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Yh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.Oh.xu.Wu=dl.bind(null,t),t}var xl,kl,Pl,Rl,Cl,Ll=(wp.prototype.Mc=function(t){this.Zh=t},wp.prototype.ws=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.Tn.length||1===r.Tn.length&&r.Tn[0].field.tt())||i.isEqual(si.min())?this.tl(e,r):this.Zh._s(e,o).next(function(t){var n=s.el(r,t);return(wu(r)||bu(r))&&s.ph(r.limitType,n,o,i)?s.tl(e,r):(Pr()<=l.DEBUG&&Rr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Du(r)),s.Zh.ws(e,r,i).next(function(e){return n.forEach(function(t){e=e.Tt(t.key,t)}),e}))})},wp.prototype.el=function(n,t){var r=new qi(ku(n));return t.forEach(function(t,e){e instanceof hu&&xu(n,e)&&(r=r.add(e))}),r},wp.prototype.ph=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.F(r))},wp.prototype.tl=function(t,e){return Pr()<=l.DEBUG&&Rr("IndexFreeQueryEngine","Using full collection scan to execute query:",Du(e)),this.Zh.ws(t,e,si.min())},wp),Vl=(mp.prototype.br=function(t){return fa.resolve(0===this.rs.length)},mp.prototype.Sr=function(t,e,n,r){var i=this.nl;this.nl++,0<this.rs.length&&this.rs[this.rs.length-1];n=new aa(i,e,n,r);this.rs.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.sl=this.sl.add(new Lf(u.key,i)),this.os.Dr(t,u.key.path.q())}return fa.resolve(n)},mp.prototype.Cr=function(t,e){return fa.resolve(this.il(e))},mp.prototype.Fr=function(t,e){e+=1,e=this.rl(e),e=e<0?0:e;return fa.resolve(this.rs.length>e?this.rs[e]:null)},mp.prototype.Or=function(){return fa.resolve(0===this.rs.length?-1:this.nl-1)},mp.prototype.Mr=function(t){return fa.resolve(this.rs.slice())},mp.prototype.us=function(t,e){var n=this,r=new Lf(e,0),e=new Lf(e,Number.POSITIVE_INFINITY),i=[];return this.sl.Kt([r,e],function(t){t=n.il(t.Ta);i.push(t)}),fa.resolve(i)},mp.prototype.ds=function(t,e){var n=this,r=new qi(ti);return e.forEach(function(t){var e=new Lf(t,0),t=new Lf(t,Number.POSITIVE_INFINITY);n.sl.Kt([e,t],function(t){r=r.add(t.Ta)})}),fa.resolve(this.ol(r))},mp.prototype.Rs=function(t,e){var n=e.path,r=n.length+1,e=n;hi.ot(e)||(e=e.child(""));var e=new Lf(new hi(e),0),i=new qi(ti);return this.sl.Wt(function(t){var e=t.key.path;return!!n.j(e)&&(e.length===r&&(i=i.add(t.Ta)),!0)},e),fa.resolve(this.ol(i))},mp.prototype.ol=function(t){var e=this,n=[];return t.forEach(function(t){t=e.il(t);null!==t&&n.push(t)}),n},mp.prototype.$r=function(n,r){var i=this;Ur(0===this.cl(r.batchId,"removed")),this.rs.shift();var o=this.sl;return fa.forEach(r.mutations,function(t){var e=new Lf(t.key,r.batchId);return o=o.delete(e),i.Vr.qr(n,t.key)}).next(function(){i.sl=o})},mp.prototype.Br=function(t){},mp.prototype.Qr=function(t,e){var n=new Lf(e,0),n=this.sl.jt(n);return fa.resolve(e.isEqual(n&&n.key))},mp.prototype.Ur=function(t){return this.rs.length,fa.resolve()},mp.prototype.cl=function(t,e){return this.rl(t)},mp.prototype.rl=function(t){return 0===this.rs.length?0:t-this.rs[0].batchId},mp.prototype.il=function(t){t=this.rl(t);return t<0||t>=this.rs.length?null:this.rs[t]},mp),Ml=(gp.prototype.jn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.ul(e);return this.docs=this.docs.Tt(r,{zn:e,size:i,readTime:n}),this.size+=i-o,this.os.Dr(t,r.path.q())},gp.prototype.Hn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},gp.prototype.Jn=function(t,e){e=this.docs.get(e);return fa.resolve(e?e.zn:null)},gp.prototype.getEntries=function(t,e){var n=this,r=Bi;return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.zn:null)}),fa.resolve(r)},gp.prototype.ws=function(t,e,n){for(var r=Ki,i=new hi(e.path.child("")),o=this.docs.Vt(i);o.Nt();){var s=o.Ct(),u=s.key,a=s.value,s=a.zn,a=a.readTime;if(!e.path.j(u.path))break;a.F(n)<=0||s instanceof hu&&xu(e,s)&&(r=r.Tt(s.key,s))}return fa.resolve(r)},gp.prototype.al=function(t,e){return fa.forEach(this.docs,function(t){return e(t)})},gp.prototype.Xr=function(t){return new Ul(this)},gp.prototype.eo=function(t){return fa.resolve(this.size)},gp),Ul=(n(vp,Cl=h),vp.prototype.Zn=function(n){var r=this,i=[];return this.Qn.forEach(function(t,e){e&&e.zn?i.push(r.no.jn(n,e.zn,r.Wn(t))):r.no.Hn(t)}),fa.qn(i)},vp.prototype.Yn=function(t,e){return this.no.Jn(t,e)},vp.prototype.Xn=function(t,e){return this.no.getEntries(t,e)},vp),jl=(yp.prototype.Ue=function(t,n){return this.hl.forEach(function(t,e){return n(e)}),fa.resolve()},yp.prototype.To=function(t){return fa.resolve(this.lastRemoteSnapshotVersion)},yp.prototype.Io=function(t){return fa.resolve(this.ll)},yp.prototype.fo=function(t){return this.highestTargetId=this.fl.next(),fa.resolve(this.highestTargetId)},yp.prototype.mo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),fa.resolve()},yp.prototype.Ro=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new vh(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},yp.prototype.Ao=function(t,e){return this.Ro(e),this.targetCount+=1,fa.resolve()},yp.prototype.yo=function(t,e){return this.Ro(e),fa.resolve()},yp.prototype.Vo=function(t,e){return this.hl.delete(e.target),this._l.da(e.targetId),--this.targetCount,fa.resolve()},yp.prototype.mr=function(n,r,i){var o=this,s=0,u=[];return this.hl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.hl.delete(t),u.push(o.po(n,e.targetId)),s++)}),fa.qn(u).next(function(){return s})},yp.prototype.vo=function(t){return fa.resolve(this.targetCount)},yp.prototype.bo=function(t,e){e=this.hl.get(e)||null;return fa.resolve(e)},yp.prototype.So=function(t,e,n){return this._l.la(e,n),fa.resolve()},yp.prototype.Co=function(e,t,n){this._l.fa(t,n);var r=this.persistence.Vr,i=[];return r&&t.forEach(function(t){i.push(r.qr(e,t))}),fa.qn(i)},yp.prototype.po=function(t,e){return this._l.da(e),fa.resolve()},yp.prototype.xo=function(t,e){e=this._l.Ea(e);return fa.resolve(e)},yp.prototype.Qr=function(t,e){return fa.resolve(this._l.Qr(e))},yp),ql=(dp.prototype.ro=function(t,e){return fa.resolve(this.dl.get(e))},dp.prototype.oo=function(t,e){return this.dl.set(e.id,{id:e.id,version:e.version,createTime:Ko(e.createTime)}),fa.resolve()},dp.prototype.co=function(t,e){return fa.resolve(this.wl.get(e))},dp.prototype.uo=function(t,e){return this.wl.set(e.name,{name:(e=e).name,query:_c(e.bundledQuery),readTime:Ko(e.readTime)}),fa.resolve()},dp),Fl=(pp.prototype.start=function(){return Promise.resolve()},pp.prototype.fc=function(){return this.$o=!1,Promise.resolve()},Object.defineProperty(pp.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),pp.prototype.tc=function(){},pp.prototype.ec=function(){},pp.prototype.Pc=function(){return this.os},pp.prototype.mc=function(t){var e=this.El[t.h()];return e||(e=new Vl(this.os,this.Vr),this.El[t.h()]=e),e},pp.prototype.Ac=function(){return this.jo},pp.prototype.Rc=function(){return this.ss},pp.prototype.gc=function(){return this.Go},pp.prototype.runTransaction=function(t,e,n){var r=this;Rr("MemoryPersistence","Starting transaction:",t);var i=new Bl(this.ko.next());return this.Vr.Il(),n(i).next(function(t){return r.Vr.ml(i).next(function(){return t})}).Ln().then(function(t){return i.ns(),t})},pp.prototype.Al=function(e,n){return fa.Un(Object.values(this.El).map(function(t){return function(){return t.Qr(e,n)}}))},pp),Bl=(n(lp,Rl=Ie),lp),zl=(fp.gl=function(t){return new fp(t)},Object.defineProperty(fp.prototype,"yl",{get:function(){if(this.Pl)return this.Pl;throw Mr()},enumerable:!1,configurable:!0}),fp.prototype.Do=function(t,e,n){return this.Rl.Do(n,e),this.yl.delete(n.toString()),fa.resolve()},fp.prototype.No=function(t,e,n){return this.Rl.No(n,e),this.yl.add(n.toString()),fa.resolve()},fp.prototype.qr=function(t,e){return this.yl.add(e.toString()),fa.resolve()},fp.prototype.removeTarget=function(t,e){var n=this;this.Rl.da(e.targetId).forEach(function(t){return n.yl.add(t.toString())});var r=this.persistence.Ac();return r.xo(t,e.targetId).next(function(t){t.forEach(function(t){return n.yl.add(t.toString())})}).next(function(){return r.Vo(t,e)})},fp.prototype.Il=function(){this.Pl=new Set},fp.prototype.ml=function(n){var r=this,i=this.persistence.Rc().Xr();return fa.forEach(this.yl,function(t){var e=hi.st(t);return r.Vl(n,e).next(function(t){t||i.Hn(e)})}).next(function(){return r.Pl=null,i.apply(n)})},fp.prototype.Sc=function(t,e){var n=this;return this.Vl(t,e).next(function(t){t?n.yl.delete(e.toString()):n.yl.add(e.toString())})},fp.prototype.Tl=function(t){return 0},fp.prototype.Vl=function(t,e){var n=this;return fa.Un([function(){return fa.resolve(n.Rl.Qr(e))},function(){return n.persistence.Ac().Qr(t,e)},function(){return n.persistence.Al(t,e)}])},fp),Gl=(hp.prototype.cu=function(t){this.bl=t},hp.prototype.nu=function(t){this.Sl=t},hp.prototype.onMessage=function(t){this.Dl=t},hp.prototype.close=function(){this.vl()},hp.prototype.send=function(t){this.pl(t)},hp.prototype.Cl=function(){this.bl()},hp.prototype.Nl=function(t){this.Sl(t)},hp.prototype.xl=function(t){this.Dl(t)},hp),Kl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Wl=(cp.prototype.Au=function(e,t,n,r){var i=this.kl(e,t);Rr("RestConnection","Sending: ",i,n);t={};return this.$l(t,r),this.Ll(e,i,t,n).then(function(t){return Rr("RestConnection","Received: ",t),t},function(t){throw Lr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},cp.prototype.Ru=function(t,e,n,r){return this.Au(t,e,n,r)},cp.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1",t["Content-Type"]="text/plain",e)for(var n in e.T)e.T.hasOwnProperty(n)&&(t[n]=e.T[n])},cp.prototype.kl=function(t,e){t=Kl[t];return this.Ol+"/v1/"+e+":"+t},n(ap,Pl=cp),ap.prototype.Ll=function(o,e,s,u){return new Promise(function(n,r){var i=new Er;i.listenOnce(mr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case gr.NO_ERROR:var t=i.getResponseJson();Rr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case gr.TIMEOUT:Rr("Connection",'RPC "'+o+'" timed out'),r(new Br(Fr.DEADLINE_EXCEEDED,"Request time out"));break;case gr.HTTP_ERROR:var e=i.getStatus();Rr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Fr).indexOf(e)?e:Fr.UNKNOWN,r(new Br(e,t.message))):r(new Br(Fr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Br(Fr.UNAVAILABLE,"Connection failed."));break;default:Mr()}}finally{Rr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},ap.prototype.uu=function(t,e){var n,r=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,o=vr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Rr("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new Gl({pl:function(t){a?Rr("Connection","Not sending because WebChannel is closed:",t):(u||(Rr("Connection","Opening WebChannel transport."),s.open(),u=!0),Rr("Connection","WebChannel sending:",t),s.send(t))},vl:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Ir.EventType.OPEN,function(){a||Rr("Connection","WebChannel transport opened.")}),t(s,Ir.EventType.CLOSE,function(){a||(a=!0,Rr("Connection","WebChannel transport closed"),c.Nl())}),t(s,Ir.EventType.ERROR,function(t){a||(a=!0,Lr("Connection","WebChannel transport errored:",t),c.Nl(new Br(Fr.UNAVAILABLE,"The operation could not be completed")))}),t(s,Ir.EventType.MESSAGE,function(t){var e,n,r,i;a||(Ur(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Rr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Si[r];if(void 0!==t)return Pi(t)}(),i=n.message,void 0===t&&(t=Fr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.Nl(new Br(t,i)),s.close()):(Rr("Connection","WebChannel received:",e),c.xl(e)))}),t(o,wr.STAT_EVENT,function(t){t.stat===br?Rr("Connection","Detected buffering proxy"):t.stat===_r&&Rr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Cl()},0),c},ap),Hl=(up.prototype.Lu=function(t){this.Kl.push(t)},up.prototype.fc=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},up.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},up.prototype.ql=function(){Rr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},up.prototype.Ql=function(){Rr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},up.Gs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},up),Yl=(sp.prototype.Lu=function(t){},sp.prototype.fc=function(){},sp),Ql=(op.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=ma(e.Fl.t),this.kh=this.jl(e),this.persistence=this.Gl(e),[4,this.persistence.start()];case 1:return t.sent(),this.zl=this.Hl(e),this.Cu=this.Jl(e),[2]}})})},op.prototype.Hl=function(t){return null},op.prototype.Jl=function(t){return Mh(this.persistence,new Ll,t.Yl,this.serializer)},op.prototype.Gl=function(t){return new Fl(zl.gl,this.serializer)},op.prototype.jl=function(t){return new Yf},op.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.fc()];case 1:return t.sent(),[4,this.persistence.fc()];case 2:return t.sent(),[2]}})})},op),Xl=(n(ip,kl=Ql),ip.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,kl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,Hh(this.Cu)];case 2:return t.sent(),[4,this.Xl.initialize(this,e)];case 3:return t.sent(),[4,Dl(this.Xl.ga)];case 4:return t.sent(),[4,If(this.Xl.Oh)];case 5:return t.sent(),[2]}})})},ip.prototype.Jl=function(t){return Mh(this.persistence,new Ll,t.Yl,this.serializer)},ip.prototype.Hl=function(t){var e=this.persistence.Vr.cr;return new ic(e,t.di)},ip.prototype.Gl=function(t){var e=Ch(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?ec.er(this.cacheSizeBytes):ec.ir;return new Nh(this.synchronizeTabs,e,t.clientId,n,t.di,Ka(),Wa(),this.serializer,this.kh,!!this.forceOwnership)},ip.prototype.jl=function(t){return new Yf},ip),Jl=(n(rp,xl=Xl),rp.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,xl.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Xl.ga,this.kh instanceof Hf?(this.kh.ga={_h:Tl.bind(null,e),fh:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).Hh?(Rr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.qh.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Wh(e.Cu)];case 3:return n=t.sent(),r=Zi.ae(o,"current"===s),[4,Il(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,zh(e.Cu,o,!0)];case 6:return t.sent(),ml(e,o,u),[3,8];case 7:Mr(),t.label=8;case 8:return[2]}})})}.bind(null,e),dh:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=Sl(c)).Hh)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.qh.has(r)?(Rr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Kh(n.Cu,r)]):[3,6];case 2:return i=t.sent(),[4,Bh(n.Cu,i)];case 3:return o=t.sent(),[4,hl(n,Ol(i),o.targetId,!1)];case 4:t.sent(),ff(n.Oh,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.qh.has(e)?[4,zh(n.Cu,e,!1).then(function(){lf(n.Oh,e),ml(n,e)}).catch(Yh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Ic:function(t){return t.Cu.persistence.Ic()}.bind(null,e),lh:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,Wh((e=n).Cu).then(function(t){return Il(e,t)})]})})}.bind(null,e)},[4,this.kh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Zo(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Al(this.Xl.ga,e)];case 1:return t.sent(),this.zl&&(e&&!this.zl.lr?this.zl.start(this.Cu):e||this.zl.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},rp.prototype.jl=function(t){var e=Ka();if(!Hf.Gs(e))throw new Br(Fr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ch(t.Fl.t,t.Fl.persistenceKey);return new Hf(e,t.di,n,t.clientId,t.Yl)},rp),$l=(np.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Cu?[3,2]:(this.Cu=n.Cu,this.kh=n.kh,this.Nu=this.Zl(r),this.Oh=this.t_(r),this.Mh=this.e_(r),this.ga=this.n_(r,!n.synchronizeTabs),this.kh.Pu=function(t){return pl(e.ga,t,1)},this.Oh.xu.s_=El.bind(null,this.ga),[4,Af(this.Oh,this.ga.Jh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},np.prototype.e_=function(t){return new Sf},np.prototype.Zl=function(t){var e=ma(t.Fl.t),n=(n=t.Fl,new Wl(n));return t=t.credentials,new ef(t,n,e)},np.prototype.t_=function(t){var e=this,n=this.Cu,r=this.Nu,i=t.di,o=function(t){return pl(e.ga,t,0)},t=new(Hl.Gs()?Hl:Yl);return new Qh(n,r,i,o,t)},np.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){o=new tl(t,e,n,r,i,o);return s&&(o.Hh=!0),o}(this.Cu,this.Oh,this.Mh,this.kh,t.Yl,t.$h,e)},np.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Rr("RemoteStore","RemoteStore shutting down."),e.Mu.add(5),[4,hf(e)];case 1:return t.sent(),e.$u.fc(),e.Bu.set("Unknown"),[2]}})})}(this.Oh)},np),Zl=(ep.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},ep.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},ep.prototype.r_=function(){this.muted=!0},ep.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},ep),tp=function(t){this.o_=t};function ep(t){this.observer=t,this.muted=!1}function np(){}function rp(t,e){var n=this;return(n=xl.call(this,t,e,!1)||this).Xl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function ip(t,e,n){var r=this;return(r=kl.call(this)||this).Xl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function op(){this.synchronizeTabs=!1}function sp(){}function up(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}function ap(t){var e=this;return(e=Pl.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function cp(t){this.Fl=t,this.t=t.t;var e=t.ssl?"https":"http";this.Ol=e+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function hp(t){this.pl=t.pl,this.vl=t.vl}function fp(t){this.persistence=t,this.Rl=new Cf,this.Pl=null}function lp(t){var e=this;return(e=Rl.call(this)||this).Fo=t,e}function pp(t,e){var n=this;this.El={},this.ko=new Ea(0),this.$o=!1,this.$o=!0,this.Vr=t(this),this.jo=new jl(this),this.os=new Uc,this.ss=(t=this.os,new Ml(t,function(t){return n.Vr.Tl(t)})),this.serializer=new fc(e),this.Go=new ql(this.serializer)}function dp(t){this.serializer=t,this.dl=new Map,this.wl=new Map}function yp(t){this.persistence=t,this.hl=new ha(Ii,Ei),this.lastRemoteSnapshotVersion=si.min(),this.highestTargetId=0,this.ll=0,this._l=new Cf,this.targetCount=0,this.fl=vh.lo()}function vp(t){var e=this;return(e=Cl.call(this)||this).no=t,e}function gp(t,e){this.os=t,this.ul=e,this.docs=new Ri(hi.$),this.size=0}function mp(t,e){this.os=t,this.Vr=e,this.rs=[],this.nl=1,this.sl=new qi(Lf.ua)}function wp(){}function bp(t,e,n){if(!n)throw new Br(Fr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function _p(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Br(Fr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Ip(t,e,n,r){if(!0===e&&!0===r)throw new Br(Fr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Ep(t){if(!hi.ot(t))throw new Br(Fr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Tp(t){if(hi.ot(t))throw new Br(Fr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Ap(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Mr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Np(t,e){if(t instanceof tp&&(t=t.o_),t instanceof e)return t;if(e.name===t.constructor.name)throw new Br(Fr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=Ap(t);throw new Br(Fr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Op(t,e){if(e<=0)throw new Br(Fr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Sp,Dp=function(t){this.c_=t},xp=(n(kp,Sp=Dp),kp.prototype.u_=function(t){if(2!==t.a_)throw 1===t.a_?t.h_(this.c_+"() can only appear at the top level of your update data"):t.h_(this.c_+"() cannot be used with set() unless you pass {merge:true}");return t.en.push(t.path),null},kp.prototype.isEqual=function(t){return t instanceof kp},kp);function kp(){return null!==Sp&&Sp.apply(this,arguments)||this}function Pp(t,e,n){return new Ny({a_:3,l_:e.settings.l_,methodName:t.c_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var Rp,Cp,Lp,Vp,Mp=(n(Zp,Vp=Dp),Zp.prototype.u_=function(t){return new xs(t.path,new ys)},Zp.prototype.isEqual=function(t){return t instanceof Zp},Zp),Up=(n($p,Lp=Dp),$p.prototype.u_=function(t){var e=Pp(this,t,!0),n=this.f_.map(function(t){return Cy(t,e)}),n=new vs(n);return new xs(t.path,n)},$p.prototype.isEqual=function(t){return this===t},$p),jp=(n(Jp,Cp=Dp),Jp.prototype.u_=function(t){var e=Pp(this,t,!0),n=this.f_.map(function(t){return Cy(t,e)}),n=new _s(n);return new xs(t.path,n)},Jp.prototype.isEqual=function(t){return this===t},Jp),qp=(n(Xp,Rp=Dp),Xp.prototype.u_=function(t){var e=new As(t.serializer,Bo(t.serializer,this.d_));return new xs(t.path,e)},Xp.prototype.isEqual=function(t){return this===t},Xp),Fp=(Object.defineProperty(Qp.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"longitude",{get:function(){return this.E_},enumerable:!1,configurable:!0}),Qp.prototype.isEqual=function(t){return this.w_===t.w_&&this.E_===t.E_},Qp.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.E_}},Qp.prototype.C=function(t){return ti(this.w_,t.w_)||ti(this.E_,t.E_)},Qp),Bp=(Yp.fromBase64String=function(t){try{return new Yp(Ai.fromBase64String(t))}catch(t){throw new Br(Fr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Yp.fromUint8Array=function(t){return new Yp(Ai.fromUint8Array(t))},Yp.prototype.toBase64=function(){return this.T_.toBase64()},Yp.prototype.toUint8Array=function(){return this.T_.toUint8Array()},Yp.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Yp.prototype.isEqual=function(t){return this.T_.isEqual(t.T_)},Yp),zp=new Map,Gp=(Hp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Hp),Kp=(Object.defineProperty(Wp.prototype,"app",{get:function(){if(!this.g_)throw new Br(Fr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.g_},enumerable:!1,configurable:!0}),Object.defineProperty(Wp.prototype,"y_",{get:function(){return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(Wp.prototype,"V_",{get:function(){return void 0!==this.p_},enumerable:!1,configurable:!0}),Wp.prototype.v_=function(t){if(this.A_)throw new Br(Fr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.m_=new Gp(t),void 0!==t.credentials&&(this.P_=function(t){if(!t)return new zr;switch(t.type){case"gapi":var e=t.client;return Ur(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Wr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Br(Fr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Wp.prototype.b_=function(){return this.m_},Wp.prototype.S_=function(){return this.A_=!0,this.m_},Wp.prototype._delete=function(){return this.p_||(this.p_=this.D_()),this.p_},Wp.prototype.D_=function(){return t=this,(e=zp.get(t))&&(Rr("ComponentProvider","Removing Datastore"),zp.delete(t),e.terminate()),Promise.resolve();var t,e},Wp);function Wp(t,e){this.I_="(lite)",this.m_=new Gp({}),this.A_=!1,t instanceof Or?(this.R_=t,this.P_=new zr):(this.g_=t,this.R_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Br(Fr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Or(t.options.projectId)}(t),this.P_=new Gr(e))}function Hp(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Br(Fr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Br(Fr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Ip("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Yp(t){this.T_=t}function Qp(t,e){if(!isFinite(t)||t<-90||90<t)throw new Br(Fr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Br(Fr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.E_=e}function Xp(t,e){var n=this;return(n=Rp.call(this,t)||this).d_=e,n}function Jp(t,e){var n=this;return(n=Cp.call(this,t)||this).f_=e,n}function $p(t,e){var n=this;return(n=Lp.call(this,t)||this).f_=e,n}function Zp(){return null!==Vp&&Vp.apply(this,arguments)||this}function td(){if("undefined"==typeof Uint8Array)throw new Br(Fr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ed(){if("undefined"==typeof atob)throw new Br(Fr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var nd,rd,id,od=(n(pd,id=tp),pd.fromBase64String=function(t){return ed(),new pd(Bp.fromBase64String(t))},pd.fromUint8Array=function(t){return td(),new pd(Bp.fromUint8Array(t))},pd.prototype.toBase64=function(){return ed(),this.o_.toBase64()},pd.prototype.toUint8Array=function(){return td(),this.o_.toUint8Array()},pd.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},pd.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},pd),h=(ld.prototype.C_=function(t,e){switch(void 0===e&&(e="none"),Io(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Do(t.integerValue||t.doubleValue);case 3:return this.N_(t.timestampValue);case 4:return this.x_(t,e);case 5:return t.stringValue;case 6:return this.F_(xo(t.bytesValue));case 7:return this.O_(t.referenceValue);case 8:return this.M_(t.geoPointValue);case 9:return this.k_(t.arrayValue,e);case 10:return this.L_(t.mapValue,e);default:throw Mr()}},ld.prototype.L_=function(t,n){var r=this,i={};return go(t.fields||{},function(t,e){i[t]=r.C_(e,n)}),i},ld.prototype.M_=function(t){return new Fp(Do(t.latitude),Do(t.longitude))},ld.prototype.k_=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.C_(t,e)})},ld.prototype.x_=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return wo(e)?t(e):e}(t);return null==n?null:this.C_(n,e);case"estimate":return this.N_(bo(t));default:return null}},ld.prototype.N_=function(t){t=So(t);return new oi(t.seconds,t.nanos)},ld.prototype.B_=function(t,e){var n=ui.Y(t);Ur(fs(n));t=new Or(n.get(1),n.get(3)),n=new hi(n.B(5));return t.isEqual(e)||Cr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},ld),sd=(n(fd,rd=h),fd.prototype.F_=function(t){return new od(new Bp(t))},fd.prototype.O_=function(t){t=this.B_(t,this.firestore.R_);return Av.q_(t,this.firestore,null)},fd),ud=(Object.defineProperty(hd.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(hd.prototype,"ref",{get:function(){return new Ud(this.U_,this.j_,this.K_)},enumerable:!1,configurable:!0}),hd.prototype.exists=function(){return null!==this.W_},hd.prototype.data=function(){if(this.W_){if(this.j_){var t=new ad(this.U_,this.Q_,this.K_,this.W_,null);return this.j_.fromFirestore(t)}return this.Q_.C_(this.W_.En())}},hd.prototype.get=function(t){if(this.W_){t=this.W_.data().field(dd("DocumentSnapshot.get",t));if(null!==t)return this.Q_.C_(t)}},hd),ad=(n(cd,nd=ud),cd.prototype.data=function(){return nd.prototype.data.call(this)},cd);function cd(){return null!==nd&&nd.apply(this,arguments)||this}function hd(t,e,n,r,i){this.U_=t,this.Q_=e,this.K_=n,this.W_=r,this.j_=i}function fd(t){var e=this;return(e=rd.call(this)||this).firestore=t,e}function ld(){}function pd(){return null!==id&&id.apply(this,arguments)||this}function dd(t,e){return"string"==typeof e?qy(t,e):(e instanceof tp?e.o_:e).G_}var yd,vd=(wd.prototype.isEqual=function(t){return this.G_.isEqual(t.G_)},wd),gd=(n(md,yd=Kp),md.prototype.D_=function(){return this.H_||wv(this),this.H_.terminate()},md);function md(t,e){var n=this;return(n=yd.call(this,t,e)||this).z_=new Ya,n.I_="name"in t?t.name:"[DEFAULT]",n}function wd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Br(Fr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.G_=new ci(t)}function bd(n,r,i){var t=this,o=new la;return n.di.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Qy(n,i)];case 1:return t.sent(),[4,Xy(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===Fr.FAILED_PRECONDITION||t.code===Fr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function _d(t){if(t.y_||t.V_)throw new Br(Fr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Id,Ed,Td=(n(Dd,Ed=ud),Dd.prototype.exists=function(){return Ed.prototype.exists.call(this)},Dd.prototype.data=function(t){if(void 0===t&&(t={}),this.W_){if(this.j_){var e=new Ad(this.U_,this.Q_,this.K_,this.W_,this.metadata,null);return this.j_.fromFirestore(e,t)}return this.Q_.C_(this.W_.En(),t.serverTimestamps)}},Dd.prototype.get=function(t,e){if(void 0===e&&(e={}),this.W_){t=this.W_.data().field(dd("DocumentSnapshot.get",t));if(null!==t)return this.Q_.C_(t,e.serverTimestamps)}},Dd),Ad=(n(Sd,Id=Td),Sd.prototype.data=function(t){return void 0===t&&(t={}),Id.prototype.data.call(this,t)},Sd),Nd=(Object.defineProperty(Od.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Od.prototype,"size",{get:function(){return this.Y_.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Od.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Od.prototype.forEach=function(e,n){var r=this;this.Y_.docs.forEach(function(t){e.call(n,new Ad(r.U_,r.Q_,t.key,t,new Uv(r.Y_.ee.has(t.key),r.Y_.fromCache),r.query.j_))})},Od.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.Y_.se)throw new Br(Fr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.X_&&this.Z_===t||(this.X_=function(i,e){if(i.Y_.te.W()){var n=0;return i.Y_.docChanges.map(function(t){var e=new Ad(i.U_,i.Q_,t.doc.key,t.doc,new Uv(i.Y_.ee.has(t.doc.key),i.Y_.fromCache),i.query.j_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Y_.te;return i.Y_.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Ad(i.U_,i.Q_,t.doc.key,t.doc,new Uv(i.Y_.ee.has(t.doc.key),i.Y_.fromCache),i.query.j_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Mr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Z_=t),this.X_},Od);function Od(t,e,n,r){this.U_=t,this.Q_=e,this.Y_=r,this.metadata=new Uv(r.hasPendingWrites,r.fromCache),this.query=n}function Sd(){return null!==Id&&Id.apply(this,arguments)||this}function Dd(t,e,n,r,i,o){var s=this;return(s=Ed.call(this,t,e,n,r,o)||this).U_=t,s.J_=t,s.metadata=i,s}function xd(t,e){return t instanceof Td&&e instanceof Td?t.U_===e.U_&&t.K_.isEqual(e.K_)&&(null===t.W_?null===e.W_:t.W_.isEqual(e.W_))&&t.j_===e.j_:t instanceof Nd&&e instanceof Nd&&t.U_===e.U_&&my(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Y_.isEqual(e.Y_)}var kd,Pd=(n(Rd,kd=h),Rd.prototype.F_=function(t){return new Bp(t)},Rd.prototype.O_=function(t){t=this.B_(t,this.firestore.R_);return new Ud(this.firestore,null,t)},Rd);function Rd(t){var e=this;return(e=kd.call(this)||this).firestore=t,e}function Cd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Np(t.firestore,gd),s=wy(o);return e instanceof tp&&(e=e.o_),Vd(o,("string"==typeof e||e instanceof vd?Py(s,"updateDoc",t.K_,e,n,r):ky(s,"updateDoc",t.K_,e)).ef(t.K_,Rs.exists(!0)))}function Ld(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||wa(n[o])||(i=n[o],o++);var s,u,a,c,h,f={includeMetadataChanges:i.includeMetadataChanges};wa(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof Ud?(s=Np(e.firestore,gd),u=mu(e.K_.path),h={next:function(t){n[o]&&n[o](Md(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=Np(e.firestore,gd),u=e.tf,c=new Pd(s),h={next:function(t){n[o]&&n[o](new Nd(s,c,e,t))},error:n[o+1],complete:n[o+2]},ay(e.tf));var l=mv(s),p=new Zl(h),d=new Rf(u,p,f);return s.z_.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=xf,[4,rv(l)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.r_(),s.z_.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=kf,[4,rv(l)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}function Vd(t,e){return function(n,r){var t=this,i=new la;return n.di.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=fl,[4,nv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(mv(t),e)}function Md(t,e,n){var r=n.docs.get(e.K_),i=new Pd(t);return new Td(t,i,e.K_,r,new Uv(n.hasPendingWrites,n.fromCache),e.j_)}var Ud=(Object.defineProperty(Fd.prototype,"nf",{get:function(){return this.K_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Fd.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(Fd.prototype,"path",{get:function(){return this.K_.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(Fd.prototype,"parent",{get:function(){return new hy(this.firestore,this.j_,this.K_.path.q())},enumerable:!1,configurable:!0}),Fd.prototype.withConverter=function(t){return new Fd(this.firestore,t,this.K_)},Fd),jd=(qd.prototype.withConverter=function(t){return new qd(this.firestore,t,this.tf)},qd),Ie=function(){};function qd(t,e,n){this.j_=e,this.tf=n,this.type="query",this.firestore=t}function Fd(t,e,n){this.j_=e,this.K_=n,this.type="document",this.firestore=t}function Bd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].sf(t)}return t}var zd,Gd,Kd,Wd,Hd,Yd=(n(ry,Hd=Ie),ry.prototype.sf=function(t){var e=wy(t.firestore),e=function(t,e,n,r,i,o){if(r.tt()){if("array-contains"===i||"array-contains-any"===i)throw new Br(Fr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){sy(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(oy(n,t,c))}h={arrayValue:{values:s}}}else h=oy(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||sy(o,i),h=Ry(e,"where",o,"in"===i||"not-in"===i);var h=Ru.create(r,i,h);return function(t,e){if(e.An()){var n=Iu(t);if(null!==n&&!n.isEqual(e.field))throw new Br(Fr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=_u(t);null!==n&&uy(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Br(Fr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Br(Fr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.tf,e,t.firestore.R_,this.rf,this.cf,this.uf);return new jd(t.firestore,t.j_,(t=t.tf,e=t.filters.concat([e]),new pu(t.path,t.collectionGroup,t.Tn.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},ry),Qd=(n(ny,Wd=Ie),ny.prototype.sf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Br(Fr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Br(Fr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ua(e,n);return e=r,null!==_u(n=t)||null!==(t=Iu(n))&&uy(0,t,e.field),r}(t.tf,this.rf,this.af);return new jd(t.firestore,t.j_,(t=t.tf,e=t.Tn.concat([e]),new pu(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},ny),Xd=(n(ey,Kd=Ie),ey.prototype.sf=function(t){return new jd(t.firestore,t.j_,Nu(t.tf,this.hf,this.lf))},ey),Jd=(n(ty,Gd=Ie),ty.prototype.sf=function(t){var e=iy(t,this.type,this._f,this.ff);return new jd(t.firestore,t.j_,(t=t.tf,e=e,new pu(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},ty),$d=(n(Zd,zd=Ie),Zd.prototype.sf=function(t){var e=iy(t,this.type,this._f,this.ff);return new jd(t.firestore,t.j_,(t=t.tf,e=e,new pu(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},Zd);function Zd(t,e,n){var r=this;return(r=zd.call(this)||this).type=t,r._f=e,r.ff=n,r}function ty(t,e,n){var r=this;return(r=Gd.call(this)||this).type=t,r._f=e,r.ff=n,r}function ey(t,e,n){var r=this;return(r=Kd.call(this)||this).type=t,r.hf=e,r.lf=n,r}function ny(t,e){var n=this;return(n=Wd.call(this)||this).rf=t,n.af=e,n.type="orderBy",n}function ry(t,e,n){var r=this;return(r=Hd.call(this)||this).rf=t,r.cf=e,r.uf=n,r.type="where",r}function iy(t,c,e,n){if(e[0]instanceof tp&&(e[0]=e[0].o_),e[0]instanceof ud)return function(t,e,n,r){if(!n)throw new Br(Fr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Tu(t);o<s.length;o++){var u=s[o];if(u.field.tt())i.push(ko(e,n.key));else{var a=n.field(u.field);if(wo(a))throw new Br(Fr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.J();throw new Br(Fr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Zu(i,r)}(t.tf,t.firestore.R_,e[0].W_,n);var r=wy(t.firestore);return function(t,e,n,r,i,o){var s=t.Tn;if(i.length>s.length)throw new Br(Fr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.tt()){if("string"!=typeof c)throw new Br(Fr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Eu(t)&&-1!==c.indexOf("/"))throw new Br(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ui.Y(c));if(!hi.ot(h))throw new Br(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new hi(h);u.push(ko(e,h))}else{c=Ry(n,r,c);u.push(c)}}return new Zu(u,o)}(t.tf,t.firestore.R_,r,c,e,n)}function oy(t,e,n){if(n instanceof tp&&(n=n.o_),"string"==typeof n){if(""===n)throw new Br(Fr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Eu(e)&&-1!==n.indexOf("/"))throw new Br(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(ui.Y(n));if(!hi.ot(e))throw new Br(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return ko(t,new hi(e))}if(n instanceof Ud)return ko(t,n.K_);throw new Br(Fr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ap(n)+".")}function sy(t,e){if(!Array.isArray(t)||0===t.length)throw new Br(Fr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Br(Fr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function uy(t,e,n){if(!n.isEqual(e))throw new Br(Fr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ay(t){if(bu(t)&&0===t.Tn.length)throw new Br(Fr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var cy,hy=(n(fy,cy=jd),Object.defineProperty(fy.prototype,"id",{get:function(){return this.tf.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(fy.prototype,"path",{get:function(){return this.tf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(fy.prototype,"parent",{get:function(){var t=this.nf.q();return t.W()?null:new Ud(this.firestore,null,new hi(t))},enumerable:!1,configurable:!0}),fy.prototype.withConverter=function(t){return new fy(this.firestore,t,this.nf)},fy);function fy(t,e,n){var r=this;return(r=cy.call(this,t,e,mu(n))||this).firestore=t,r.nf=n,r.type="collection",r}function ly(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(bp("collection","path",e),t instanceof Kp){var i=ui.Y.apply(ui,s([e],n));return Tp(i),new hy(t,null,i)}if(!(t instanceof Ud||t instanceof hy))throw new Br(Fr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=ui.Y.apply(ui,s([t.path],n)).child(ui.Y(e));return Tp(e),new hy(t.firestore,null,e)}function py(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=$r.D()),bp("doc","path",e),t instanceof Kp){var i=ui.Y.apply(ui,s([e],n));return Ep(i),new Ud(t,null,new hi(i))}if(!(t instanceof Ud||t instanceof hy))throw new Br(Fr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=t.nf.child(ui.Y.apply(ui,s([e],n)));return Ep(e),new Ud(t.firestore,t instanceof hy?t.j_:null,new hi(e))}var dy,yy=(n(vy,dy=h),vy.prototype.F_=function(t){return new Bp(t)},vy.prototype.O_=function(t){t=this.B_(t,this.firestore.R_);return new Ud(this.firestore,null,t)},vy);function vy(t){var e=this;return(e=dy.call(this)||this).firestore=t,e}function gy(t,e){return(t instanceof Ud||t instanceof hy)&&(e instanceof Ud||e instanceof hy)&&t.firestore===e.firestore&&t.path===e.path&&t.j_===e.j_}function my(t,e){return t instanceof jd&&e instanceof jd&&t.firestore===e.firestore&&Ou(t.tf,e.tf)&&t.j_===e.j_}function wy(t){var e=t.S_(),n=ma(t.R_);return new Oy(t.R_,!!e.ignoreUndefinedProperties,n)}var by=/^__.*__$/,_y=(Ty.prototype.ef=function(t,e){var n=[];return null!==this.en?n.push(new zs(t,this.data,this.en,e)):n.push(new Bs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ys(t,this.fieldTransforms)),n},Ty),Iy=(Ey.prototype.ef=function(t,e){e=[new zs(t,this.data,this.en,e)];return 0<this.fieldTransforms.length&&e.push(new Ys(t,this.fieldTransforms)),e},Ey);function Ey(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}function Ty(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}function Ay(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Mr()}}var Ny=(Object.defineProperty(Dy.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Dy.prototype,"a_",{get:function(){return this.settings.a_},enumerable:!1,configurable:!0}),Dy.prototype.wf=function(t){return new Dy(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.en)},Dy.prototype.Ef=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.wf({path:e,__:!1});return e.Tf(t),e},Dy.prototype.If=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.wf({path:t,__:!1});return t.df(),t},Dy.prototype.mf=function(t){return this.wf({path:void 0,__:!0})},Dy.prototype.h_=function(t){return Fy(t,this.settings.methodName,this.settings.Af||!1,this.path,this.settings.l_)},Dy.prototype.contains=function(e){return void 0!==this.en.find(function(t){return e.j(t)})||void 0!==this.fieldTransforms.find(function(t){return e.j(t.field)})},Dy.prototype.df=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Tf(this.path.get(t))},Dy.prototype.Tf=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(Ay(this.a_)&&by.test(t))throw this.h_('Document fields cannot begin and end with "__"')},Dy),Oy=(Sy.prototype.Rf=function(t,e,n,r){return void 0===r&&(r=!1),new Ny({a_:t,methodName:e,l_:n,path:ci.X(),__:!1,Af:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Sy);function Sy(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||ma(t)}function Dy(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.df(),this.fieldTransforms=i||[],this.en=o||[]}function xy(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Rf(o.merge||o.mergeFields?2:0,e,n,i);My("Data must be an object, but it was:",s,r);var u,a,r=Ly(r,s);if(o.merge)u=new Ds(s.en),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Uy(e,f[h],n);if(!s.contains(l))throw new Br(Fr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");By(c,l)||c.push(l)}u=new Ds(c),a=s.fieldTransforms.filter(function(t){return u.un(t.field)})}else u=null,a=s.fieldTransforms;return new _y(new eu(r),u,a)}function ky(t,r,i,e){var o=t.Rf(1,r,i);My("Data must be an object, but it was:",o,e);var s=[],u=new nu;go(e,function(t,e){var n=qy(r,t,i);e instanceof tp&&(e=e.o_);t=o.If(n);e instanceof xp?s.push(n):null!=(t=Cy(e,t))&&(s.push(n),u.set(n,t))});e=new Ds(s);return new Iy(u.hn(),e,o.fieldTransforms)}function Py(t,e,n,r,i,o){var s=t.Rf(1,e,n),u=[Uy(e,r,n)],a=[i];if(o.length%2!=0)throw new Br(Fr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Uy(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new nu,y=u.length-1;0<=y;--y){By(p,u[y])||(h=u[y],(f=a[y])instanceof tp&&(f=f.o_),l=s.If(h),f instanceof xp?p.push(h):null!=(l=Cy(f,l))&&(p.push(h),d.set(h,l)))}i=new Ds(p);return new Iy(d.hn(),i,s.fieldTransforms)}function Ry(t,e,n,r){return void 0===r&&(r=!1),Cy(n,t.Rf(r?4:3,e))}function Cy(s,t){if(s instanceof tp&&(s=s.o_),Vy(s))return My("Unsupported field value:",t,s),Ly(s,t);if(s instanceof Dp)return function(t,e){if(!Ay(e.a_))throw e.h_(t.c_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.c_+"() is not currently supported inside arrays");t=t.u_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.en.push(t.path),s instanceof Array){if(t.settings.__&&4!==t.a_)throw t.h_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Cy(i[r],t.mf(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof tp&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Bo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=oi.fromDate(t);return{timestampValue:zo(e.serializer,n)}}if(t instanceof oi){var r=new oi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:zo(e.serializer,r)}}if(t instanceof Fp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Bp)return{bytesValue:Go(e.serializer,t.T_)};if(t instanceof Ud){n=e.t,r=t.firestore.R_;if(!r.isEqual(n))throw e.h_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Wo(t.firestore.R_||e.t,t.K_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+Ap(t))}(s,t)}function Ly(t,n){var r={};return mo(t)?n.path&&0<n.path.length&&n.en.push(n.path):go(t,function(t,e){e=Cy(e,n.Ef(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Vy(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof oi||t instanceof Fp||t instanceof Bp||t instanceof Ud||t instanceof Dp)}function My(t,e,n){if(!Vy(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=Ap(n);throw"an object"===n?e.h_(t+" a custom object"):e.h_(t+" "+n)}var r}function Uy(t,e,n){if(e instanceof tp&&(e=e.o_),e instanceof vd)return e.G_;if("string"==typeof e)return qy(t,e);throw Fy("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var jy=new RegExp("[~\\*/\\[\\]]");function qy(e,n,r){if(0<=n.search(jy))throw Fy("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(vd.bind.apply(vd,s([void 0],n.split("."))))).G_}catch(t){throw Fy("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Fy(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Br(Fr.INVALID_ARGUMENT,(e+=". ")+t+n)}function By(t,e){return t.some(function(t){return t.isEqual(e)})}var zy=(Yy.prototype.pf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.vf(),0<this.mutations.length)throw new Br(Fr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=$o((n=s).serializer)+"/documents",r={documents:u.map(function(t){return Yo(n.serializer,t)})},[4,n.Ru("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Ur(!!e.found),e.found.name,e.found.updateTime;var n=Qo(t,e.found.name),t=Ko(e.found.updateTime),e=new eu({mapValue:{fields:e.found.fields}});return new hu(n,t,e,{})}(e,t):"missing"in t?function(t,e){Ur(!!e.missing),Ur(!!e.readTime);t=Qo(t,e.missing),e=Ko(e.readTime);return new fu(t,e)}(e,t):Mr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Ur(!!t),o.push(t)}),o)]}})})}(this.Nu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof fu||t instanceof hu?n.bf(t):Mr()}),e)]}})})},Yy.prototype.set=function(t,e){this.write(e.ef(t,this.rn(t))),this.Vf.add(t.toString())},Yy.prototype.update=function(t,e){try{this.write(e.ef(t,this.Sf(t)))}catch(t){this.yf=t}this.Vf.add(t.toString())},Yy.prototype.delete=function(t){this.write([new Zs(t,this.rn(t))]),this.Vf.add(t.toString())},Yy.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.vf(),this.yf)throw this.yf;return e=this.Pf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=hi.st(e);n.mutations.push(new tu(e,n.rn(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=$o((e=i).serializer)+"/documents",r={writes:o.map(function(t){return es(e.serializer,t)})},[4,e.Au("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Nu,this.mutations)];case 1:return t.sent(),this.gf=!0,[2]}})})},Yy.prototype.bf=function(t){var e;if(t instanceof hu)e=t.version;else{if(!(t instanceof fu))throw Mr();e=si.min()}var n=this.Pf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Br(Fr.ABORTED,"Document version changed between two reads.")}else this.Pf.set(t.key.toString(),e)},Yy.prototype.rn=function(t){var e=this.Pf.get(t.toString());return!this.Vf.has(t.toString())&&e?Rs.updateTime(e):Rs.on()},Yy.prototype.Sf=function(t){var e=this.Pf.get(t.toString());if(this.Vf.has(t.toString())||!e)return Rs.exists(!0);if(e.isEqual(si.min()))throw new Br(Fr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Rs.updateTime(e)},Yy.prototype.write=function(t){this.vf(),this.mutations=this.mutations.concat(t)},Yy.prototype.vf=function(){},Yy),Gy=(Hy.prototype.run=function(){this.Cf()},Hy.prototype.Cf=function(){var t=this;this.Si.Bs(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new zy(this.Nu),(n=this.Nf(e))&&n.then(function(t){r.di.Ri(function(){return e.commit().then(function(){r.Ti.resolve(t)}).catch(function(t){r.xf(t)})})}).catch(function(t){r.xf(t)}),[2]})})})},Hy.prototype.Nf=function(t){try{var e=this.updateFunction(t);return!gi(e)&&e.catch&&e.then?e:(this.Ti.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ti.reject(t),null}},Hy.prototype.xf=function(t){var e=this;0<this.Df&&this.Ff(t)?(--this.Df,this.di.Ri(function(){return e.Cf(),Promise.resolve()})):this.Ti.reject(t)},Hy.prototype.Ff=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!ki(t)},Hy),Ky=(Wy.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.g.promise];case 1:return[2,(t.sent(),{di:this.di,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}})})},Wy.prototype.Mf=function(t){var e=this;this.Of=t,this.g.promise.then(function(){return e.Of(e.user)})},Wy.prototype.kf=function(){if(this.di.Ci)throw new Br(Fr.FAILED_PRECONDITION,"The client has already been terminated.")},Wy.prototype.terminate=function(){var t=this;this.di.Oi();var n=new la;return this.di.Ni(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.$f?[4,this.$f.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Lf?[4,this.Lf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.R(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Ja(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Wy);function Wy(t,e,n){var r=this;this.credentials=t,this.di=e,this.Fl=n,this.user=Sr.UNAUTHENTICATED,this.clientId=$r.D(),this.Of=function(){},this.g=new la,this.credentials.A(function(t){Rr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.Of(t)),r.g.resolve()})}function Hy(t,e,n,r){this.di=t,this.Nu=e,this.updateFunction=n,this.Ti=r,this.Df=5,this.Si=new Da(this.di,"transaction_retry")}function Yy(t){this.Nu=t,this.Pf=new Map,this.mutations=[],this.gf=!1,this.yf=null,this.Vf=new Set}function Qy(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.di.Li(),Rr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.Mf(function(e){return r.di.Mi(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Uh(i.Cu,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.tc(function(){return r.terminate()}),r.Lf=i,[2]}})})}function Xy(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.di.Li(),[4,Jy(r)];case 1:return e=t.sent(),Rr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.Mf(function(t){return r.di.Mi(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).di.Li(),Rr("RemoteStore","RemoteStore received new credentials"),n=gf(e),e.Mu.add(3),[4,hf(e)];case 1:return t.sent(),n&&e.Bu.set("Unknown"),[4,e.xu.s_(i)];case 2:return t.sent(),e.Mu.delete(3),[4,cf(e)];case 3:return t.sent(),[2]}})})}(i.Oh,t)})}),r.$f=i,[2]}})})}function Jy(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.Lf?[3,2]:(Rr("FirestoreClient","Using default OfflineComponentProvider"),[4,Qy(e,new Ql)]);case 1:t.sent(),t.label=2;case 2:return[2,e.Lf]}})})}function $y(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.$f?[3,2]:(Rr("FirestoreClient","Using default OnlineComponentProvider"),[4,Xy(e,new $l)]);case 1:t.sent(),t.label=2;case 2:return[2,e.$f]}})})}function Zy(t){return Jy(t).then(function(t){return t.persistence})}function tv(t){return Jy(t).then(function(t){return t.Cu})}function ev(t){return $y(t).then(function(t){return t.Oh})}function nv(t){return $y(t).then(function(t){return t.ga})}function rv(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,$y(r)];case 1:return e=t.sent(),[2,((n=e.Mh).Ju=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Sl(s),(o=e.Bh.get(u))?(n=o.targetId,e.kh.Wa(n),r=o.view.xh(),[3,4]):[3,1];case 1:return[4,Bh(e.Cu,Au(u))];case 2:return i=t.sent(),o=e.kh.Wa(i.targetId),n=i.targetId,[4,hl(e,u,n,"current"===o)];case 3:r=t.sent(),e.Jh&&ff(e.Oh,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.ga),n.Zu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Bh.get(o),1<(r=e.qh.get(n.targetId)).length?[2,(e.qh.set(n.targetId,r.filter(function(t){return!Ou(t,o)})),void e.Bh.delete(o))]:e.Jh?(e.kh.Ga(n.targetId),e.kh.Ba(n.targetId)?[3,2]:[4,zh(e.Cu,n.targetId,!1).then(function(){e.kh.Ha(n.targetId),lf(e.Oh,n.targetId),ml(e,n.targetId)}).catch(Yh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return ml(e,n.targetId),[4,zh(e.Cu,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.ga),n)]}})})}function iv(n,r,i,o,s){var t=new Zl({next:function(t){r.Ri(function(){return kf(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Br(Fr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Br(Fr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Rf(mu(i.path),t,{includeMetadataChanges:!0,oa:!0});return xf(n,u)}function ov(e,n,t,r,i){var o=new Zl({next:function(t){n.Ri(function(){return kf(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Br(Fr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Rf(t,o,{includeMetadataChanges:!0,oa:!0});return xf(e,s)}var sv=(uv.prototype.set=function(t,e,n){this.Kf();t=av(t,this.U_),e=Zv(t.j_,e,n),n=xy(this.Qf,"WriteBatch.set",t.K_,e,null!==t.j_,n);return this.qf=this.qf.concat(n.ef(t.K_,Rs.on())),this},uv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Kf();t=av(t,this.U_);return e instanceof tp&&(e=e.o_),e="string"==typeof e||e instanceof vd?Py(this.Qf,"WriteBatch.update",t.K_,e,n,r):ky(this.Qf,"WriteBatch.update",t.K_,e),this.qf=this.qf.concat(e.ef(t.K_,Rs.exists(!0))),this},uv.prototype.delete=function(t){this.Kf();t=av(t,this.U_);return this.qf=this.qf.concat(new Zs(t.K_,Rs.on())),this},uv.prototype.commit=function(){return this.Kf(),this.Uf=!0,0<this.qf.length?this.Bf(this.qf):Promise.resolve()},uv.prototype.Kf=function(){if(this.Uf)throw new Br(Fr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},uv);function uv(t,e){this.U_=t,this.Bf=e,this.qf=[],this.Uf=!1,this.Qf=wy(t)}function av(t,e){if(t instanceof tp&&(t=t.o_),t.firestore!==e)throw new Br(Fr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var cv,hv,fv=(gv.prototype.get=function(t){var e=this,n=av(t,this.U_),r=new yy(this.U_);return this.Wf.pf([n.K_]).then(function(t){if(!t||1!==t.length)return Mr();t=t[0];if(t instanceof fu)return new ud(e.U_,r,n.K_,null,n.j_);if(t instanceof hu)return new ud(e.U_,r,t.key,t,n.j_);throw Mr()})},gv.prototype.set=function(t,e,n){t=av(t,this.U_),e=Zv(t.j_,e,n),n=xy(this.Qf,"Transaction.set",t.K_,e,null!==t.j_,n);return this.Wf.set(t.K_,n),this},gv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=av(t,this.U_);return e instanceof tp&&(e=e.o_),e="string"==typeof e||e instanceof vd?Py(this.Qf,"Transaction.update",t.K_,e,n,r):ky(this.Qf,"Transaction.update",t.K_,e),this.Wf.update(t.K_,e),this},gv.prototype.delete=function(t){t=av(t,this.U_);return this.Wf.delete(t.K_),this},n(vv,hv=gv),vv.prototype.get=function(t){var e=this,n=av(t,this.U_),r=new Pd(this.U_);return hv.prototype.get.call(this,t).then(function(t){return new Td(e.U_,r,n.K_,t.W_,new Uv(!1,!1),n.j_)})},vv),lv=(yv.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){_d(t);var n=mv(t),r=t.S_(),t=new $l;return bd(n,t,new Xl(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},yv.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){_d(t);var e=mv(t),n=t.S_(),t=new $l;return bd(e,t,new Jl(t,n.cacheSizeBytes))}(t.o_)},yv.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.y_&&!n.V_)throw new Br(Fr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new la;return n.z_.Ni(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return xa.Gs()?(e=n+"main",[4,xa.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Ch(n.R_,n.I_))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t.o_)},yv),pv=(n(dv,cv=tp),Object.defineProperty(dv.prototype,"R_",{get:function(){return this.o_.R_},enumerable:!1,configurable:!0}),dv.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.b_()),t)).merge,this.o_.v_(t)},dv.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.b_().host&&Lr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},dv.prototype.enableNetwork=function(){return function(r){var t=this;return r.di.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Zy(r)];case 1:return e=t.sent(),[4,ev(r)];case 2:return n=t.sent(),[2,(e.ec(!0),(t=n).Mu.delete(0),cf(t))]}})})})}(mv(this.o_))},dv.prototype.disableNetwork=function(){return function(r){var t=this;return r.di.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Zy(r)];case 1:return e=t.sent(),[4,ev(r)];case 2:return n=t.sent(),[2,(e.ec(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Mu.add(0),[4,hf(e)];case 1:return t.sent(),e.Bu.set("Offline"),[2]}})})}(n))]}})})})}(mv(this.o_))},dv.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Ip("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.jf.enableMultiTabIndexedDbPersistence(this):this.jf.enableIndexedDbPersistence(this,n)},dv.prototype.clearPersistence=function(){return this.jf.clearIndexedDbPersistence(this)},dv.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},dv.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new la;return n.di.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=yl,[4,nv(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(mv(this.o_))},dv.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=mv(t),e=wa(e)?e:{next:e},i=new Zl(e);return t.z_.Ri(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Hu.add(e),e.next()},[4,rv(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.r_(),t.z_.Ri(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Hu.delete(e)},[4,rv(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.o_,t)},Object.defineProperty(dv.prototype,"app",{get:function(){if(!this.Gf)throw new Br(Fr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Gf},enumerable:!1,configurable:!0}),dv.prototype.collection=function(t){try{return new Gv(this,ly(this.o_,t))}catch(t){throw Dv(t,"collection()","Firestore.collection()")}},dv.prototype.doc=function(t){try{return new Av(this,py(this.o_,t))}catch(t){throw Dv(t,"doc()","Firestore.doc()")}},dv.prototype.collectionGroup=function(t){try{return new Fv(this,function(t,e){if(bp("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Br(Fr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new jd(t,null,(e=e,new pu(ui.X(),e)))}(this.o_,t))}catch(t){throw Dv(t,"collectionGroup()","Firestore.collectionGroup()")}},dv.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new la;return n.di.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,$y(n).then(function(t){return t.Nu})];case 1:return e=t.sent(),new Gy(n.di,e,r,i).run(),[2]}})})}),i.promise}(mv(n=this.o_),function(t){return t=new fv(n,t),e(new Ev(r,t))})},dv.prototype.batch=function(){var e=this;return mv(this.o_),new Tv(new sv(this.o_,function(t){return Vd(e.o_,t)}))},dv);function dv(t,e,n){var r=this;return(r=cv.call(this,e)||this).jf=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Or||(r.Gf=t),r}function yv(){}function vv(t,e){var n=this;return(n=hv.call(this,t,e)||this).U_=t,n}function gv(t,e){this.U_=t,this.Wf=e,this.Qf=wy(t)}function mv(t){return t.H_||wv(t),t.H_.kf(),t.H_}function wv(t){var e,n,r=t.S_(),r=(e=t.R_,n=t.I_,new Nr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.H_=new Ky(t.P_,t.z_,r)}var bv,_v,Iv,Ev=(n(Sv,Iv=tp),Sv.prototype.get=function(t){var e=this,t=$v(t);return this.o_.get(t).then(function(t){return new jv(e.U_,t)})},Sv.prototype.set=function(t,e,n){t=$v(t);return n?(_p("Transaction.set",n),this.o_.set(t,e,n)):this.o_.set(t,e),this},Sv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=$v(t);return 2===arguments.length?this.o_.update(o,e):(t=this.o_).update.apply(t,s([o,e,n],r)),this},Sv.prototype.delete=function(t){t=$v(t);return this.o_.delete(t),this},Sv),Tv=(n(Ov,_v=tp),Ov.prototype.set=function(t,e,n){t=$v(t);return n?(_p("WriteBatch.set",n),this.o_.set(t,e,n)):this.o_.set(t,e),this},Ov.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=$v(t);return 2===arguments.length?this.o_.update(o,e):(t=this.o_).update.apply(t,s([o,e,n],r)),this},Ov.prototype.delete=function(t){t=$v(t);return this.o_.delete(t),this},Ov.prototype.commit=function(){return this.o_.commit()},Ov),Av=(n(Nv,bv=tp),Nv.zf=function(t,e,n){if(t.length%2!=0)throw new Br(Fr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.J()+" has "+t.length);return new Nv(e,new Ud(e.o_,n,new hi(t)))},Nv.q_=function(t,e,n){return new Nv(e,new Ud(e.o_,n,t))},Object.defineProperty(Nv.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Nv.prototype,"parent",{get:function(){return new Gv(this.firestore,this.o_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Nv.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Nv.prototype.collection=function(t){try{return new Gv(this.firestore,ly(this.o_,t))}catch(t){throw Dv(t,"collection()","DocumentReference.collection()")}},Nv.prototype.isEqual=function(t){return t instanceof tp&&(t=t.o_),t instanceof Ud&&gy(this.o_,t)},Nv.prototype.set=function(t,e){e=_p("DocumentReference.set",e);try{return n=this.o_,r=t,i=e,o=Np(n.firestore,gd),r=Zv(n.j_,r,i),Vd(o,xy(wy(o),"setDoc",n.K_,r,null!==n.j_,i).ef(n.K_,Rs.on()))}catch(t){throw Dv(t,"setDoc()","DocumentReference.set()")}var n,r,i,o},Nv.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Cd(this.o_,t):Cd.apply(void 0,s([this.o_,t,e],n))}catch(t){throw Dv(t,"updateDoc()","DocumentReference.update()")}},Nv.prototype.delete=function(){return Vd(Np((t=this.o_).firestore,gd),[new Zs(t.K_,Rs.on())]);var t},Nv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=xv(t),i=kv(t,function(t){return new jv(e.firestore,new Td(e.firestore.o_,e.Q_,t.K_,t.W_,t.metadata,e.o_.j_))});return Ld(this.o_,r,i)},Nv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Np(e.firestore,gd),r=mv(n),i=new Pd(n),o=new la;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,tv(r)];case 1:return[4,function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Oc.cs(t,e)}))];case 1:return(r=t.sent())instanceof hu?s.resolve(r):r instanceof fu?s.resolve(null):s.reject(new Br(Fr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Ja(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(t.sent(),e.K_,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Td(n,i,e.K_,t,new Uv(t instanceof hu&&t.an,!0),e.j_)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Np(e.firestore,gd),r=mv(n),i=new la;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,rv(r)];case 1:return[4,iv(t.sent(),n.z_,e.K_,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Md(n,e,t)})}:function(e){var t=this,n=Np(e.firestore,gd),r=mv(n),i=new la;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,rv(r)];case 1:return[4,iv(t.sent(),n.z_,e.K_,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Md(n,e,t)})})(this.o_).then(function(t){return new jv(e.firestore,new Td(e.firestore.o_,e.Q_,t.K_,t.W_,t.metadata,e.o_.j_))})},Nv.prototype.withConverter=function(t){return new Nv(this.firestore,this.o_.withConverter(t))},Nv);function Nv(t,e){var n=this;return(n=bv.call(this,e)||this).firestore=t,n.Q_=new sd(t),n}function Ov(){return null!==_v&&_v.apply(this,arguments)||this}function Sv(t,e){var n=this;return(n=Iv.call(this,e)||this).U_=t,n}function Dv(t,e,n){return t.message=t.message.replace(e,n),t}function xv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!wa(r))return r}return{}}function kv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=wa(t[0])?t[0]:wa(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Pv,Rv,Cv,Lv,Vv,Mv,Uv=(Jv.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Jv),jv=(n(Xv,Mv=tp),Object.defineProperty(Xv.prototype,"ref",{get:function(){return new Av(this.U_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Xv.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Xv.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Xv.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),Xv.prototype.data=function(t){return this.o_.data(t)},Xv.prototype.get=function(t,e){return this.o_.get(t,e)},Xv.prototype.isEqual=function(t){return xd(this.o_,t.o_)},Xv),qv=(n(Qv,Vv=jv),Qv.prototype.data=function(t){return this.o_.data(t)},Qv),Fv=(n(Yv,Lv=tp),Yv.prototype.where=function(t,e,n){try{return new Yv(this.firestore,Bd(this.o_,(r=n,i=e,o=dd("where",t),new Yd(o,i,r))))}catch(t){throw Dv(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Yv.prototype.orderBy=function(n,t){try{return new Yv(this.firestore,Bd(this.o_,function(t){void 0===t&&(t="asc");var e=t,t=dd("orderBy",n);return new Qd(t,e)}(t)))}catch(n){throw Dv(n,/(orderBy|where)\(\)/,"Query.$1()")}},Yv.prototype.limit=function(t){try{return new Yv(this.firestore,Bd(this.o_,(Op("limit",e=t),new Xd("limit",e,"F"))))}catch(t){throw Dv(t,"limit()","Query.limit()")}var e},Yv.prototype.limitToLast=function(t){try{return new Yv(this.firestore,Bd(this.o_,(Op("limitToLast",e=t),new Xd("limitToLast",e,"L"))))}catch(t){throw Dv(t,"limitToLast()","Query.limitToLast()")}var e},Yv.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Yv(this.firestore,Bd(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jd("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Dv(t,"startAt()","Query.startAt()")}},Yv.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Yv(this.firestore,Bd(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jd("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Dv(t,"startAfter()","Query.startAfter()")}},Yv.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Yv(this.firestore,Bd(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $d("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Dv(t,"endBefore()","Query.endBefore()")}},Yv.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Yv(this.firestore,Bd(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $d("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Dv(t,"endAt()","Query.endAt()")}},Yv.prototype.isEqual=function(t){return my(this.o_,t.o_)},Yv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Np(e.firestore,gd),r=mv(n),i=new Pd(n),o=new la;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,tv(r)];case 1:return[4,function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Gh(r,i,!0)];case 1:return n=t.sent(),e=new Jf(i,n.Bc),n=e.gh(n.documents),n=e.Zn(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Ja(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(t.sent(),e.tf,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Nd(n,i,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Np(e.firestore,gd),r=mv(n),i=new Pd(n),o=new la;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,rv(r)];case 1:return[4,ov(t.sent(),n.z_,e.tf,{source:"server"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Nd(n,i,e,t)})}:function(e){var t=this,n=Np(e.firestore,gd),r=mv(n),i=new Pd(n);ay(e.tf);var o=new la;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,rv(r)];case 1:return[4,ov(t.sent(),n.z_,e.tf,{source:"default"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Nd(n,i,e,t)})})(this.o_).then(function(t){return new zv(e.firestore,t)})},Yv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=xv(t),i=kv(t,function(t){return new zv(e.firestore,t)});return Ld(this.o_,r,i)},Yv.prototype.withConverter=function(t){return new Yv(this.firestore,this.o_.withConverter(t))},Yv),Bv=(n(Hv,Cv=tp),Object.defineProperty(Hv.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(Hv.prototype,"doc",{get:function(){return new qv(this.U_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Hv.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Hv.prototype,"newIndex",{get:function(){return this.o_.newIndex},enumerable:!1,configurable:!0}),Hv),zv=(n(Wv,Rv=tp),Object.defineProperty(Wv.prototype,"query",{get:function(){return new Fv(this.U_,this.o_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"docs",{get:function(){var e=this;return this.o_.docs.map(function(t){return new qv(e.U_,t)})},enumerable:!1,configurable:!0}),Wv.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map(function(t){return new Bv(e.U_,t)})},Wv.prototype.forEach=function(e,n){var r=this;this.o_.forEach(function(t){e.call(n,new qv(r.U_,t))})},Wv.prototype.isEqual=function(t){return xd(this.o_,t.o_)},Wv),Gv=(n(Kv,Pv=Fv),Object.defineProperty(Kv.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Kv.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Kv.prototype,"parent",{get:function(){var t=this.o_.parent;return t?new Av(this.firestore,t):null},enumerable:!1,configurable:!0}),Kv.prototype.doc=function(t){try{return new Av(this.firestore,void 0===t?py(this.o_):py(this.o_,t))}catch(t){throw Dv(t,"doc()","CollectionReference.doc()")}},Kv.prototype.add=function(t){var e,n,r,i=this;return e=this.o_,n=t,t=Np(e.firestore,gd),r=py(e),n=Zv(e.j_,n),Vd(t,xy(wy(e.firestore),"addDoc",r.K_,n,null!==e.j_,{}).ef(r.K_,Rs.exists(!1))).then(function(){return r}).then(function(t){return new Av(i.firestore,t)})},Kv.prototype.isEqual=function(t){return gy(this.o_,t.o_)},Kv.prototype.withConverter=function(t){return new Kv(this.firestore,this.o_.withConverter(t))},Kv);function Kv(t,e){var n=this;return(n=Pv.call(this,t,e)||this).firestore=t,n.o_=e,n}function Wv(t,e){var n=this;return(n=Rv.call(this,e)||this).U_=t,n}function Hv(t,e){var n=this;return(n=Cv.call(this,e)||this).U_=t,n}function Yv(t,e){var n=this;return(n=Lv.call(this,e)||this).firestore=t,n}function Qv(){return null!==Vv&&Vv.apply(this,arguments)||this}function Xv(t,e){var n=this;return(n=Mv.call(this,e)||this).U_=t,n}function Jv(t,e){this.hasPendingWrites=t,this.fromCache=e}function $v(t){return t instanceof tp&&(t=t.o_),Np(t,Ud)}function Zv(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var tg,eg,ng,Ie=(n(og,eg=tp),og.documentId=function(){return new og(ci.et().J())},og.prototype.isEqual=function(t){return t instanceof tp&&(t=t.o_),t instanceof vd&&this.o_.G_.isEqual(t.G_)},og),h=(n(ig,tg=tp),ig.serverTimestamp=function(){var t=new Mp("serverTimestamp");return t.c_="FieldValue.serverTimestamp",new ig(t)},ig.delete=function(){var t=new xp("deleteField");return t.c_="FieldValue.delete",new ig(t)},ig.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Up("arrayUnion",t)}.apply(void 0,t);return n.c_="FieldValue.arrayUnion",new ig(n)},ig.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new jp("arrayRemove",t)}.apply(void 0,t);return n.c_="FieldValue.arrayRemove",new ig(n)},ig.increment=function(t){t=new qp("increment",t);return t.c_="FieldValue.increment",new ig(t)},ig.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},ig),rg={Firestore:pv,GeoPoint:Fp,Timestamp:oi,Blob:od,Transaction:Ev,WriteBatch:Tv,DocumentReference:Av,DocumentSnapshot:jv,Query:Fv,QueryDocumentSnapshot:qv,QuerySnapshot:zv,CollectionReference:Gv,FieldPath:Ie,FieldValue:h,setLogLevel:function(t){kr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function ig(){return null!==tg&&tg.apply(this,arguments)||this}function og(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return eg.call(this,new(vd.bind.apply(vd,s([void 0],t))))||this}(ng=e.default).INTERNAL.registerComponent(new Tr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new pv(e,new gd(e,t),new lv);var e},"PUBLIC").setServiceProps(Object.assign({},rg))),ng.registerVersion("@firebase/firestore","2.0.4")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
