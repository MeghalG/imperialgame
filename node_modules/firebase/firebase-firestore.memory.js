!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Rd){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(Rd),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function v(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function y(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Te=u=u||{})[Te.DEBUG=0]="DEBUG",Te[Te.VERBOSE=1]="VERBOSE",Te[Te.INFO=2]="INFO",Te[Te.WARN=3]="WARN",Te[Te.ERROR=4]="ERROR",Te[Te.SILENT=5]="SILENT";function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,a(["["+i+"]  "+t.name+":"],n))}}var o={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Ie={})[u.DEBUG]="log",Ie[u.VERBOSE]="log",Ie[u.INFO]="info",Ie[u.WARN]="warn",Ie[u.ERROR]="error",Ie),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.DEBUG],t)),this._logHandler.apply(this,a([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.VERBOSE],t)),this._logHandler.apply(this,a([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.INFO],t)),this._logHandler.apply(this,a([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.WARN],t)),this._logHandler.apply(this,a([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.ERROR],t)),this._logHandler.apply(this,a([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=i,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(T,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},R={},k=O||self;function L(){}function D(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function S(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),_=0;function V(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?V:C).apply(null,arguments)}function j(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function x(){return Date.now()}function M(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,P)&&t[P]||(t[P]=++_))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var H,X=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}t:{var Q=k.navigator;if(Q){Q=Q.userAgent;if(Q){H=Q;break t}}H=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=L;var nt,rt=Y(H,"Opera"),it=Y(H,"Trident")||Y(H,"MSIE"),ot=Y(H,"Edge"),st=ot||it,ut=Y(H,"Gecko")&&!(Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge"))&&!(Y(H,"Trident")||Y(H,"MSIE"))&&!Y(H,"Edge"),at=Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge");function ht(){var t=k.document;return t?t.documentMode:void 0}t:{var ct="",lt=(lt=H,ut?/rv:([^\);]+)(\)|;)/.exec(lt):ot?/Edge\/([\d\.]+)/.exec(lt):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):at?/WebKit\/(\S+)/.exec(lt):rt?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);if(lt&&(ct=lt?lt[1]:""),it){lt=ht();if(null!=lt&&lt>parseFloat(ct)){nt=String(lt);break t}}nt=ct}var ft={};function pt(u){return t=u,e=function(){for(var t=0,e=X(String(nt)).split("."),n=X(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=ft,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var dt=k.document&&it?ht()||(parseInt(nt,10)||void 0):void 0,vt=!it||9<=Number(dt),yt=it&&!pt("9"),gt=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{k.addEventListener("test",L,e),k.removeEventListener("test",L,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},M(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,yt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function It(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tt,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function Ot(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Rt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Rt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new It(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var kt="closure_lm_"+(1e6*Math.random()|0),Lt={};function Dt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=xt(r);return e&&e[Et]?e.wa(n,r,S(i)?!!i.capture:!!i,o):St(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Dt(t,e[o],n,r,i);return null}return n=xt(n),t&&t[Et]?t.va(e,n,S(r)?!!r.capture:!!r,i):St(t,e,n,!1,r,i)}function St(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=S(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,h=Ut(t);if(h||(t[kt]=h=new Nt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Ct,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(_t(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Ot(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(_t(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ut(e))?(Ot(n,t),0==n.b&&(n.src=null,e[kt]=null)):At(t)))}function _t(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function Vt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Pt(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(vt)return Vt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=k,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Vt(t,e=new wt(e,this))}function Ut(t){return(t=t[kt])instanceof Nt?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function xt(e){return"function"==typeof e?e:(e[jt]||(e[jt]=function(t){return e.handleEvent(t)}),e[jt])}function Mt(){q.call(this),this.c=new Nt(this),(this.J=this).C=null}function qt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new mt(e,t):e instanceof mt?e.target=e.target||t:(s=e,tt(e=new mt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Ft(o,r,!0,e)&&s;if(s=Ft(o=e.a=t,r,!0,e)&&s,s=Ft(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Ft(o=e.a=n[i],r,!1,e)&&s}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Ot(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}M(Mt,q),Mt.prototype[Et]=!0,(N=Mt.prototype).addEventListener=function(t,e,n,r){Dt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=S(i)?!!i.capture:!!i,r=xt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Rt(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ut(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Rt(n,r,i,o)),(r=-1<e?n[e]:null)&&Pt(r))}(this,t,e,n,r)},N.G=function(){if(Mt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=k.JSON.stringify;function Bt(){this.b=this.a=null}var Wt,zt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Xt},function(t){t.reset()}));function Ht(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Xt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Wt||(n=k.Promise.resolve(void 0),Wt=function(){n.then(Jt)}),Kt||(Wt(),Kt=!0),Qt.add(t,e)}Bt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Xt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Kt=!(Xt.prototype.reset=function(){this.next=this.b=this.a=null}),Qt=new Bt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Qt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){k.setTimeout(function(){throw t},0)}(t)}var n=zt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Kt=!1}function $t(t,e){Mt.call(this),this.b=t||1,this.a=e||k,this.f=U(this.Za,this),this.g=x()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==typeof t)n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}M($t,Mt),(N=$t.prototype).aa=!1,N.M=null,N.Za=function(){var t;this.aa&&(0<(t=x()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),qt(this,"tick"),this.aa&&(Zt(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=x())},N.G=function(){$t.X.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(I(ne=se,re=ee=q),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e){var n=ee.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ue(t){q.call(this),this.b=t,this.a={}}M(ue,q);var ae=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Dt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Pt(t)},t),t.a={}}function le(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Gt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.X.G.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.info=function(){};var pe={},de=null;function ve(){return de=de||new Mt}function ye(t){mt.call(this,pe.Fa,t)}function ge(t){var e=ve();qt(e,new ye(e))}function me(t,e){mt.call(this,pe.STAT_EVENT,t),this.stat=e}function we(t){var e=ve();qt(e,new me(e,t))}function be(t){mt.call(this,pe.Ga,t)}function Ee(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}pe.Fa="serverreachability",M(ye,mt),pe.STAT_EVENT="statevent",M(me,mt),pe.Ga="timingevent",M(be,mt);var Te={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Ie={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ae(){}function Ne(t){var e;return(e=t.a)||(e=t.a={}),e}function Oe(){}Ae.prototype.a=null;var Re,O={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function ke(){mt.call(this,"d")}function Le(){mt.call(this,"c")}function De(){}function Se(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ue(this),this.P=Pe,t=st?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}M(ke,mt),M(Le,mt),M(De,Ae),Re=new De;var Pe=45e3,_e={},Ve={};function Ce(t,e,n){t.H=1,t.i=nn(Qe(e)),t.j=n,t.I=!0,Ue(t,null)}function Ue(t,e){t.u=x(),xe(t),t.l=Qe(t.i);var s,u,a,h,c,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=hr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(U(t.Ca,t,t.a),t.O)),he(t.J,t.a,"readystatechange",t.Xa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function je(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ve:(i=Number(u.substring(i,o)),isNaN(i)?_e:(o+=1)+i>u.length?Ve:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ve){4==e&&(t.h=4,we(14),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==_e){t.h=4,we(15),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),Be(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),Ge(t),Fe(t))}function xe(t){t.T=x()+t.P,Me(t,t.P)}function Me(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ee(U(t.Va,t),e)}function qe(t){t.o&&(k.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||ir(t.g,t)}function Ge(t){qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Be(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Hn(u)}tr(u),we(18)}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=Ee(U(u.Sa,u),6e3));if(Tn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(An(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=x()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(Nn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(qe(o),xe(o)),n.a=i):Zn(n),0<u.g.length&&Kn(u)):"stop"!=h[0]&&"close"!=h[0]||sr(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?sr(u,7):zn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0)}ge(4)}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Xe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Xe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Se.prototype).setTimeout=function(t){this.P=t},N.Xa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),qe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Ge(this),Fe(this);break t}fe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Be(this,s)}this.I?(je(this,e,n),st&&this.b&&3==e&&(he(this.J,this.R,"tick",this.Wa),this.R.start())):(fe(this.c,this.f,n,null),Be(this,n)),4==e&&Ge(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,xe(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Ge(this),Fe(this)}}}catch(t){}var u,a,h,c,l,f},N.Wa=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(qe(this),je(this,t,e),this.b&&4!=t&&xe(this)))},N.cancel=function(){this.A=!0,Ge(this)},N.Va=function(){this.o=null;var t,e,n=x();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Ge(this),this.h=2,Fe(this)):Me(this,this.T-n)},(N=ze.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return He(this),this.a.concat()},N.get=function(t,e){return Xe(this.b,t)?this.b[t]:e},N.set=function(t,e){Xe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Qe(t){return new Ke(t)}function Je(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=on(e,cn)),t.b=new fn(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?hn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,ln)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,hn=/[#\?]/g,cn=/[#\?@]/g,ln=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new ze,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Xe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function vn(t,e){return pn(t),e=gn(t,e),Xe(t.a.b,e)}function yn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),W(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(N=fn.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){pn(this);var e=[];if("string"==typeof t)vn(this,t)&&(e=B(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},N.set=function(t,e){return pn(this),this.c=null,vn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=function(t,e){this.b=t,this.a=e};function wn(t){this.g=t||bn,t=k.PerformanceNavigationTiming?0<(t=k.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(k.ia&&k.ia.ya&&k.ia.ya()&&k.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var bn=10;function En(t){return t.b||t.a&&t.a.size>=t.f}function Tn(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function An(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function On(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return W(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Rn(){}function kn(){this.a=new Rn}function Ln(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=On(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Rn.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},Rn.prototype.parse=function(t){return k.JSON.parse(t,void 0)};var Dn=k.JSON.parse;function Sn(t){Mt.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}M(Sn,Mt);var Pn="",_n=/^https?$/i,Vn=["POST","PUT"];function Cn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),Mn(t)}function jn(t){t.u||(t.u=!0,qt(t,"complete"),qt(t,"error"))}function xn(t){if(t.b&&void 0!==R&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))te(t.za,0,t);else if(qt(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(Ye)[1]||null)&&k.self&&k.self.location&&(i=(r=k.self.location.protocol).substr(0,r.length-1)),n=!_n.test(i?i.toLowerCase():"")),e=n);if(e)qt(t,"complete"),qt(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",jn(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?L:null;t.a=null,t.s=null,e||qt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(k.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Gn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Bn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.pa=0,this.g=[],this.c=new le,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Bn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Bn("baseRetryDelayMs",5e3,t),this.Ra=Bn("retryDelaySeedMs",1e4,t),this.Ma=Bn("forwardChannelMaxRetries",2,t),this.ma=Bn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new kn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function zn(t){var e,n;Xn(t),3==t.v&&(e=t.R++,en(n=Qe(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Jn(t,n),(e=new Se(t,t.c,e,void 0)).H=2,e.i=nn(Qe(n)),n=!1,k.navigator&&k.navigator.sendBeacon&&(n=k.navigator.sendBeacon(e.i.toString(),"")),!n&&k.Image&&((new Image).src=e.i,n=!0),n||(e.a=hr(e.g,null),e.a.ba(e.i)),e.u=x(),xe(e)),ur(t)}function Hn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Xn(t){Hn(t),t.j&&(k.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&k.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new mn(t.Oa++,e)),3==t.v&&Kn(t)}function Kn(t){En(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Qn(t,e){var n=e?e.f:t.R++,r=Qe(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Jn(t,r),t.i&&t.l&&Gn(r,t.i,t.l),n=new Se(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),An(t.b,n),Ce(n,r,e)}function Jn(t,n){t.f&&We({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?U(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{We(t,function(t,e){var n=t;S(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Yt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Ee(U(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new Se(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Qe(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Jn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Gn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Qe(e)),n.j=null,n.I=!0,Ue(n,t)}function rr(t){null!=t.m&&(k.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,Nn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=x()-e.u,n=t.u,qt(i=ve(),new be(i)),Kn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Tn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)))return t.h=Ee(U(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=U(t.Ya,t),r||(r=new Ke("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||Je(r,"https"),nn(r)),n=r.toString(),r=o,o=new le,k.Image?((i=new Image).onload=j(Ln,o,i,"TestLoadImage: loaded",!0,r),i.onerror=j(Ln,o,i,"TestLoadImage: error",!1,r),i.onabort=j(Ln,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=j(Ln,o,i,"TestLoadImage: timeout",!1,r),k.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Xn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==On(t.b).length&&0==t.g.length||(t.b.c.length=0,W(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ke?Qe(s):new Ke(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=k.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ke(null,void 0),r&&Je(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&J(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Jn(t,a),a}function hr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Sn(t.Na)).F=t.C,e}function cr(){}function lr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function fr(t,e){Mt.call(this),this.a=new Wn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new vr(this)}function pr(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){Le.call(this),this.status=1}function vr(t){this.a=t}(N=Sn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ne(this.H):Ne(Re),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new ze(this.headers);r&&We(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Cn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=k.FormData&&t instanceof k.FormData,0<=F(Vn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},N.xa=function(){void 0!==R&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,qt(this,"timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,qt(this,"complete"),qt(this,"abort"),Mn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),Sn.X.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?xn(this):this.Ua())},N.Ua=function(){xn(this)},N.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Wn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Se(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Qe(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Jn(this,i),this.i&&r&&Gn(i,this.i,r),An(this.b,n),this.Ia&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Ce(n,i,null)):Ce(n,i,e),this.v=2}}else 3==this.v&&(t?Qn(this,t):0==this.g.length||En(this.b)||Qn(this))},N.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ee(U(this.Ta,this),t))},N.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Hn(this),nr(this))},N.Sa=function(){null!=this.m&&(this.m=null,Hn(this),tr(this),we(19))},N.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(N=cr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ja=function(){},lr.prototype.a=function(t,e){return new fr(t,e)},M(fr,Mt),fr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Kn(t)},fr.prototype.close=function(){zn(this.a)},fr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.l?((e={}).__data__=Gt(t),Yn(this.a,e)):Yn(this.a,t)},fr.prototype.G=function(){this.a.f=null,delete this.f,zn(this.a),delete this.a,fr.X.G.call(this)},M(pr,ke),M(dr,Le),M(vr,cr),vr.prototype.ta=function(){qt(this.a,"a")},vr.prototype.sa=function(t){qt(this.a,new pr(t))},vr.prototype.ra=function(t){qt(this.a,new dr)},vr.prototype.qa=function(){qt(this.a,"b")},lr.prototype.createWebChannel=lr.prototype.a,fr.prototype.send=fr.prototype.h,fr.prototype.open=fr.prototype.g,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ie.COMPLETE="complete",(Oe.EventType=O).OPEN="a",O.CLOSE="b",O.ERROR="c",O.MESSAGE="d",Mt.prototype.listen=Mt.prototype.va,Sn.prototype.listenOnce=Sn.prototype.wa,Sn.prototype.getLastError=Sn.prototype.Qa,Sn.prototype.getLastErrorCode=Sn.prototype.ua,Sn.prototype.getStatus=Sn.prototype.W,Sn.prototype.getResponseJson=Sn.prototype.Pa,Sn.prototype.getResponseText=Sn.prototype.$,Sn.prototype.send=Sn.prototype.ba;var yr=ve,gr=Te,mr=Ie,wr=pe,br=10,Er=11,Tr=Oe,Ir=Sn,Ar=(Nr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Nr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Nr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Nr);function Nr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Or=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Rr=(Object.defineProperty(Dr.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Dr.prototype.isEqual=function(t){return t instanceof Dr&&t.projectId===this.projectId&&t.database===this.database},Dr),kr=(Lr.prototype.u=function(){return null!=this.uid},Lr.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},Lr.prototype.isEqual=function(t){return t.uid===this.uid},Lr);function Lr(t){this.uid=t}function Dr(t,e){this.projectId=t,this.database=e||"(default)"}kr.UNAUTHENTICATED=new kr(null),kr.l=new kr("google-credentials-uid"),kr._=new kr("first-party-uid");var Sr=new l("@firebase/firestore");function Pr(){return Sr.logLevel}function _r(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=u.DEBUG&&(e=n.map(Ur),Sr.debug.apply(Sr,s(["Firestore (8.1.1): "+t],e)))}function Vr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=u.ERROR&&(e=n.map(Ur),Sr.error.apply(Sr,s(["Firestore (8.1.1): "+t],e)))}function Cr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=u.WARN&&(e=n.map(Ur),Sr.warn.apply(Sr,s(["Firestore (8.1.1): "+t],e)))}function Ur(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function jr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE (8.1.1) INTERNAL ASSERTION FAILED: "+t;throw Vr(t),new Error(t)}function xr(t){t||jr()}function Mr(t,e){this.user=e,this.type="OAuth",this.m={},this.m.Authorization="Bearer "+t}var qr,Fr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Gr=(n(Jr,qr=Error),Jr),Br=(Qr.prototype.getToken=function(){return Promise.resolve(null)},Qr.prototype.A=function(){},Qr.prototype.I=function(t){(this.T=t)(kr.UNAUTHENTICATED)},Qr.prototype.R=function(){this.T=null},Qr),Wr=(Kr.prototype.getToken=function(){var e=this,n=this.p,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.p!==n?(_r("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(xr("string"==typeof t.accessToken),new Mr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Kr.prototype.A=function(){this.forceRefresh=!0},Kr.prototype.I=function(t){this.T=t,this.V&&t(this.currentUser)},Kr.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.T=null},Kr.prototype.g=function(){var t=this.auth&&this.auth.getUid();return xr(null===t||"string"==typeof t),new kr(t)},Kr),zr=(Object.defineProperty(Yr.prototype,"m",{get:function(){var t={"X-Goog-AuthUser":this.C},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Yr),Hr=(Xr.prototype.getToken=function(){return Promise.resolve(new zr(this.v,this.C))},Xr.prototype.I=function(t){t(kr._)},Xr.prototype.R=function(){},Xr.prototype.A=function(){},Xr);function Xr(t,e){this.v=t,this.C=e}function Yr(t,e){this.v=t,this.C=e,this.type="FirstParty",this.user=kr._}function Kr(t){var e=this;this.P=null,this.currentUser=kr.UNAUTHENTICATED,this.V=!1,this.p=0,this.T=null,this.forceRefresh=!1,this.P=function(){e.p++,e.currentUser=e.g(),e.V=!0,e.T&&e.T(e.currentUser)},this.p=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}function Qr(){this.T=null}function Jr(t,e){var n=this;return(n=qr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var $r=(Zr.S=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Zr);function Zr(){}function ti(t,e){return t<e?-1:e<t?1:0}function ei(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var ni,ri,ii=(vi.now=function(){return vi.fromMillis(Date.now())},vi.fromDate=function(t){return vi.fromMillis(t.getTime())},vi.fromMillis=function(t){var e=Math.floor(t/1e3);return new vi(e,1e6*(t-1e3*e))},vi.prototype.toDate=function(){return new Date(this.toMillis())},vi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},vi.prototype.D=function(t){return this.seconds===t.seconds?ti(this.nanoseconds,t.nanoseconds):ti(this.seconds,t.seconds)},vi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},vi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},vi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},vi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},vi),oi=(di.N=function(t){return new di(t)},di.min=function(){return new di(new ii(0,0))},di.prototype.F=function(t){return this.timestamp.D(t.timestamp)},di.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},di.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},di.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},di.prototype.L=function(){return this.timestamp},di),Ie=(Object.defineProperty(pi.prototype,"length",{get:function(){return this.$},enumerable:!1,configurable:!0}),pi.prototype.isEqual=function(t){return 0===pi.k(this,t)},pi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof pi?t.forEach(function(t){e.push(t)}):e.push(t),this.M(e)},pi.prototype.limit=function(){return this.offset+this.length},pi.prototype.U=function(t){return t=void 0===t?1:t,this.M(this.segments,this.offset+t,this.length-t)},pi.prototype.q=function(){return this.M(this.segments,this.offset,this.length-1)},pi.prototype.B=function(){return this.segments[this.offset]},pi.prototype.j=function(){return this.get(this.length-1)},pi.prototype.get=function(t){return this.segments[this.offset+t]},pi.prototype.W=function(){return 0===this.length},pi.prototype.G=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},pi.prototype.K=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},pi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},pi.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},pi.k=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},pi),si=(n(fi,ri=Ie),fi.prototype.M=function(t,e,n){return new fi(t,e,n)},fi.prototype.Y=function(){return this.H().join("/")},fi.prototype.toString=function(){return this.Y()},fi.J=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new fi(n)},fi.X=function(){return new fi([])},fi),ui=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ai=(n(li,ni=Ie),li.prototype.M=function(t,e,n){return new li(t,e,n)},li.Z=function(t){return ui.test(t)},li.prototype.Y=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),li.Z(t)||(t="`"+t+"`"),t}).join(".")},li.prototype.toString=function(){return this.Y()},li.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},li.nt=function(){return new li(["__name__"])},li.et=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Gr(Fr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Gr(Fr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Gr(Fr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new li(e)},li.X=function(){return new li([])},li),hi=(ci.st=function(t){return new ci(si.J(t))},ci.it=function(t){return new ci(si.J(t).U(5))},ci.prototype.rt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ci.prototype.isEqual=function(t){return null!==t&&0===si.k(this.path,t.path)},ci.prototype.toString=function(){return this.path.toString()},ci.k=function(t,e){return si.k(t.path,e.path)},ci.ot=function(t){return t.length%2==0},ci.ut=function(t){return new ci(new si(t.slice()))},ci);function ci(t){this.path=t}function li(){return null!==ni&&ni.apply(this,arguments)||this}function fi(){return null!==ri&&ri.apply(this,arguments)||this}function pi(t,e,n){void 0===e?e=0:e>t.length&&jr(),void 0===n?n=t.length-e:n>t.length-e&&jr(),this.segments=t,this.offset=e,this.$=n}function di(t){this.timestamp=t}function vi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Gr(Fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Gr(Fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Gr(Fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Gr(Fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function yi(t){return null==t}function gi(t){return 0===t&&1/t==-1/0}var mi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ct=null};function wi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new mi(t,e,n,r,i,o,s)}function bi(t){var e=t;return null===e.ct&&(t=e.path.Y(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.Y()+t.op.toString()+No(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.Y()+t.dir}).join(","),yi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=$u(e.startAt)),e.endAt&&(t+="|ub:",t+=$u(e.endAt)),e.ct=t),e.ct}function Ei(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Eo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ta(t.startAt,e.startAt)&&ta(t.endAt,e.endAt)}function Ti(t){return hi.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ii=(Ai.fromBase64String=function(t){return new Ai(atob(t))},Ai.fromUint8Array=function(t){return new Ai(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ai.prototype.toBase64=function(){return t=this.at,btoa(t);var t},Ai.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},Ai.prototype.ht=function(){return 2*this.at.length},Ai.prototype.F=function(t){return ti(this.at,t.at)},Ai.prototype.isEqual=function(t){return this.at===t.at},Ai);function Ai(t){this.at=t}Ii.lt=new Ii("");function Ni(t){this.count=t}var Oi,Ri=(ki.prototype.dt=function(t){return new ki(this.target,this.targetId,this._t,t,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},ki.prototype.wt=function(t,e){return new ki(this.target,this.targetId,this._t,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},ki.prototype.Et=function(t){return new ki(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,t,this.resumeToken)},ki);function ki(t,e,n,r,i,o,s){void 0===i&&(i=oi.min()),void 0===o&&(o=oi.min()),void 0===s&&(s=Ii.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Li(t){switch(t){case Fr.OK:return jr(),0;case Fr.CANCELLED:case Fr.UNKNOWN:case Fr.DEADLINE_EXCEEDED:case Fr.RESOURCE_EXHAUSTED:case Fr.INTERNAL:case Fr.UNAVAILABLE:case Fr.UNAUTHENTICATED:return;case Fr.INVALID_ARGUMENT:case Fr.NOT_FOUND:case Fr.ALREADY_EXISTS:case Fr.PERMISSION_DENIED:case Fr.FAILED_PRECONDITION:case Fr.ABORTED:case Fr.OUT_OF_RANGE:case Fr.UNIMPLEMENTED:case Fr.DATA_LOSS:return 1;default:return jr(),0}}function Di(t){if(void 0===t)return Vr("GRPC error has no .code"),Fr.UNKNOWN;switch(t){case Oi.OK:return Fr.OK;case Oi.CANCELLED:return Fr.CANCELLED;case Oi.UNKNOWN:return Fr.UNKNOWN;case Oi.DEADLINE_EXCEEDED:return Fr.DEADLINE_EXCEEDED;case Oi.RESOURCE_EXHAUSTED:return Fr.RESOURCE_EXHAUSTED;case Oi.INTERNAL:return Fr.INTERNAL;case Oi.UNAVAILABLE:return Fr.UNAVAILABLE;case Oi.UNAUTHENTICATED:return Fr.UNAUTHENTICATED;case Oi.INVALID_ARGUMENT:return Fr.INVALID_ARGUMENT;case Oi.NOT_FOUND:return Fr.NOT_FOUND;case Oi.ALREADY_EXISTS:return Fr.ALREADY_EXISTS;case Oi.PERMISSION_DENIED:return Fr.PERMISSION_DENIED;case Oi.FAILED_PRECONDITION:return Fr.FAILED_PRECONDITION;case Oi.ABORTED:return Fr.ABORTED;case Oi.OUT_OF_RANGE:return Fr.OUT_OF_RANGE;case Oi.UNIMPLEMENTED:return Fr.UNIMPLEMENTED;case Oi.DATA_LOSS:return Fr.DATA_LOSS;default:return jr()}}(l=Oi=Oi||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Si=(Ui.prototype.Tt=function(t,e){return new Ui(this.k,this.root.Tt(t,e,this.k).copy(null,null,_i.At,null,null))},Ui.prototype.remove=function(t){return new Ui(this.k,this.root.remove(t,this.k).copy(null,null,_i.At,null,null))},Ui.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.k(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ui.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.k(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ui.prototype.W=function(){return this.root.W()},Object.defineProperty(Ui.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ui.prototype.It=function(){return this.root.It()},Ui.prototype.Rt=function(){return this.root.Rt()},Ui.prototype.Pt=function(t){return this.root.Pt(t)},Ui.prototype.forEach=function(n){this.Pt(function(t,e){return n(t,e),!1})},Ui.prototype.toString=function(){var n=[];return this.Pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ui.prototype.yt=function(t){return this.root.yt(t)},Ui.prototype.Vt=function(){return new Pi(this.root,null,this.k,!1)},Ui.prototype.gt=function(t){return new Pi(this.root,t,this.k,!1)},Ui.prototype.vt=function(){return new Pi(this.root,null,this.k,!0)},Ui.prototype.bt=function(t){return new Pi(this.root,t,this.k,!0)},Ui),Pi=(Ci.prototype.Dt=function(){var t=this.St.pop(),e={key:t.key,value:t.value};if(this.Ct)for(t=t.left;!t.W();)this.St.push(t),t=t.right;else for(t=t.right;!t.W();)this.St.push(t),t=t.left;return e},Ci.prototype.Nt=function(){return 0<this.St.length},Ci.prototype.xt=function(){if(0===this.St.length)return null;var t=this.St[this.St.length-1];return{key:t.key,value:t.value}},Ci),_i=(Vi.prototype.copy=function(t,e,n,r,i){return new Vi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Vi.prototype.W=function(){return!1},Vi.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},Vi.prototype.yt=function(t){return this.right.yt(t)||t(this.key,this.value)||this.left.yt(t)},Vi.prototype.min=function(){return this.left.W()?this:this.left.min()},Vi.prototype.It=function(){return this.min().key},Vi.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},Vi.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},Vi.prototype.Ot=function(){if(this.left.W())return Vi.EMPTY;var t=this;return t.left.Lt()||t.left.left.Lt()||(t=t.$t()),(t=t.copy(null,null,null,t.left.Ot(),null)).Ft()},Vi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.W()||r.left.Lt()||r.left.left.Lt()||(r=r.$t()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Lt()&&(r=r.kt()),r.right.W()||r.right.Lt()||r.right.left.Lt()||(r=r.Mt()),0===e(t,r.key)){if(r.right.W())return Vi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Ot())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ft()},Vi.prototype.Lt=function(){return this.color},Vi.prototype.Ft=function(){var t=this;return t.right.Lt()&&!t.left.Lt()&&(t=t.Ut()),t.left.Lt()&&t.left.left.Lt()&&(t=t.kt()),t.left.Lt()&&t.right.Lt()&&(t=t.qt()),t},Vi.prototype.$t=function(){var t=this.qt();return t.right.left.Lt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.kt())).Ut()).qt()),t},Vi.prototype.Mt=function(){var t=this.qt();return t.left.left.Lt()&&(t=(t=t.kt()).qt()),t},Vi.prototype.Ut=function(){var t=this.copy(null,null,Vi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Vi.prototype.kt=function(){var t=this.copy(null,null,Vi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Vi.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Vi.prototype.Bt=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},Vi.prototype.Qt=function(){if(this.Lt()&&this.left.Lt())throw jr();if(this.right.Lt())throw jr();var t=this.left.Qt();if(t!==this.right.Qt())throw jr();return t+(this.Lt()?0:1)},Vi);function Vi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Vi.RED,this.left=null!=r?r:Vi.EMPTY,this.right=null!=i?i:Vi.EMPTY,this.size=this.left.size+1+this.right.size}function Ci(t,e,n,r){this.Ct=r,this.St=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ct?t.left:t.right;else{if(0===i){this.St.push(t);break}this.St.push(t),t=this.Ct?t.right:t.left}}function Ui(t,e){this.k=t,this.root=e||_i.EMPTY}function ji(){this.size=0}_i.EMPTY=null,_i.RED=!0,_i.At=!1,_i.EMPTY=(Object.defineProperty(ji.prototype,"key",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"value",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"color",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"left",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ji.prototype,"right",{get:function(){throw jr()},enumerable:!1,configurable:!0}),ji.prototype.copy=function(t,e,n,r,i){return this},ji.prototype.Tt=function(t,e,n){return new _i(t,e)},ji.prototype.remove=function(t,e){return this},ji.prototype.W=function(){return!0},ji.prototype.Pt=function(t){return!1},ji.prototype.yt=function(t){return!1},ji.prototype.It=function(){return null},ji.prototype.Rt=function(){return null},ji.prototype.Lt=function(){return!1},ji.prototype.Bt=function(){return!0},ji.prototype.Qt=function(){return 0},new ji);var xi=(Gi.prototype.has=function(t){return null!==this.data.get(t)},Gi.prototype.first=function(){return this.data.It()},Gi.prototype.last=function(){return this.data.Rt()},Object.defineProperty(Gi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Gi.prototype.indexOf=function(t){return this.data.indexOf(t)},Gi.prototype.forEach=function(n){this.data.Pt(function(t,e){return n(t),!1})},Gi.prototype.jt=function(t,e){for(var n=this.data.gt(t[0]);n.Nt();){var r=n.Dt();if(0<=this.k(r.key,t[1]))return;e(r.key)}},Gi.prototype.Wt=function(t,e){for(var n=void 0!==e?this.data.gt(e):this.data.Vt();n.Nt();)if(!t(n.Dt().key))return},Gi.prototype.Gt=function(t){t=this.data.gt(t);return t.Nt()?t.Dt().key:null},Gi.prototype.Vt=function(){return new Mi(this.data.Vt())},Gi.prototype.gt=function(t){return new Mi(this.data.gt(t))},Gi.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},Gi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Gi.prototype.W=function(){return this.data.W()},Gi.prototype.Kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Gi.prototype.isEqual=function(t){if(!(t instanceof Gi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.Vt(),n=t.data.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(0!==this.k(r,i))return!1}return!0},Gi.prototype.H=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Gi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Gi.prototype.copy=function(t){var e=new Gi(this.k);return e.data=t,e},Gi),Mi=(Fi.prototype.Dt=function(){return this.zt.Dt().key},Fi.prototype.Nt=function(){return this.zt.Nt()},Fi),qi=new Si(hi.k);function Fi(t){this.zt=t}function Gi(t){this.k=t,this.data=new Si(this.k)}var Bi=new Si(hi.k);var Wi=new Si(hi.k),zi=new xi(hi.k);function Hi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=zi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Xi=new xi(ti);var Yi=(co.Jt=function(t){return new co(t.k)},co.prototype.has=function(t){return null!=this.Ht.get(t)},co.prototype.get=function(t){return this.Ht.get(t)},co.prototype.first=function(){return this.Yt.It()},co.prototype.last=function(){return this.Yt.Rt()},co.prototype.W=function(){return this.Yt.W()},co.prototype.indexOf=function(t){t=this.Ht.get(t);return t?this.Yt.indexOf(t):-1},Object.defineProperty(co.prototype,"size",{get:function(){return this.Yt.size},enumerable:!1,configurable:!0}),co.prototype.forEach=function(n){this.Yt.Pt(function(t,e){return n(t),!1})},co.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Yt.Tt(t,null))},co.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Yt.remove(e)):this},co.prototype.isEqual=function(t){if(!(t instanceof co))return!1;if(this.size!==t.size)return!1;for(var e=this.Yt.Vt(),n=t.Yt.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(!r.isEqual(i))return!1}return!0},co.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},co.prototype.copy=function(t,e){var n=new co;return n.k=this.k,n.Ht=t,n.Yt=e,n},co),Ki=(ho.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);!n||0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):jr()},ho.prototype.Zt=function(){var n=[];return this.Xt.Pt(function(t,e){n.push(e)}),n},ho),Qi=(ao.rn=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new ao(t,e,Yi.Jt(e),i,n,r,!0,!1)},Object.defineProperty(ao.prototype,"hasPendingWrites",{get:function(){return!this.nn.W()},enumerable:!1,configurable:!0}),ao.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.en===t.en&&this.nn.isEqual(t.nn)&&Eu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.tn.isEqual(t.tn)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},ao),Ji=(uo.hn=function(t,e){var n=new Map;return n.set(t,$i.ln(t,e)),new uo(oi.min(),n,Xi,qi,Hi())},uo),$i=(so.ln=function(t,e){return new so(Ii.lt,e,Hi(),Hi(),Hi())},so),Zi=function(t,e,n,r){this.En=t,this.removedTargetIds=e,this.key=n,this.mn=r},to=function(t,e){this.targetId=t,this.Tn=e},eo=function(t,e,n,r){void 0===n&&(n=Ii.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},no=(Object.defineProperty(oo.prototype,"_n",{get:function(){return this.Pn},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"resumeToken",{get:function(){return this.Rn},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"Vn",{get:function(){return 0!==this.An},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"pn",{get:function(){return this.yn},enumerable:!1,configurable:!0}),oo.prototype.gn=function(t){0<t.ht()&&(this.yn=!0,this.Rn=t)},oo.prototype.vn=function(){var n=Hi(),r=Hi(),i=Hi();return this.In.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:jr()}}),new $i(this.Rn,this.Pn,n,r,i)},oo.prototype.bn=function(){this.yn=!1,this.In=fo()},oo.prototype.Cn=function(t,e){this.yn=!0,this.In=this.In.Tt(t,e)},oo.prototype.Sn=function(t){this.yn=!0,this.In=this.In.remove(t)},oo.prototype.Dn=function(){this.An+=1},oo.prototype.Nn=function(){--this.An},oo.prototype.xn=function(){this.yn=!0,this.Pn=!0},oo),ro=(io.prototype.Mn=function(t){for(var e=0,n=t.En;e<n.length;e++){var r=n[e];t.mn instanceof ou?this.Un(r,t.mn):t.mn instanceof su&&this.qn(r,t.key,t.mn)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.qn(s,t.key,t.mn)}},io.prototype.Bn=function(n){var r=this;this.Qn(n,function(t){var e=r.jn(t);switch(n.state){case 0:r.Wn(t)&&e.gn(n.resumeToken);break;case 1:e.Nn(),e.Vn||e.bn(),e.gn(n.resumeToken);break;case 2:e.Nn(),e.Vn||r.removeTarget(t);break;case 3:r.Wn(t)&&(e.xn(),e.gn(n.resumeToken));break;case 4:r.Wn(t)&&(r.Gn(t),e.gn(n.resumeToken));break;default:jr()}})},io.prototype.Qn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.On.forEach(function(t,e){r.Wn(e)&&n(e)})},io.prototype.Kn=function(t){var e=t.targetId,n=t.Tn.count,t=this.zn(e);t&&(Ti(t=t.target)?0===n?(t=new hi(t.path),this.qn(e,t,new su(t,oi.min()))):xr(1===n):this.Hn(e)!==n&&(this.Gn(e),this.kn=this.kn.add(e)))},io.prototype.Yn=function(r){var i=this,o=new Map;this.On.forEach(function(t,e){var n=i.zn(e);n&&(t._n&&Ti(n.target)&&(n=new hi(n.target.path),null!==i.Ln.get(n)||i.Jn(e,n)||i.qn(e,n,new su(n,r))),t.pn&&(o.set(e,t.vn()),t.bn()))});var s=Hi();this.$n.forEach(function(t,e){var n=!0;e.Wt(function(t){t=i.zn(t);return!t||2===t._t||(n=!1)}),n&&(s=s.add(t))});var t=new Ji(r,o,this.kn,this.Ln,s);return this.Ln=qi,this.$n=lo(),this.kn=new xi(ti),t},io.prototype.Un=function(t,e){var n;this.Wn(t)&&(n=this.Jn(t,e.key)?2:0,this.jn(t).Cn(e.key,n),this.Ln=this.Ln.Tt(e.key,e),this.$n=this.$n.Tt(e.key,this.Xn(e.key).add(t)))},io.prototype.qn=function(t,e,n){var r;this.Wn(t)&&(r=this.jn(t),this.Jn(t,e)?r.Cn(e,1):r.Sn(e),this.$n=this.$n.Tt(e,this.Xn(e).delete(t)),n&&(this.Ln=this.Ln.Tt(e,n)))},io.prototype.removeTarget=function(t){this.On.delete(t)},io.prototype.Hn=function(t){var e=this.jn(t).vn();return this.Fn.Zn(t).size+e.fn.size-e.wn.size},io.prototype.Dn=function(t){this.jn(t).Dn()},io.prototype.jn=function(t){var e=this.On.get(t);return e||(e=new no,this.On.set(t,e)),e},io.prototype.Xn=function(t){var e=this.$n.get(t);return e||(e=new xi(ti),this.$n=this.$n.Tt(t,e)),e},io.prototype.Wn=function(t){var e=null!==this.zn(t);return e||_r("WatchChangeAggregator","Detected inactive target",t),e},io.prototype.zn=function(t){var e=this.On.get(t);return e&&e.Vn?null:this.Fn.te(t)},io.prototype.Gn=function(e){var n=this;this.On.set(e,new no),this.Fn.Zn(e).forEach(function(t){n.qn(e,t,null)})},io.prototype.Jn=function(t,e){return this.Fn.Zn(t).has(e)},io);function io(t){this.Fn=t,this.On=new Map,this.Ln=qi,this.$n=lo(),this.kn=new xi(ti)}function oo(){this.An=0,this.In=fo(),this.Rn=Ii.lt,this.Pn=!1,this.yn=!0}function so(t,e,n,r,i){this.resumeToken=t,this._n=e,this.fn=n,this.dn=r,this.wn=i}function uo(t,e,n,r,i){this.ft=t,this.on=e,this.un=n,this.cn=r,this.an=i}function ao(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.tn=n,this.docChanges=r,this.nn=i,this.fromCache=o,this.en=s,this.sn=u}function ho(){this.Xt=new Si(hi.k)}function co(n){this.k=n?function(t,e){return n(t,e)||hi.k(t.key,e.key)}:function(t,e){return hi.k(t.key,e.key)},this.Ht=Bi,this.Yt=new Si(this.k)}function lo(){return new Si(hi.k)}function fo(){return new Si(hi.k)}function po(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function vo(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function yo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function go(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function mo(t){t=Oo(t.mapValue.fields.__local_write_time__.timestampValue);return new ii(t.seconds,t.nanos)}var wo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?go(t)?4:10:jr()}function Eo(r,i){var t,e=bo(r);if(e!==bo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return mo(r).isEqual(mo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Oo(r.timestampValue),t=Oo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,ko(r.bytesValue).isEqual(ko(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Ro((t=r).geoPointValue.latitude)===Ro(e.geoPointValue.latitude)&&Ro(t.geoPointValue.longitude)===Ro(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ro(t.integerValue)===Ro(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Ro(t.doubleValue),e=Ro(e.doubleValue);return t===e?gi(t)===gi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return ei(r.arrayValue.values||[],i.arrayValue.values||[],Eo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(po(e)!==po(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Eo(e[t],n[t])))return!1;return!0}();default:return jr()}}function To(t,e){return void 0!==(t.values||[]).find(function(t){return Eo(t,e)})}function Io(t,e){var n,r,i=bo(t),o=bo(e);if(i!==o)return ti(i,o);switch(i){case 0:return 0;case 1:return ti(t.booleanValue,e.booleanValue);case 2:return n=e,r=Ro(t.integerValue||t.doubleValue),n=Ro(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Ao(t.timestampValue,e.timestampValue);case 4:return Ao(mo(t),mo(e));case 5:return ti(t.stringValue,e.stringValue);case 6:return function(t,e){t=ko(t),e=ko(e);return t.F(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ti(n[i],r[i]);if(0!==o)return o}return ti(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=ti(Ro(i.latitude),Ro(r.latitude)))?n:ti(Ro(i.longitude),Ro(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Io(n[i],r[i]);if(o)return o}return ti(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=ti(r[s],o[s]);if(0!==u)return u;u=Io(n[r[s]],i[o[s]]);if(0!==u)return u}return ti(r.length,o.length)}(t.mapValue,e.mapValue);default:throw jr()}}function Ao(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ti(t,e);var n=Oo(t),t=Oo(e),e=ti(n.seconds,t.seconds);return 0!==e?e:ti(n.nanos,t.nanos)}function No(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Oo(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?ko(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,hi.it(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):jr();var e}(t)}function Oo(t){if(xr(!!t),"string"!=typeof t)return{seconds:Ro(t.seconds),nanos:Ro(t.nanos)};var e=0,n=wo.exec(t);xr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Ro(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ko(t){return"string"==typeof t?Ii.fromBase64String(t):Ii.fromUint8Array(t)}function Lo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.Y()}}function Do(t){return t&&"integerValue"in t}function So(t){return!!t&&"arrayValue"in t}function Po(t){return t&&"nullValue"in t}function _o(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vo(t){return t&&"mapValue"in t}var Co={asc:"ASCENDING",desc:"DESCENDING"},Uo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jo=function(t,e){this.t=t,this.ne=e};function xo(t){return{integerValue:""+t}}function Mo(t,e){if(t.ne){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gi(e)?"-0":e}}function qo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!gi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?xo(e):Mo(t,e);var n}function Fo(t,e){return t.ne?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Go(t,e){return t.ne?e.toBase64():e.toUint8Array()}function Bo(t){return xr(!!t),oi.N((t=Oo(t),new ii(t.seconds,t.nanos)))}function Wo(t,e){return new si(["projects",t.projectId,"databases",t.database]).child("documents").child(e).Y()}function zo(t){t=si.J(t);return xr(ss(t)),t}function Ho(t,e){return Wo(t.t,e.path)}function Xo(t,e){e=zo(e);if(e.get(1)!==t.t.projectId)throw new Gr(Fr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Gr(Fr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new hi(Qo(e))}function Yo(t,e){return Wo(t.t,e)}function Ko(t){return new si(["projects",t.t.projectId,"databases",t.t.database]).Y()}function Qo(t){return xr(4<t.length&&"documents"===t.get(4)),t.U(5)}function Jo(t,e,n){return{name:Ho(t,e),fields:n.proto.mapValue.fields}}function $o(t,e){var n,r,i;if(e instanceof js)n={update:Jo(t,e.key,e.value)};else if(e instanceof Ys)n={delete:Ho(t,e.key)};else if(e instanceof xs)n={update:Jo(t,e.key,e.data),updateMask:(i=e.ee,r=[],i.fields.forEach(function(t){return r.push(t.Y())}),{fieldPaths:r})};else if(e instanceof Bs)n={transform:{document:Ho(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof cs)return{fieldPath:t.field.Y(),setToServerValue:"REQUEST_TIME"};if(e instanceof ls)return{fieldPath:t.field.Y(),appendMissingElements:{values:e.elements}};if(e instanceof ys)return{fieldPath:t.field.Y(),removeAllFromArray:{values:e.elements}};if(e instanceof bs)return{fieldPath:t.field.Y(),increment:e.se};throw jr()})}};else{if(!(e instanceof Ks))return jr();n={verify:Ho(t,e.key)}}return e.re.ie||(n.currentDocument=void 0!==(i=e.re).updateTime?{updateTime:(e=t,t=i.updateTime,Fo(e,t.L()))}:void 0!==i.exists?{exists:i.exists}:jr()),n}function Zo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Yo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Yo(t,r.q()),n.structuredQuery.from=[{collectionId:r.j()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(_o(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NAN"}};if(Po(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(_o(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NOT_NAN"}};if(Po(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rs(t.field),op:(e=t.op,Uo[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:rs((t=t).field),direction:(t=t.dir,Co[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.ne||yi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=es(e.startAt)),e.endAt&&(n.structuredQuery.endAt=es(e.endAt)),n}function ts(t){var e=4===(o=zo(t.parent)).length?si.X():Qo(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(xr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[os(t)]:void 0!==t.fieldFilter?[(n=t,Ru.create(is(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return jr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):jr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new ea(is((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=yi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ns(n.startAt));var u=null;return n.endAt&&(u=ns(n.endAt)),new au(e,i,t,o,r,"F",s,u)}function es(t){return{before:t.before,values:t.position}}function ns(t){var e=!!t.before,t=t.values||[];return new Xu(t,e)}function rs(t){return{fieldPath:t.Y()}}function is(t){return ai.et(t.fieldPath)}function os(t){switch(t.unaryFilter.op){case"IS_NAN":var e=is(t.unaryFilter.field);return Ru.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=is(t.unaryFilter.field);return Ru.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=is(t.unaryFilter.field);return Ru.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=is(t.unaryFilter.field);return Ru.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return jr()}}function ss(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}Ie=function(){this.oe=void 0};function us(t,e){return t instanceof bs?Do(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var as,hs,cs=(n(ps,hs=Ie),ps),ls=(n(fs,as=Ie),fs);function fs(t){var e=this;return(e=as.call(this)||this).elements=t,e}function ps(){return null!==hs&&hs.apply(this,arguments)||this}function ds(t,e){for(var n=Is(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Eo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var vs,ys=(n(gs,vs=Ie),gs);function gs(t){var e=this;return(e=vs.call(this)||this).elements=t,e}function ms(t,e){for(var n=Is(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Eo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ws,bs=(n(Es,ws=Ie),Es);function Es(t,e){var n=this;return(n=ws.call(this)||this).serializer=t,n.se=e,n}function Ts(t){return Ro(t.integerValue||t.doubleValue)}function Is(t){return So(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function As(t,e){this.field=t,this.transform=e}var Ns=(Os.prototype.ue=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].G(t))return!0;return!1},Os.prototype.isEqual=function(t){return ei(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Os);function Os(t){(this.fields=t).sort(ai.k)}function Rs(t,e){this.version=t,this.transformResults=e}var ks=(Ls.ce=function(){return new Ls},Ls.exists=function(t){return new Ls(void 0,t)},Ls.updateTime=function(t){return new Ls(t)},Object.defineProperty(Ls.prototype,"ie",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ls.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ls);function Ls(t,e){this.updateTime=t,this.exists=e}function Ds(t,e){return void 0!==t.updateTime?e instanceof ou&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof ou}l=function(){};function Ss(t,e,n){return t instanceof js?new ou(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof xs?function(t,e,n){if(!Ds(t.re,e))return new uu(t.key,n.version);e=Fs(t,e);return new ou(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Bs?function(t,e,n){if(xr(null!=n.transformResults),!Ds(t.re,e))return new uu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];xr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof ou&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ls?ds(o,s):o instanceof ys?ms(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=zs(t,r.data(),e);return new ou(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new su(t.key,n.version,{hasCommittedMutations:!0})}function Ps(t,e,n,r){return t instanceof js?function(t,e){if(!Ds(t.re,e))return e;e=Vs(e);return new ou(t.key,e,t.value,{ae:!0})}(t,e):t instanceof xs?function(t,e){if(!Ds(t.re,e))return e;var n=Vs(e),e=Fs(t,e);return new ou(t.key,n,e,{ae:!0})}(t,e):t instanceof Bs?function(t,e,n,r){if(!Ds(t.re,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof ou&&(c=n.field(a.field)),null===c&&r instanceof ou&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof cs?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof ls?ds(h,i):h instanceof ys?ms(h,i):(h=us(c=h,i),i=Ts(h)+Ts(c.se),Do(h)&&Do(c.se)?xo(i):Mo(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=zs(t,i.data(),r);return new ou(t.key,i.version,r,{ae:!0})}(t,e,r,n):(e=e,Ds((t=t).re,e)?new su(t.key,oi.min()):e)}function _s(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.re.isEqual(e.re)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.ee.isEqual(e.ee):2!==t.type||ei(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ls&&e instanceof ls||t instanceof ys&&e instanceof ys?ei(t.elements,e.elements,Eo):t instanceof bs&&e instanceof bs?Eo(t.se,e.se):t instanceof cs&&e instanceof cs)}))}function Vs(t){return t instanceof ou?t.version:oi.min()}var Cs,Us,js=(n(qs,Us=l),qs),xs=(n(Ms,Cs=l),Ms);function Ms(t,e,n,r){var i=this;return(i=Cs.call(this)||this).key=t,i.data=e,i.ee=n,i.re=r,i.type=1,i}function qs(t,e,n){var r=this;return(r=Us.call(this)||this).key=t,r.value=e,r.re=n,r.type=0,r}function Fs(t,e){return n=t,e=e instanceof ou?e.data():Qs.empty(),r=new Js(e),n.ee.fields.forEach(function(t){var e;t.W()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.he();var n,r}var Gs,Bs=(n(Ws,Gs=l),Ws);function Ws(t,e){var n=this;return(n=Gs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.re=ks.exists(!0),n}function zs(t,e,n){for(var r=new Js(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.he()}var Hs,Xs,Ys=(n(eu,Xs=l),eu),Ks=(n(tu,Hs=l),tu),Qs=(Zs.empty=function(){return new Zs({mapValue:{}})},Zs.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Vo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.j()])||null},Zs.prototype.isEqual=function(t){return Eo(this.proto,t.proto)},Zs),Js=($s.prototype.set=function(t,e){return this.fe(t,e),this},$s.prototype.delete=function(t){return this.fe(t,null),this},$s.prototype.fe=function(t,e){for(var n=this._e,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===bo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.j(),e)},$s.prototype.he=function(){var t=this.de(ai.X(),this._e);return null!=t?new Qs(t):this.le},$s.prototype.de=function(r,t){var i=this,o=!1,e=this.le.field(r),s=Vo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.de(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},$s);function $s(t){void 0===t&&(t=Qs.empty()),this.le=t,this._e=new Map}function Zs(t){this.proto=t}function tu(t,e){var n=this;return(n=Hs.call(this)||this).key=t,n.re=e,n.type=4,n}function eu(t,e){var n=this;return(n=Xs.call(this)||this).key=t,n.re=e,n.type=3,n}var nu,ru,iu,Ie=function(t,e){this.key=t,this.version=e},ou=(n(lu,iu=Ie),lu.prototype.field=function(t){return this.we.field(t)},lu.prototype.data=function(){return this.we},lu.prototype.Ee=function(){return this.we.proto},lu.prototype.isEqual=function(t){return t instanceof lu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.ae===t.ae&&this.hasCommittedMutations===t.hasCommittedMutations&&this.we.isEqual(t.we)},lu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.we.toString()+", {hasLocalMutations: "+this.ae+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(lu.prototype,"hasPendingWrites",{get:function(){return this.ae||this.hasCommittedMutations},enumerable:!1,configurable:!0}),lu),su=(n(cu,ru=Ie),cu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(cu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),cu.prototype.isEqual=function(t){return t instanceof cu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},cu),uu=(n(hu,nu=Ie),hu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(hu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),hu.prototype.isEqual=function(t){return t instanceof hu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},hu),au=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.me=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Te=null,this.Ae=null,this.startAt,this.endAt};function hu(){return null!==nu&&nu.apply(this,arguments)||this}function cu(t,e,n){var r=this;return(r=ru.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function lu(t,e,n,r){var i=this;return(i=iu.call(this,t,e)||this).we=n,i.ae=!!r.ae,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function fu(t){return new au(t)}function pu(t){return!yi(t.limit)&&"F"===t.limitType}function du(t){return!yi(t.limit)&&"L"===t.limitType}function vu(t){return 0<t.me.length?t.me[0].field:null}function yu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ie())return r.field}return null}function gu(t){return null!==t.collectionGroup}function mu(t){var e=t;if(null===e.Te){e.Te=[];var n=yu(e),t=vu(e);if(null!==n&&null===t)n.tt()||e.Te.push(new ea(n)),e.Te.push(new ea(ai.nt(),"asc"));else{for(var r=!1,i=0,o=e.me;i<o.length;i++){var s=o[i];e.Te.push(s),s.field.tt()&&(r=!0)}r||(n=0<e.me.length?e.me[e.me.length-1].dir:"asc",e.Te.push(new ea(ai.nt(),n)))}}return e.Te}function wu(t){var e=t;if(!e.Ae)if("F"===e.limitType)e.Ae=wi(e.path,e.collectionGroup,mu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=mu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ea(o.field,s))}var u=e.endAt?new Xu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Xu(e.startAt.position,!e.startAt.before):null;e.Ae=wi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ae}function bu(t,e,n){return new au(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Eu(t,e){return Ei(wu(t),wu(e))&&t.limitType===e.limitType}function Tu(t){return bi(wu(t))+"|lt:"+t.limitType}function Iu(t){return"Query(target="+(e=wu(t),n=e.path.Y(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.Y()+" "+t.op+" "+No(t.value)}).join(", ")+"]"),yi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.Y()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+$u(e.startAt)),e.endAt&&(n+=", endAt: "+$u(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Au(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.rt(e.collectionGroup)&&e.path.G(n):hi.ot(e.path)?e.path.isEqual(n):e.path.K(n))&&function(t){for(var e=0,n=i.me;e<n.length;e++){var r=n[e];if(!r.field.tt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Zu(t.startAt,mu(t),n))&&(!t.endAt||!Zu(t.endAt,mu(t),n)));var e,n}function Nu(u){return function(t,e){for(var n=!1,r=0,i=mu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.tt()?hi.k(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Io(n,t):jr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return jr()}}(o,t,e);if(0!==s)return s;n=n||o.field.tt()}return 0}}var Ou,Ru=(n(ku,Ou=function(){}),ku.create=function(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.Re(t,e,n):new Pu(t,e,n):"array-contains"===e?new Bu(t,n):"in"===e?new Wu(t,n):"not-in"===e?new zu(t,n):"array-contains-any"===e?new Hu(t,n):new ku(t,e,n)},ku.Re=function(t,e,n){return new("in"===e?_u:Vu)(t,n)},ku.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.Pe(Io(t,this.value)):null!==t&&bo(this.value)===bo(t)&&this.Pe(Io(t,this.value))},ku.prototype.Pe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return jr()}},ku.prototype.Ie=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},ku);function ku(t,e,n){var r=this;return(r=Ou.call(this)||this).field=t,r.op=e,r.value=n,r}var Lu,Du,Su,Pu=(n(ju,Su=Ru),ju.prototype.matches=function(t){t=hi.k(t.key,this.key);return this.Pe(t)},ju),_u=(n(Uu,Du=Ru),Uu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Uu),Vu=(n(Cu,Lu=Ru),Cu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Cu);function Cu(t,e){var n=this;return(n=Lu.call(this,t,"not-in",e)||this).keys=xu(0,e),n}function Uu(t,e){var n=this;return(n=Du.call(this,t,"in",e)||this).keys=xu(0,e),n}function ju(t,e,n){var r=this;return(r=Su.call(this,t,e,n)||this).key=hi.it(n.referenceValue),r}function xu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return hi.it(t.referenceValue)})}var Mu,qu,Fu,Gu,Bu=(n(Ju,Gu=Ru),Ju.prototype.matches=function(t){t=t.field(this.field);return So(t)&&To(t.arrayValue,this.value)},Ju),Wu=(n(Qu,Fu=Ru),Qu.prototype.matches=function(t){t=t.field(this.field);return null!==t&&To(this.value.arrayValue,t)},Qu),zu=(n(Ku,qu=Ru),Ku.prototype.matches=function(t){if(To(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!To(this.value.arrayValue,t)},Ku),Hu=(n(Yu,Mu=Ru),Yu.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!So(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return To(e.value.arrayValue,t)})},Yu),Xu=function(t,e){this.position=t,this.before=e};function Yu(t,e){return Mu.call(this,t,"array-contains-any",e)||this}function Ku(t,e){return qu.call(this,t,"not-in",e)||this}function Qu(t,e){return Fu.call(this,t,"in",e)||this}function Ju(t,e){return Gu.call(this,t,"array-contains",e)||this}function $u(t){return(t.before?"b":"a")+":"+t.position.map(No).join(",")}function Zu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.tt()?hi.k(hi.it(s.referenceValue),n.key):Io(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ta(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Eo(t.position[n],e.position[n]))return!1;return!0}var ea=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var na=(ca.prototype.Ve=function(t,e,n){for(var r=n.pe,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ss(o,e,r[i]))}return e},ca.prototype.ge=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ps(i,e,e,this.ye))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ps(a,e,o,this.ye))}return e},ca.prototype.ve=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ge(t.key,n.get(t.key));e&&(i=i.Tt(t.key,e))}),i},ca.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Hi())},ca.prototype.isEqual=function(t){return this.batchId===t.batchId&&ei(this.mutations,t.mutations,_s)&&ei(this.baseMutations,t.baseMutations,_s)},ca),ra=(ha.from=function(t,e,n){xr(t.mutations.length===n.length);for(var r=Wi,i=t.mutations,o=0;o<i.length;o++)r=r.Tt(i[o].key,n[o].version);return new ha(t,e,n,r)},ha),ia=(aa.prototype.get=function(t){var e=this.Se(t),e=this.Ne[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.De(o,t))return i}},aa.prototype.has=function(t){return void 0!==this.get(t)},aa.prototype.set=function(t,e){var n=this.Se(t),r=this.Ne[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.De(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Ne[n]=[[t,e]]},aa.prototype.delete=function(t){var e=this.Se(t),n=this.Ne[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.De(n[r][0],t))return 1===n.length?delete this.Ne[e]:n.splice(r,1),!0;return!1},aa.prototype.forEach=function(s){vo(this.Ne,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},aa.prototype.W=function(){return yo(this.Ne)},aa),oa=(ua.prototype.catch=function(t){return this.next(void 0,t)},ua.prototype.next=function(r,i){var o=this;return this.Le&&jr(),this.Le=!0,this.Oe?this.error?this.$e(i,this.error):this.ke(r,this.result):new ua(function(e,n){o.xe=function(t){o.ke(r,t).next(e,n)},o.Fe=function(t){o.$e(i,t).next(e,n)}})},ua.prototype.Me=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ua.prototype.Ue=function(t){try{var e=t();return e instanceof ua?e:ua.resolve(e)}catch(t){return ua.reject(t)}},ua.prototype.ke=function(t,e){return t?this.Ue(function(){return t(e)}):ua.resolve(e)},ua.prototype.$e=function(t,e){return t?this.Ue(function(){return t(e)}):ua.reject(e)},ua.resolve=function(n){return new ua(function(t,e){t(n)})},ua.reject=function(n){return new ua(function(t,e){e(n)})},ua.qe=function(t){return new ua(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ua.Be=function(t){for(var n=ua.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ua.resolve(t):e()})}(r[e]);return n},ua.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qe(i)},ua),sa=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})};function ua(t){var e=this;this.xe=null,this.Fe=null,this.result=void 0,this.error=void 0,this.Oe=!1,this.Le=!1,t(function(t){e.Oe=!0,e.result=t,e.xe&&e.xe(t)},function(t){e.Oe=!0,e.error=t,e.Fe&&e.Fe(t)})}function aa(t,e){this.Se=t,this.De=e,this.Ne={}}function ha(t,e,n,r){this.batch=t,this.be=e,this.pe=n,this.Ce=r}function ca(t,e,n,r){this.batchId=t,this.ye=e,this.baseMutations=n,this.mutations=r}function la(t){return new jo(t,!0)}function fa(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var pa=(ma.prototype.Ge=function(e,n){var r=this;return this.je.Ke(e,n).next(function(t){return r.ze(e,n,t)})},ma.prototype.ze=function(t,r,i){return this.Qe.He(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ge(r,t);return t})},ma.prototype.Ye=function(t,e,i){var o=qi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ge(t,e);o=o.Tt(t,e)}),o},ma.prototype.Je=function(e,t){var n=this;return this.Qe.getEntries(e,t).next(function(t){return n.Xe(e,t)})},ma.prototype.Xe=function(e,r){var i=this;return this.je.Ze(e,r).next(function(t){var t=i.Ye(e,r,t),n=qi;return t.forEach(function(t,e){e=e||new su(t,oi.min()),n=n.Tt(t,e)}),n})},ma.prototype.ts=function(t,e,n){return r=e,hi.ot(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ns(t,e.path):gu(e)?this.es(t,e,n):this.ss(t,e,n);var r},ma.prototype.ns=function(t,e){return this.Ge(t,new hi(e)).next(function(t){var e=Bi;return t instanceof ou&&(e=e.Tt(t.key,t)),e})},ma.prototype.es=function(n,r,i){var o=this,s=r.collectionGroup,u=Bi;return this.We.rs(n,s).next(function(t){return oa.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new au(t,null,e.me.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.ss(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Tt(t,e)})})}).next(function(){return u})})},ma.prototype.ss=function(e,n,t){var h,c,r=this;return this.Qe.ts(e,n,t).next(function(t){return h=t,r.je.os(e,n)}).next(function(t){return c=t,r.us(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),a=Ps(s,a,a,r.ye);h=a instanceof ou?h.Tt(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){Au(n,e)||(h=h.remove(t))}),h})},ma.prototype.us=function(t,e,n){for(var r=Hi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof xs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qe.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof ou&&(h=h.Tt(t,e))}),h})},ma),da=(ga.ls=function(t,e){for(var n=Hi(),r=Hi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ga(t,e.fromCache,n,r)},ga),va=(ya.prototype.fs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ya.prototype.next=function(){var t=++this.previousValue;return this.ds&&this.ds(t),t},ya);function ya(t,e){var n=this;this.previousValue=t,e&&(e._s=function(t){return n.fs(t)},this.ds=function(t){return e.ws(t)})}function ga(t,e,n,r){this.targetId=t,this.fromCache=e,this.cs=n,this.hs=r}function ma(t,e,n){this.Qe=t,this.je=e,this.We=n}va.Es=-1;var wa=(ba.prototype.reset=function(){this.ys=0},ba.prototype.gs=function(){this.ys=this.Ps},ba.prototype.vs=function(t){var e=this;this.cancel();var n=Math.floor(this.ys+this.bs()),r=Math.max(0,Date.now()-this.ps),i=Math.max(0,n-r);0<i&&_r("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ys+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Ts.Cs(this.As,i,function(){return e.ps=Date.now(),t()}),this.ys*=this.Rs,this.ys<this.Is&&(this.ys=this.Is),this.ys>this.Ps&&(this.ys=this.Ps)},ba.prototype.Ss=function(){null!==this.Vs&&(this.Vs.Ds(),this.Vs=null)},ba.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},ba.prototype.bs=function(){return(Math.random()-.5)*this.ys},ba);function ba(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.As=e,this.Is=n,this.Rs=r,this.Ps=i,this.ys=0,this.Vs=null,this.ps=Date.now(),this.reset()}function Ea(t){return"IndexedDbTransactionError"===t.name}function Ta(){return"undefined"!=typeof document?document:null}var Ia=(Oa.Ls=function(t,e,n,r,i){i=new Oa(t,e,Date.now()+n,r,i);return i.start(n),i},Oa.prototype.start=function(t){var e=this;this.$s=setTimeout(function(){return e.ks()},t)},Oa.prototype.Ds=function(){return this.ks()},Oa.prototype.cancel=function(t){null!==this.$s&&(this.clearTimeout(),this.Os.reject(new Gr(Fr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Oa.prototype.ks=function(){var e=this;this.Ns.Ms(function(){return null!==e.$s?(e.clearTimeout(),e.op().then(function(t){return e.Os.resolve(t)})):Promise.resolve()})},Oa.prototype.clearTimeout=function(){null!==this.$s&&(this.Fs(this),clearTimeout(this.$s),this.$s=null)},Oa),Aa=(Object.defineProperty(Na.prototype,"Hs",{get:function(){return this.Bs},enumerable:!1,configurable:!0}),Na.prototype.Ms=function(t){this.enqueue(t)},Na.prototype.Ys=function(t){this.Js(),this.Xs(t)},Na.prototype.Zs=function(){var t;this.Bs||(this.Bs=!0,(t=Ta())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.zs))},Na.prototype.enqueue=function(t){return this.Js(),this.Bs?new Promise(function(t){}):this.Xs(t)},Na.prototype.ti=function(t){var e=this;this.Ms(function(){return e.qs.push(t),e.ni()})},Na.prototype.ni=function(){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.qs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.qs[0]()];case 2:return t.sent(),this.qs.shift(),this.Ks.reset(),[3,4];case 3:if(!Ea(e=t.sent()))throw e;return _r("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.qs.length&&this.Ks.vs(function(){return n.ni()}),t.label=5;case 5:return[2]}})})},Na.prototype.Xs=function(t){var r=this,e=this.Us.then(function(){return r.Ws=!0,t().catch(function(t){throw r.js=t,r.Ws=!1,Vr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ws=!1,t})});return this.Us=e},Na.prototype.Cs=function(t,e,n){var r=this;this.Js(),-1<this.Gs.indexOf(t)&&(e=0);n=Ia.Ls(this,t,e,n,function(t){return r.ei(t)});return this.Qs.push(n),n},Na.prototype.Js=function(){this.js&&jr()},Na.prototype.si=function(){},Na.prototype.ii=function(){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Us];case 1:t.sent(),t.label=2;case 2:if(e!==this.Us)return[3,0];t.label=3;case 3:return[2]}})})},Na.prototype.ri=function(t){for(var e=0,n=this.Qs;e<n.length;e++)if(n[e].As===t)return!0;return!1},Na.prototype.oi=function(r){var i=this;return this.ii().then(function(){i.Qs.sort(function(t,e){return t.xs-e.xs});for(var t=0,e=i.Qs;t<e.length;t++){var n=e[t];if(n.Ds(),"all"!==r&&n.As===r)break}return i.ii()})},Na.prototype.ui=function(t){this.Gs.push(t)},Na.prototype.ei=function(t){t=this.Qs.indexOf(t);this.Qs.splice(t,1)},Na);function Na(){var e=this;this.Us=Promise.resolve(),this.qs=[],this.Bs=!1,this.Qs=[],this.js=null,this.Ws=!1,this.Gs=[],this.Ks=new wa(this,"async_queue_retry"),this.zs=function(){var t=Ta();t&&_r("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ks.Ss()};var t=Ta();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.zs)}function Oa(t,e,n,r,i){this.Ns=t,this.As=e,this.xs=n,this.op=r,this.Fs=i,this.Os=new sa,this.then=this.Os.promise.then.bind(this.Os.promise),this.Os.promise.catch(function(t){})}function Ra(t,e){if(Vr("AsyncQueue",e+": "+t),Ea(t))return new Gr(Fr.UNAVAILABLE,e+": "+t);throw t}function ka(t){this.ci=t}var La=(Ua.prototype.hi=function(t,e){return this.ai.add(e),oa.resolve()},Ua.prototype.rs=function(t,e){return oa.resolve(this.ai.getEntries(e))},Ua),Da=(Ca.prototype.add=function(t){var e=t.j(),n=t.q(),r=this.index[e]||new xi(si.k),t=!r.has(n);return this.index[e]=r.add(n),t},Ca.prototype.has=function(t){var e=t.j(),t=t.q(),e=this.index[e];return e&&e.has(t)},Ca.prototype.getEntries=function(t){return(this.index[t]||new xi(si.k)).H()},Ca),Sa=(Va.prototype.next=function(){return this.li+=2,this.li},Va._i=function(){return new Va(0)},Va.fi=function(){return new Va(-1)},Va),Pa=(_a.prototype.bi=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Ci(t,n.wi)})},_a);function _a(t,e,n,r){this.persistence=t,this.di=e,this.serializer=r,this.wi=new Si(ti),this.Ei=new ia(bi,Ei),this.mi=oi.min(),this.je=t.Ti(n),this.Ai=t.Ii(),this.Ri=t.Pi(),this.yi=new pa(this.Ai,this.je,this.persistence.Vi()),this.pi=t.gi(),this.di.vi(this.yi)}function Va(t){this.li=t}function Ca(){this.index={}}function Ua(){this.ai=new Da}function ja(i,o){return v(this,void 0,void 0,function(){var e,n,m,r;return y(this,function(t){switch(t.label){case 0:return n=(e=i).je,m=e.yi,[4,e.persistence.runTransaction("Handle user change","readonly",function(y){var g;return e.je.Si(y).next(function(t){return g=t,n=e.persistence.Ti(o),m=new pa(e.Ai,n,e.persistence.Vi()),n.Si(y)}).next(function(t){for(var e=[],n=[],r=Hi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var v=d[p];r=r.add(v.key)}}return m.Je(y,r).next(function(t){return{Di:t,Ni:e,xi:n}})})})];case 1:return r=t.sent(),[2,(e.je=n,e.yi=m,e.di.vi(e.yi),r)]}})})}function xa(t,c){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=c.batch.keys(),h=l.Ai.Fi({Oi:!0});return e=l,r=t,o=h,s=(i=c).batch,n=s.keys(),u=oa.resolve(),n.forEach(function(n){u=u.next(function(){return o.He(r,n)}).next(function(t){var e=t,t=i.Ce.get(n);xr(null!==t),(!e||e.version.F(t)<0)&&(e=s.Ve(n,e,i))&&o.Li(e,i.be)})}),u.next(function(){return e.je.$i(r,s)}).next(function(){return h.apply(t)}).next(function(){return l.je.ki(t)}).next(function(){return l.yi.Je(t,a)})})}function Ma(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ri.Mi(t)})}function qa(t,o){var c=t,l=o.ft,f=c.wi;return c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=c.Ai.Fi({Oi:!0});f=c.wi;var u=[];o.on.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.Ri.Ui(s,t.wn,e).next(function(){return c.Ri.qi(s,t.fn,e)})),0<(i=t.resumeToken).ht()&&(n=o.wt(i,l).dt(s.Bi),f=f.Tt(e,n),r=o,i=t,xr(0<(o=n).resumeToken.ht()),(0===r.resumeToken.ht()||3e8<=o.ft.O()-r.ft.O()||0<i.fn.size+i.dn.size+i.wn.size)&&u.push(c.Ri.Qi(s,n))))});var e,a,n,h,r,i=qi;return o.cn.forEach(function(t,e){o.an.has(t)&&u.push(c.persistence.Wi.ji(s,t))}),u.push((e=s,a=t,n=o.cn,h=l,r=Hi(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=qi;return n.forEach(function(t,e){var n=i.get(t),r=h;e instanceof su&&e.version.isEqual(oi.min())?(a.Gi(t,r),o=o.Tt(t,e)):null==n||0<e.version.F(n.version)||0===e.version.F(n.version)&&n.hasPendingWrites?(a.Li(e,r),o=o.Tt(t,e)):_r("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),l.isEqual(oi.min())||(e=c.Ri.Mi(s).next(function(t){return c.Ri.Ki(s,s.Bi,l)}),u.push(e)),oa.qe(u).next(function(){return t.apply(s)}).next(function(){return c.yi.Xe(s,i)})}).then(function(t){return c.wi=f,t})}function Fa(i,o,s){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:n=(e=i).wi.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Wi.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ea(r=t.sent()))throw r;return _r("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.wi=e.wi.remove(o),e.Ei.delete(n.target),[2]}})})}function Ga(t,o,s){var u=t,a=oi.min(),h=Hi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=wu(o),(void 0!==(t=(i=t).Ei.get(r))?oa.resolve(i.wi.get(t)):i.Ri.Hi(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Ri.Yi(e,t.targetId).next(function(t){h=t})}).next(function(){return u.di.ts(e,o,s?a:oi.min(),s?h:Hi())}).next(function(t){return{documents:t,Ji:h}});var t,n,r,i})}function Ba(e){return v(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Fr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return _r("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Wa(t,e,n,r,i){var o=this;this.jr=t,this.Wr=e,this.Ns=n,this.Gr={},this.Kr=[],this.zr=new Map,this.Hr=new Set,this.Yr=[],this.Jr=i,this.Jr.Xr(function(t){n.Ms(function(){return v(o,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return lh(this)?(_r("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return(e=n).Hr.add(4),[4,ih(e)];case 1:return t.sent(),e.Zr.set("Unknown"),e.Hr.delete(4),[4,rh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Zr=new Ja(n,r)}var za,Ha,Xa,l=(nh.prototype.sr=function(){return 1===this.state||2===this.state||4===this.state},nh.prototype.ir=function(){return 2===this.state},nh.prototype.start=function(){3!==this.state?this.auth():this.rr()},nh.prototype.stop=function(){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.sr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},nh.prototype.ur=function(){this.state=0,this.Ks.reset()},nh.prototype.cr=function(){var t=this;this.ir()&&null===this.er&&(this.er=this.Ts.Cs(this.Xi,6e4,function(){return t.ar()}))},nh.prototype.hr=function(t){this.lr(),this.stream.send(t)},nh.prototype.ar=function(){return v(this,void 0,void 0,function(){return y(this,function(t){return this.ir()?[2,this.close(0)]:[2]})})},nh.prototype.lr=function(){this.er&&(this.er.cancel(),this.er=null)},nh.prototype.close=function(e,n){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.lr(),this.Ks.cancel(),this.nr++,3!==e?this.Ks.reset():n&&n.code===Fr.RESOURCE_EXHAUSTED?(Vr(n.toString()),Vr("Using maximum backoff delay to prevent overloading the backend."),this.Ks.gs()):n&&n.code===Fr.UNAUTHENTICATED&&this.tr.A(),null!==this.stream&&(this._r(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.dr(n)];case 1:return t.sent(),[2]}})})},nh.prototype._r=function(){},nh.prototype.auth=function(){var n=this;this.state=1;var t=this.wr(this.nr),e=this.nr;this.tr.getToken().then(function(t){n.nr===e&&n.Er(t)},function(e){t(function(){var t=new Gr(Fr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.mr(t)})})},nh.prototype.Er=function(t){var e=this,n=this.wr(this.nr);this.stream=this.Tr(t),this.stream.Ar(function(){n(function(){return e.state=2,e.listener.Ar()})}),this.stream.dr(function(t){n(function(){return e.mr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},nh.prototype.rr=function(){var t=this;this.state=4,this.Ks.vs(function(){return v(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},nh.prototype.mr=function(t){return _r("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},nh.prototype.wr=function(e){var n=this;return function(t){n.Ts.Ms(function(){return n.nr===e?t():(_r("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},nh),Ya=(n(eh,Xa=l),eh.prototype.Tr=function(t){return this.Zi.Ir("Listen",t)},eh.prototype.onMessage=function(t){this.Ks.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:jr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.ne?(xr(void 0===o||"string"==typeof o),Ii.fromBase64String(o||"")):(xr(void 0===o||o instanceof Uint8Array),Ii.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Fr.UNKNOWN:Di(s.code),new Gr(o,s.message||"")),r=new eo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=Xo(t,u.document.name),a=Bo(u.document.updateTime),s=new Qs({mapValue:{fields:u.document.fields}}),a=new ou(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new Zi(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=Xo(t,u.document),h=u.readTime?Bo(u.readTime):oi.min(),h=new su(a,h),u=u.removedTargetIds||[];r=new Zi([],u,h.key,h)}else if("documentRemove"in e){e.documentRemove;h=e.documentRemove;h.document;var c=Xo(t,h.document),h=h.removedTargetIds||[];r=new Zi([],h,c,null)}else{if(!("filter"in e))return jr();e.filter;c=e.filter;c.targetId;e=c.count||0,e=new Ni(e),c=c.targetId;r=new to(c,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return oi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Bo(t.readTime):oi.min()}(t);return this.listener.Rr(e,t)},eh.prototype.Pr=function(t){var e,n,r,i={};i.database=Ko(this.serializer),i.addTarget=(e=this.serializer,(r=Ti(r=(n=t).target)?{documents:{documents:[Yo(e,r.path)]}}:{query:Zo(e,r)}).targetId=n.targetId,0<n.resumeToken.ht()?r.resumeToken=Go(e,n.resumeToken):0<n.ft.F(oi.min())&&(r.readTime=Fo(e,n.ft.L())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o._t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return jr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.hr(i)},eh.prototype.yr=function(t){var e={};e.database=Ko(this.serializer),e.removeTarget=t,this.hr(e)},eh),Ka=(n(th,Ha=l),Object.defineProperty(th.prototype,"pr",{get:function(){return this.Vr},enumerable:!1,configurable:!0}),th.prototype.start=function(){this.Vr=!1,this.lastStreamToken=void 0,Ha.prototype.start.call(this)},th.prototype._r=function(){this.Vr&&this.gr([])},th.prototype.Tr=function(t){return this.Zi.Ir("Write",t)},th.prototype.onMessage=function(t){if(xr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Vr){this.Ks.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(xr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Bo(t.updateTime):Bo(e);n.isEqual(oi.min())&&(n=Bo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Rs(n,e)}(t,r)})):[]),n=Bo(t.commitTime);return this.listener.vr(n,e)}var n,r;return xr(!t.writeResults||0===t.writeResults.length),this.Vr=!0,this.listener.br()},th.prototype.Cr=function(){var t={};t.database=Ko(this.serializer),this.hr(t)},th.prototype.gr=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return $o(e.serializer,t)})};this.hr(t)},th),Qa=(n(Za,za=function(){}),Za.prototype.Dr=function(){if(this.Sr)throw new Gr(Fr.FAILED_PRECONDITION,"The client has already been terminated.")},Za.prototype.Nr=function(e,n,r){var i=this;return this.Dr(),this.credentials.getToken().then(function(t){return i.Zi.Nr(e,n,r,t)}).catch(function(t){throw t.code===Fr.UNAUTHENTICATED&&i.credentials.A(),t})},Za.prototype.Fr=function(e,n,r){var i=this;return this.Dr(),this.credentials.getToken().then(function(t){return i.Zi.Fr(e,n,r,t)}).catch(function(t){throw t.code===Fr.UNAUTHENTICATED&&i.credentials.A(),t})},Za.prototype.terminate=function(){this.Sr=!1},Za),Ja=($a.prototype.Mr=function(){var t=this;0===this.Lr&&(this.Ur("Unknown"),this.$r=this.Ns.Cs("online_state_timeout",1e4,function(){return t.$r=null,t.qr("Backend didn't respond within 10 seconds."),t.Ur("Offline"),Promise.resolve()}))},$a.prototype.Br=function(t){"Online"===this.state?this.Ur("Unknown"):(this.Lr++,1<=this.Lr&&(this.Qr(),this.qr("Connection failed 1 times. Most recent error: "+t.toString()),this.Ur("Offline")))},$a.prototype.set=function(t){this.Qr(),this.Lr=0,"Online"===t&&(this.kr=!1),this.Ur(t)},$a.prototype.Ur=function(t){t!==this.state&&(this.state=t,this.Or(t))},$a.prototype.qr=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.kr?(Vr(t),this.kr=!1):_r("OnlineStateTracker",t)},$a.prototype.Qr=function(){null!==this.$r&&(this.$r.cancel(),this.$r=null)},$a);function $a(t,e){this.Ns=t,this.Or=e,this.state="Unknown",this.Lr=0,this.$r=null,this.kr=!0}function Za(t,e,n){var r=this;return(r=za.call(this)||this).credentials=t,r.Zi=e,r.serializer=n,r.Sr=!1,r}function th(t,e,n,r,i){var o=this;return(o=Ha.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Vr=!1,o}function eh(t,e,n,r,i){var o=this;return(o=Xa.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function nh(t,e,n,r,i,o){this.Ts=t,this.Xi=n,this.Zi=r,this.tr=i,this.listener=o,this.state=0,this.nr=0,this.er=null,this.stream=null,this.Ks=new wa(t,e)}function rh(r){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:if(!lh(r))return[3,4];e=0,n=r.Yr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function ih(r){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:e=0,n=r.Yr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function oh(t,e){t.zr.has(e.targetId)||(t.zr.set(e.targetId,e),ch(t)?hh(t):wh(t).ir()&&uh(t,e))}function sh(t,e){var n=t,t=wh(n);n.zr.delete(e),t.ir()&&ah(n,e),0===n.zr.size&&(t.ir()?t.cr():lh(n)&&n.Zr.set("Unknown"))}function uh(t,e){t.no.Dn(e.targetId),wh(t).Pr(e)}function ah(t,e){t.no.Dn(e),wh(t).yr(e)}function hh(e){e.no=new ro({Zn:function(t){return e.Gr.Zn(t)},te:function(t){return e.zr.get(t)||null}}),wh(e).start(),e.Zr.Mr()}function ch(t){return lh(t)&&!wh(t).sr()&&0<t.zr.size}function lh(t){return 0===t.Hr.size}function fh(t){t.no=void 0}function ph(s,u,a){return v(this,void 0,void 0,function(){var n,o;return y(this,function(t){switch(t.label){case 0:if(s.Zr.set("Online"),!(u instanceof eo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return v(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zr.has(i)?[4,o.Gr.eo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zr.delete(i),o.no.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),_r("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,dh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Zi?s.no.Mn(u):u instanceof to?s.no.Kn(u):s.no.Bn(u),a.isEqual(oi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ma(s.jr)];case 8:return o=t.sent(),0<=a.F(o)?[4,(i=a,(e=(r=s).no.Yn(i)).on.forEach(function(t,e){var n;0<t.resumeToken.ht()&&((n=r.zr.get(e))&&r.zr.set(e,n.wt(t.resumeToken,i)))}),e.un.forEach(function(t){var e=r.zr.get(t);e&&(r.zr.set(t,e.wt(Ii.lt,e.ft)),ah(r,t),e=new Ri(e.target,t,1,e.sequenceNumber),uh(r,e))}),r.Gr.so(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return _r("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,dh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function dh(n,r,i){return v(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!Ea(r))throw r;return n.Hr.add(1),[4,ih(n)];case 1:return t.sent(),n.Zr.set("Offline"),i=i||function(){return Ma(n.jr)},n.Ns.ti(function(){return v(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return _r("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Hr.delete(1),[4,rh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function vh(e,n){return n().catch(function(t){return dh(e,t,n)})}function yh(a){return v(this,void 0,void 0,function(){var i,o,s,u;return y(this,function(t){switch(t.label){case 0:o=bh(i=a),s=0<i.Kr.length?i.Kr[i.Kr.length-1].batchId:-1,t.label=1;case 1:if(!(lh(i)&&i.Kr.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.jr,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.je.zi(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Kr.length&&o.cr(),[3,7]):(s=u.batchId,function(t,e){t.Kr.push(e);t=bh(t);t.ir()&&t.pr&&t.gr(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,dh(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return gh(i)&&mh(i),[2]}var e,n,r})})}function gh(t){return lh(t)&&!bh(t).sr()&&0<t.Kr.length}function mh(t){bh(t).start()}function wh(n){var t,e,r,i=this;return n.oo||(n.oo=(t=n.Wr,e=n.Ns,r={Ar:function(n){return v(this,void 0,void 0,function(){return y(this,function(t){return n.zr.forEach(function(t,e){uh(n,t)}),[2]})})}.bind(null,n),dr:function(e,n){return v(this,void 0,void 0,function(){return y(this,function(t){return fh(e),ch(e)?(e.Zr.Br(n),hh(e)):e.Zr.set("Unknown"),[2]})})}.bind(null,n),Rr:ph.bind(null,n)},t.Dr(),new Ya(e,t.Zi,t.credentials,t.serializer,r)),n.Yr.push(function(e){return v(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(n.oo.ur(),ch(n)?hh(n):n.Zr.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.oo.stop()];case 2:t.sent(),fh(n),t.label=3;case 3:return[2]}})})})),n.oo}function bh(n){var t,e,r,i=this;return n.uo||(n.uo=(t=n.Wr,e=n.Ns,r={Ar:function(e){return v(this,void 0,void 0,function(){return y(this,function(t){return bh(e).Cr(),[2]})})}.bind(null,n),dr:function(e,n){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return n&&bh(e).pr?[4,function(r,i){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return Li(n=i.code)&&n!==Fr.ABORTED?(e=r.Kr.shift(),bh(r).ur(),[4,vh(r,function(){return r.Gr.ro(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,yh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return gh(e)&&mh(e),[2]}})})}.bind(null,n),br:function(o){return v(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){for(e=bh(o),n=0,r=o.Kr;n<r.length;n++)i=r[n],e.gr(i.mutations);return[2]})})}.bind(null,n),vr:function(r,i,o){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return e=r.Kr.shift(),n=ra.from(e,i,o),[4,vh(r,function(){return r.Gr.io(n)})];case 1:return t.sent(),[4,yh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Dr(),new Ka(e,t.Zi,t.credentials,t.serializer,r)),n.Yr.push(function(e){return v(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(n.uo.ur(),[4,yh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.uo.stop()];case 3:t.sent(),0<n.Kr.length&&(_r("RemoteStore","Stopping write stream with "+n.Kr.length+" pending writes"),n.Kr=[]),t.label=4;case 4:return[2]}})})})),n.uo}function Eh(){this.queries=new ia(Tu,Eu),this.onlineState="Unknown",this.ao=new Set}var Th=function(){this.co=void 0,this.listeners=[]};function Ih(s,u){return v(this,void 0,void 0,function(){var e,n,r,i,o;return y(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Th),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.ho(n)];case 2:return o.co=t.sent(),[3,4];case 3:return o=t.sent(),o=Ra(o,"Initialization of query '"+Iu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.lo(e.onlineState),i.co&&u._o(i.co)&&Nh(e),[2]}})})}function Ah(s,u){return v(this,void 0,void 0,function(){var e,n,r,i,o;return y(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.fo(n))]:[2]})})}function Nh(t){t.ao.forEach(function(t){t.next()})}var Oh=(Bh.prototype._o=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Qi(t.query,t.docs,t.tn,e,t.nn,t.fromCache,t.en,!0)}var o=!1;return this.Eo?this.To(t)&&(this.wo.next(t),o=!0):this.Ao(t,this.onlineState)&&(this.Io(t),o=!0),this.mo=t,o},Bh.prototype.onError=function(t){this.wo.error(t)},Bh.prototype.lo=function(t){this.onlineState=t;var e=!1;return this.mo&&!this.Eo&&this.Ao(this.mo,t)&&(this.Io(this.mo),e=!0),e},Bh.prototype.Ao=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ro&&n||t.docs.W()&&"Offline"!==e)},Bh.prototype.To=function(t){if(0<t.docChanges.length)return!0;var e=this.mo&&this.mo.hasPendingWrites!==t.hasPendingWrites;return!(!t.en&&!e)&&!0===this.options.includeMetadataChanges},Bh.prototype.Io=function(t){t=Qi.rn(t.query,t.docs,t.nn,t.fromCache),this.Eo=!0,this.wo.next(t)},Bh),Rh=(Gh.prototype.W=function(){return this.Po.W()},Gh.prototype.vo=function(t,e){e=new kh(t,e);this.Po=this.Po.add(e),this.Vo=this.Vo.add(e)},Gh.prototype.bo=function(t,e){var n=this;t.forEach(function(t){return n.vo(t,e)})},Gh.prototype.Co=function(t,e){this.So(new kh(t,e))},Gh.prototype.Do=function(t,e){var n=this;t.forEach(function(t){return n.Co(t,e)})},Gh.prototype.No=function(t){var e=this,n=new hi(new si([])),r=new kh(n,t),t=new kh(n,t+1),i=[];return this.Vo.jt([r,t],function(t){e.So(t),i.push(t.key)}),i},Gh.prototype.xo=function(){var e=this;this.Po.forEach(function(t){return e.So(t)})},Gh.prototype.So=function(t){this.Po=this.Po.delete(t),this.Vo=this.Vo.delete(t)},Gh.prototype.Fo=function(t){var e=new hi(new si([])),n=new kh(e,t),t=new kh(e,t+1),r=Hi();return this.Vo.jt([n,t],function(t){r=r.add(t.key)}),r},Gh.prototype.Oo=function(t){var e=new kh(t,0),e=this.Po.Gt(e);return null!==e&&t.isEqual(e.key)},Gh),kh=(Fh.yo=function(t,e){return hi.k(t.key,e.key)||ti(t.Lo,e.Lo)},Fh.po=function(t,e){return ti(t.Lo,e.Lo)||hi.k(t.key,e.key)},Fh),Lh=(qh.prototype.$o=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},qh.prototype.ko=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},qh.prototype.Mo=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},qh),Dh=(Mh.prototype.Bo=function(t){},Mh.prototype.Qo=function(t,e,n){},Mh.prototype.jo=function(t){return this.Uo.$o(t),this.qo[t]||"not-current"},Mh.prototype.Wo=function(t,e,n){this.qo[t]=e},Mh.prototype.Go=function(t){this.Uo.ko(t)},Mh.prototype.Ko=function(t){return this.Uo.activeTargetIds.has(t)},Mh.prototype.zo=function(t){delete this.qo[t]},Mh.prototype.Ho=function(){return this.Uo.activeTargetIds},Mh.prototype.Yo=function(t){return this.Uo.activeTargetIds.has(t)},Mh.prototype.start=function(){return this.Uo=new Lh,Promise.resolve()},Mh.prototype.Jo=function(t,e,n){},Mh.prototype.Xo=function(t){},Mh.prototype.Zo=function(){},Mh.prototype.ws=function(t){},Mh.prototype.tu=function(){},Mh),Sh=function(t){this.key=t},Ph=function(t){this.key=t},_h=(Object.defineProperty(xh.prototype,"ou",{get:function(){return this.nu},enumerable:!1,configurable:!0}),xh.prototype.uu=function(t,e){var s=this,u=e?e.cu:new Ki,a=(e||this).ru,h=(e||this).nn,c=a,l=!1,f=pu(this.query)&&a.size===this.query.limit?a.last():null,p=du(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pt(function(t,e){var n=a.get(t),r=(r=e instanceof ou?e:null)&&(Au(s.query,r)?r:null),i=!!n&&s.nn.has(n.key),o=!!r&&(r.ae||s.nn.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.au(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.iu(r,f)||p&&s.iu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),pu(this.query)||du(this.query))for(;c.size>this.query.limit;){var n=pu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{ru:c,cu:u,hu:l,nn:h}},xh.prototype.au=function(t,e){return t.ae&&e.hasCommittedMutations&&!e.ae},xh.prototype.lu=function(t,e,n){var o=this,r=this.ru;this.ru=t.ru,this.nn=t.nn;var i=t.cu.Zt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.iu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return jr()}}var r,i}),this._u(n);var s=e?this.fu():[],n=0===this.su.size&&this._n?1:0,e=n!==this.eu;return this.eu=n,0!==i.length||e?{snapshot:new Qi(this.query,t.ru,r,i,t.nn,0==n,e,!1),du:s}:{du:s}},xh.prototype.lo=function(t){return this._n&&"Offline"===t?(this._n=!1,this.lu({ru:this.ru,cu:new Ki,nn:this.nn,hu:!1},!1)):{du:[]}},xh.prototype.wu=function(t){return!this.nu.has(t)&&!!this.ru.has(t)&&!this.ru.get(t).ae},xh.prototype._u=function(t){var e=this;t&&(t.fn.forEach(function(t){return e.nu=e.nu.add(t)}),t.dn.forEach(function(t){}),t.wn.forEach(function(t){return e.nu=e.nu.delete(t)}),this._n=t._n)},xh.prototype.fu=function(){var e=this;if(!this._n)return[];var n=this.su;this.su=Hi(),this.ru.forEach(function(t){e.wu(t.key)&&(e.su=e.su.add(t.key))});var r=[];return n.forEach(function(t){e.su.has(t)||r.push(new Ph(t))}),this.su.forEach(function(t){n.has(t)||r.push(new Sh(t))}),r},xh.prototype.Eu=function(t){this.nu=t.Ji,this.su=Hi();t=this.uu(t.documents);return this.lu(t,!0)},xh.prototype.mu=function(){return Qi.rn(this.query,this.ru,this.nn,0===this.eu)},xh),Vh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Ch=function(t){this.key=t,this.Tu=!1},Uh=(Object.defineProperty(jh.prototype,"Fu",{get:function(){return!0===this.xu},enumerable:!1,configurable:!0}),jh);function jh(t,e,n,r,i,o){this.jr=t,this.Au=e,this.Iu=n,this.Ru=r,this.currentUser=i,this.Pu=o,this.yu={},this.Vu=new ia(Tu,Eu),this.pu=new Map,this.gu=[],this.vu=new Si(hi.k),this.bu=new Map,this.Cu=new Rh,this.Su={},this.Du=new Map,this.Nu=Sa.fi(),this.onlineState="Unknown",this.xu=void 0}function xh(t,e){this.query=t,this.nu=e,this.eu=null,this._n=!1,this.su=Hi(),this.nn=Hi(),this.iu=Nu(t),this.ru=new Yi(this.iu)}function Mh(){this.Uo=new Lh,this.qo={},this.Or=null,this._s=null}function qh(){this.activeTargetIds=Xi}function Fh(t,e){this.key=t,this.Lo=e}function Gh(){this.Po=new xi(kh.yo),this.Vo=new xi(kh.po)}function Bh(t,e,n){this.query=t,this.wo=e,this.Eo=!1,this.mo=null,this.onlineState="Unknown",this.options=n||{}}function Wh(h,c){return v(this,void 0,void 0,function(){var n,o,s,u,a;return y(this,function(t){switch(t.label){case 0:return(e=h).Au.Gr.so=Hh.bind(null,e),e.Au.Gr.Zn=function(t,e){var n=t,t=n.bu.get(e);if(t&&t.Tu)return Hi().add(t.key);var r=Hi(),e=n.pu.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.Vu.get(s);r=r.Kt(s.view.ou)}return r}.bind(null,e),e.Au.Gr.eo=function(o,s,u){return v(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:return(e=o).Ru.Wo(s,"rejected",u),i=e.bu.get(s),(n=i&&i.key)?(r=(r=new Si(hi.k)).Tt(n,new su(n,oi.min())),i=Hi().add(n),i=new Ji(oi.min(),new Map,new xi(ti),r,i),[4,Hh(e,i)]):[3,2];case 1:return t.sent(),e.vu=e.vu.remove(n),e.bu.delete(s),tc(e),[3,4];case 2:return[4,Fa(e.jr,s,!1).then(function(){return Jh(e,s,u)}).catch(Ba)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.yu.Rr=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,h=u.listeners;a<h.length;a++)h[a]._o(s)&&(r=!0);u.co=s}}r&&Nh(n)}.bind(null,e.Iu),e.yu.Ou=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.Iu),(a=(n=e).Vu.get(c))?(o=a.targetId,n.Ru.jo(o),s=a.view.mu(),[3,4]):[3,1];case 1:return[4,(e=n.jr,r=wu(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Ri.Hi(e,r).next(function(t){return t?(n=t,oa.resolve(n)):i.Ri.Lu(e).next(function(t){return n=new Ri(r,t,0,e.Bi),i.Ri.$u(e,n).next(function(){return n})})})}).then(function(t){var e=i.wi.get(t.targetId);return(null===e||0<t.ft.F(e.ft))&&(i.wi=i.wi.Tt(t.targetId,t),i.Ei.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Ru.jo(u.targetId),o=u.targetId,[4,function(i,o,s,u){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return i.ku=function(t,e,n){return function(r,i,o,s){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return(e=i.view.uu(o)).hu?[4,Ga(r.jr,i.query,!1).then(function(t){t=t.documents;return i.view.uu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.on.get(i.targetId),n=i.view.lu(e,r.Fu,n),[2,(Zh(r,i.targetId,n.du),n.snapshot)]}})})}(i,t,e,n)},[4,Ga(i.jr,o,!0)];case 1:return n=t.sent(),r=new _h(o,n.Ji),e=r.uu(n.documents),n=$i.ln(s,u&&"Offline"!==i.onlineState),n=r.lu(e,i.Fu,n),Zh(i,s,n.du),r=new Vh(o,s,r),i.Vu.set(o,r),i.pu.has(s)?i.pu.get(s).push(o):i.pu.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Fu&&oh(n.Au,u),t.label=4;case 4:return[2,s]}var r,i,e})})}function zh(f,p,d){return v(this,void 0,void 0,function(){var s,u;return y(this,function(t){switch(t.label){case 0:(o=f).Au.Gr.io=function(i,o){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,xa(e.jr,o)];case 2:return r=t.sent(),Qh(e,n,null),Kh(e,n),e.Ru.Qo(n,"acknowledged"),[4,ec(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Ba(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.Au.Gr.ro=function(s,u,a){return v(this,void 0,void 0,function(){var n,o;return y(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jr,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.je.qu(e,r).next(function(t){return xr(null!==t),n=t.keys(),i.je.$i(e,t)}).next(function(){return i.je.ki(e)}).next(function(){return i.yi.Je(e,n)})}))];case 2:return o=t.sent(),Qh(n,u,a),Kh(n,u),n.Ru.Qo(u,"rejected",a),[4,ec(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Ba(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.jr,a=p,c=r,l=ii.now(),i=a.reduce(function(t,e){return t.add(e.key)},Hi()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.yi.Je(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Bs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof ou?t.field(i.field):void 0,o=us(i.transform,o||null);null!=o&&(e=(null==e?new Js:e).set(i.field,o))}return e?e.he():null}(o):null);null!=o&&e.push(new xs(i.key,o,function s(t){var u=[];return vo(t.fields||{},function(t,e){var n=new ai([t]);if(Vo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ns(u)}(o.proto.mapValue),ks.exists(!0)))}return c.je.Mu(u,l,e,a)})}).then(function(t){var e=t.ve(h);return{batchId:t.batchId,Uu:e}}))];case 2:return s=t.sent(),u.Ru.Bo(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.Su[e.currentUser.h()])||new Si(ti)).Tt(n,o),e.Su[e.currentUser.h()]=r,[4,ec(u,s.Uu)];case 3:return t.sent(),[4,yh(u.Au)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Ra(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function Hh(r,i){return v(this,void 0,void 0,function(){var n,e;return y(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,qa(n.jr,i)];case 2:return e=t.sent(),i.on.forEach(function(t,e){e=n.bu.get(e);e&&(xr(t.fn.size+t.dn.size+t.wn.size<=1),0<t.fn.size?e.Tu=!0:0<t.dn.size?xr(e.Tu):0<t.wn.size&&(xr(e.Tu),e.Tu=!1))}),[4,ec(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Ba(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Xh(t,n,e){var r,t=t;(t.Fu&&0===e||!t.Fu&&1===e)&&(r=[],t.Vu.forEach(function(t,e){e=e.view.lo(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].lo(i)&&(o=!0)}),o&&Nh(t)}(t.Iu,n),r.length&&t.yu.Rr(r),t.onlineState=n,t.Fu&&t.Ru.Xo(n))}function Yh(o,s){return v(this,void 0,void 0,function(){var n,r,i;return y(this,function(t){switch(t.label){case 0:lh((n=o).Au)||_r("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.jr).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.je.Bu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Du.get(r)||[]).push(s),n.Du.set(r,i),[3,4]);case 3:return i=t.sent(),i=Ra(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Kh(t,e){(t.Du.get(e)||[]).forEach(function(t){t.resolve()}),t.Du.delete(e)}function Qh(t,e,n){var r=t,i=r.Su[r.currentUser.h()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Su[r.currentUser.h()]=i)}function Jh(e,t,n){void 0===n&&(n=null),e.Ru.Go(t);for(var r=0,i=e.pu.get(t);r<i.length;r++){var o=i[r];e.Vu.delete(o),n&&e.yu.Ou(o,n)}e.pu.delete(t),e.Fu&&e.Cu.No(t).forEach(function(t){e.Cu.Oo(t)||$h(e,t)})}function $h(t,e){var n=t.vu.get(e);null!==n&&(sh(t.Au,n),t.vu=t.vu.remove(e),t.bu.delete(n),tc(t))}function Zh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Sh?(t.Cu.vo(o.key,e),function(t,e){e=e.key;t.vu.get(e)||(_r("SyncEngine","New document in limbo: "+e),t.gu.push(e),tc(t))}(t,o)):o instanceof Ph?(_r("SyncEngine","Document no longer in limbo: "+o.key),t.Cu.Co(o.key,e),t.Cu.Oo(o.key)||$h(t,o.key)):jr()}}function tc(t){for(;0<t.gu.length&&t.vu.size<t.Pu;){var e=t.gu.shift(),n=t.Nu.next();t.bu.set(n,new Ch(e)),t.vu=t.vu.Tt(e,n),oh(t.Au,new Ri(wu(fu(e.path)),n,2,va.Es))}}function ec(e,s,u){return v(this,void 0,void 0,function(){var n,r,i,o;return y(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Vu.W()?[3,3]:(n.Vu.forEach(function(t,e){o.push(n.ku(e,s,u).then(function(t){t&&(n.Fu&&n.Ru.Wo(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=da.ls(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.yu.Rr(r),[4,function(a,h){return v(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return y(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return oa.forEach(h,function(e){return oa.forEach(e.cs,function(t){return r.persistence.Wi.vo(n,e.targetId,t)}).next(function(){return oa.forEach(e.hs,function(t){return r.persistence.Wi.Co(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ea(e=t.sent()))throw e;return _r("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.wi.get(o),u=s.ft,u=s.Et(u),r.wi=r.wi.Tt(o,u));return[2]}})})}(n.jr,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function nc(i,o){return v(this,void 0,void 0,function(){var n,r;return y(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(_r("SyncEngine","User change. New user:",o.h()),[4,ja(n.jr,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Du.forEach(function(t){t.forEach(function(t){t.reject(new Gr(Fr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Du.clear(),n.Ru.Jo(o,r.Ni,r.xi),[4,ec(n,r.Di)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}var rc,ic,oc,sc=(Gc.prototype.vi=function(t){this.Qu=t},Gc.prototype.ts=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.me.length||1===r.me.length&&r.me[0].field.tt())||i.isEqual(oi.min())?this.ju(e,r):this.Qu.Je(e,o).next(function(t){var n=s.Wu(r,t);return(pu(r)||du(r))&&s.hu(r.limitType,n,o,i)?s.ju(e,r):(Pr()<=u.DEBUG&&_r("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Iu(r)),s.Qu.ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.Tt(t.key,t)}),e}))})},Gc.prototype.Wu=function(n,t){var r=new xi(Nu(n));return t.forEach(function(t,e){e instanceof ou&&Au(n,e)&&(r=r.add(e))}),r},Gc.prototype.hu=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.F(r))},Gc.prototype.ju=function(t,e){return Pr()<=u.DEBUG&&_r("IndexFreeQueryEngine","Using full collection scan to execute query:",Iu(e)),this.Qu.ts(t,e,oi.min())},Gc),uc=(Fc.prototype.zu=function(t){return oa.resolve(0===this.je.length)},Fc.prototype.Mu=function(t,e,n,r){var i=this.Gu;this.Gu++,0<this.je.length&&this.je[this.je.length-1];n=new na(i,e,n,r);this.je.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Ku=this.Ku.add(new kh(u.key,i)),this.We.hi(t,u.key.path.q())}return oa.resolve(n)},Fc.prototype.qu=function(t,e){return oa.resolve(this.Hu(e))},Fc.prototype.zi=function(t,e){e+=1,e=this.Yu(e),e=e<0?0:e;return oa.resolve(this.je.length>e?this.je[e]:null)},Fc.prototype.Bu=function(){return oa.resolve(0===this.je.length?-1:this.Gu-1)},Fc.prototype.Si=function(t){return oa.resolve(this.je.slice())},Fc.prototype.Ke=function(t,e){var n=this,r=new kh(e,0),e=new kh(e,Number.POSITIVE_INFINITY),i=[];return this.Ku.jt([r,e],function(t){t=n.Hu(t.Lo);i.push(t)}),oa.resolve(i)},Fc.prototype.Ze=function(t,e){var n=this,r=new xi(ti);return e.forEach(function(t){var e=new kh(t,0),t=new kh(t,Number.POSITIVE_INFINITY);n.Ku.jt([e,t],function(t){r=r.add(t.Lo)})}),oa.resolve(this.Ju(r))},Fc.prototype.os=function(t,e){var n=e.path,r=n.length+1,e=n;hi.ot(e)||(e=e.child(""));var e=new kh(new hi(e),0),i=new xi(ti);return this.Ku.Wt(function(t){var e=t.key.path;return!!n.G(e)&&(e.length===r&&(i=i.add(t.Lo)),!0)},e),oa.resolve(this.Ju(i))},Fc.prototype.Ju=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Hu(t);null!==t&&n.push(t)}),n},Fc.prototype.$i=function(n,r){var i=this;xr(0===this.Xu(r.batchId,"removed")),this.je.shift();var o=this.Ku;return oa.forEach(r.mutations,function(t){var e=new kh(t.key,r.batchId);return o=o.delete(e),i.Wi.Zu(n,t.key)}).next(function(){i.Ku=o})},Fc.prototype.tc=function(t){},Fc.prototype.Oo=function(t,e){var n=new kh(e,0),n=this.Ku.Gt(n);return oa.resolve(e.isEqual(n&&n.key))},Fc.prototype.ki=function(t){return this.je.length,oa.resolve()},Fc.prototype.Xu=function(t,e){return this.Yu(t)},Fc.prototype.Yu=function(t){return 0===this.je.length?0:t-this.je[0].batchId},Fc.prototype.Hu=function(t){t=this.Yu(t);return t<0||t>=this.je.length?null:this.je[t]},Fc),ac=(qc.prototype.Li=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.nc(e);return this.docs=this.docs.Tt(r,{ec:e,size:i,readTime:n}),this.size+=i-o,this.We.hi(t,r.path.q())},qc.prototype.Gi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},qc.prototype.He=function(t,e){e=this.docs.get(e);return oa.resolve(e?e.ec:null)},qc.prototype.getEntries=function(t,e){var n=this,r=qi;return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.ec:null)}),oa.resolve(r)},qc.prototype.ts=function(t,e,n){for(var r=Bi,i=new hi(e.path.child("")),o=this.docs.gt(i);o.Nt();){var s=o.Dt(),u=s.key,a=s.value,s=a.ec,a=a.readTime;if(!e.path.G(u.path))break;a.F(n)<=0||s instanceof ou&&Au(e,s)&&(r=r.Tt(s.key,s))}return oa.resolve(r)},qc.prototype.sc=function(t,e){return oa.forEach(this.docs,function(t){return e(t)})},qc.prototype.Fi=function(t){return new hc(this)},qc.prototype.ic=function(t){return oa.resolve(this.size)},qc),hc=(Mc.prototype.oc=function(t){t=this.Uu.get(t);return t?t.readTime:oi.min()},Mc.prototype.Li=function(t,e){this.uc(),this.Uu.set(t.key,{ec:t,readTime:e})},Mc.prototype.Gi=function(t,e){void 0===e&&(e=null),this.uc(),this.Uu.set(t,{ec:null,readTime:e})},Mc.prototype.He=function(t,e){this.uc();var n=this.Uu.get(e);return void 0!==n?oa.resolve(n.ec):this.cc(t,e)},Mc.prototype.getEntries=function(t,e){return this.ac(t,e)},Mc.prototype.apply=function(t){return this.uc(),this.rc=!0,this.lu(t)},Mc.prototype.uc=function(){},n(xc,oc=Mc),xc.prototype.lu=function(n){var r=this,i=[];return this.Uu.forEach(function(t,e){e&&e.ec?i.push(r.hc.Li(n,e.ec,r.oc(t))):r.hc.Gi(t)}),oa.qe(i)},xc.prototype.cc=function(t,e){return this.hc.He(t,e)},xc.prototype.ac=function(t,e){return this.hc.getEntries(t,e)},xc),cc=(jc.prototype.Qn=function(t,n){return this.lc.forEach(function(t,e){return n(e)}),oa.resolve()},jc.prototype.Mi=function(t){return oa.resolve(this.lastRemoteSnapshotVersion)},jc.prototype.wc=function(t){return oa.resolve(this._c)},jc.prototype.Lu=function(t){return this.highestTargetId=this.dc.next(),oa.resolve(this.highestTargetId)},jc.prototype.Ki=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this._c&&(this._c=e),oa.resolve()},jc.prototype.Ec=function(t){this.lc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.dc=new Sa(e),this.highestTargetId=e),t.sequenceNumber>this._c&&(this._c=t.sequenceNumber)},jc.prototype.$u=function(t,e){return this.Ec(e),this.targetCount+=1,oa.resolve()},jc.prototype.Qi=function(t,e){return this.Ec(e),oa.resolve()},jc.prototype.mc=function(t,e){return this.lc.delete(e.target),this.fc.No(e.targetId),--this.targetCount,oa.resolve()},jc.prototype.Tc=function(n,r,i){var o=this,s=0,u=[];return this.lc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.lc.delete(t),u.push(o.Ac(n,e.targetId)),s++)}),oa.qe(u).next(function(){return s})},jc.prototype.Ic=function(t){return oa.resolve(this.targetCount)},jc.prototype.Hi=function(t,e){e=this.lc.get(e)||null;return oa.resolve(e)},jc.prototype.qi=function(t,e,n){return this.fc.bo(e,n),oa.resolve()},jc.prototype.Ui=function(e,t,n){this.fc.Do(t,n);var r=this.persistence.Wi,i=[];return r&&t.forEach(function(t){i.push(r.Zu(e,t))}),oa.qe(i)},jc.prototype.Ac=function(t,e){return this.fc.No(e),oa.resolve()},jc.prototype.Yi=function(t,e){e=this.fc.Fo(e);return oa.resolve(e)},jc.prototype.Oo=function(t,e){return oa.resolve(this.fc.Oo(e))},jc),lc=(Uc.prototype.yc=function(t,e){return oa.resolve(this.Rc.get(e))},Uc.prototype.Vc=function(t,e){return this.Rc.set(e.id,{id:e.id,version:e.version,createTime:Bo(e.createTime)}),oa.resolve()},Uc.prototype.gc=function(t,e){return oa.resolve(this.Pc.get(e))},Uc.prototype.vc=function(t,e){var n,r;return this.Pc.set(e.name,{name:(n=e).name,query:(r=n.bundledQuery,e=ts({parent:r.parent,structuredQuery:r.structuredQuery}),"LAST"===r.limitType?bu(e,e.limit,"L"):e),readTime:Bo(n.readTime)}),oa.resolve()},Uc),fc=(Cc.prototype.start=function(){return Promise.resolve()},Cc.prototype.Zo=function(){return this.Sc=!1,Promise.resolve()},Object.defineProperty(Cc.prototype,"Nc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),Cc.prototype.xc=function(){},Cc.prototype.Fc=function(){},Cc.prototype.Vi=function(){return this.We},Cc.prototype.Ti=function(t){var e=this.bc[t.h()];return e||(e=new uc(this.We,this.Wi),this.bc[t.h()]=e),e},Cc.prototype.Pi=function(){return this.Ri},Cc.prototype.Ii=function(){return this.Qe},Cc.prototype.gi=function(){return this.pi},Cc.prototype.runTransaction=function(t,e,n){var r=this;_r("MemoryPersistence","Starting transaction:",t);var i=new pc(this.Cc.next());return this.Wi.Oc(),n(i).next(function(t){return r.Wi.Lc(i).next(function(){return t})}).Me().then(function(t){return i.$c(),t})},Cc.prototype.kc=function(e,n){return oa.Be(Object.values(this.bc).map(function(t){return function(){return t.Oo(e,n)}}))},Cc),pc=(Vc.prototype.Uc=function(t){this.Mc.push(t)},Vc.prototype.$c=function(){this.Mc.forEach(function(t){return t()})},n(_c,ic=Vc),_c),dc=(Pc.Qc=function(t){return new Pc(t)},Object.defineProperty(Pc.prototype,"jc",{get:function(){if(this.Bc)return this.Bc;throw jr()},enumerable:!1,configurable:!0}),Pc.prototype.vo=function(t,e,n){return this.qc.vo(n,e),this.jc.delete(n.toString()),oa.resolve()},Pc.prototype.Co=function(t,e,n){return this.qc.Co(n,e),this.jc.add(n.toString()),oa.resolve()},Pc.prototype.Zu=function(t,e){return this.jc.add(e.toString()),oa.resolve()},Pc.prototype.removeTarget=function(t,e){var n=this;this.qc.No(e.targetId).forEach(function(t){return n.jc.add(t.toString())});var r=this.persistence.Pi();return r.Yi(t,e.targetId).next(function(t){t.forEach(function(t){return n.jc.add(t.toString())})}).next(function(){return r.mc(t,e)})},Pc.prototype.Oc=function(){this.Bc=new Set},Pc.prototype.Lc=function(n){var r=this,i=this.persistence.Ii().Fi();return oa.forEach(this.jc,function(t){var e=hi.st(t);return r.Wc(n,e).next(function(t){t||i.Gi(e)})}).next(function(){return r.Bc=null,i.apply(n)})},Pc.prototype.ji=function(t,e){var n=this;return this.Wc(t,e).next(function(t){t?n.jc.delete(e.toString()):n.jc.add(e.toString())})},Pc.prototype.Dc=function(t){return 0},Pc.prototype.Wc=function(t,e){var n=this;return oa.Be([function(){return oa.resolve(n.qc.Oo(e))},function(){return n.persistence.Pi().Oo(t,e)},function(){return n.persistence.kc(t,e)}])},Pc),vc=(Sc.prototype.Ar=function(t){this.zc=t},Sc.prototype.dr=function(t){this.Hc=t},Sc.prototype.onMessage=function(t){this.Yc=t},Sc.prototype.close=function(){this.Kc()},Sc.prototype.send=function(t){this.Gc(t)},Sc.prototype.Jc=function(){this.zc()},Sc.prototype.Xc=function(t){this.Hc(t)},Sc.prototype.Zc=function(t){this.Yc(t)},Sc),yc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},gc=(Dc.prototype.Nr=function(e,t,n,r){var i=this.sa(e,t);_r("RestConnection","Sending: ",i,n);t={};return this.ia(t,r),this.ra(e,i,t,n).then(function(t){return _r("RestConnection","Received: ",t),t},function(t){throw Cr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Dc.prototype.Fr=function(t,e,n,r){return this.Nr(t,e,n,r)},Dc.prototype.ia=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.1",t["Content-Type"]="text/plain",e)for(var n in e.m)e.m.hasOwnProperty(n)&&(t[n]=e.m[n])},Dc.prototype.sa=function(t,e){t=yc[t];return this.na+"/v1/"+e+":"+t},n(Lc,rc=Dc),Lc.prototype.ra=function(o,e,s,u){return new Promise(function(n,r){var i=new Ir;i.listenOnce(mr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case gr.NO_ERROR:var t=i.getResponseJson();_r("Connection","XHR received:",JSON.stringify(t)),n(t);break;case gr.TIMEOUT:_r("Connection",'RPC "'+o+'" timed out'),r(new Gr(Fr.DEADLINE_EXCEEDED,"Request time out"));break;case gr.HTTP_ERROR:var e=i.getStatus();_r("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Fr).indexOf(e)?e:Fr.UNKNOWN,r(new Gr(e,t.message))):r(new Gr(Fr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Gr(Fr.UNAVAILABLE,"Connection failed."));break;default:jr()}}finally{_r("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Lc.prototype.Ir=function(t,e){var n,r=[this.na,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new lr,o=yr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.ia(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");_r("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,h=new vc({Gc:function(t){a?_r("Connection","Not sending because WebChannel is closed:",t):(u||(_r("Connection","Opening WebChannel transport."),s.open(),u=!0),_r("Connection","WebChannel sending:",t),s.send(t))},Kc:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Tr.EventType.OPEN,function(){a||_r("Connection","WebChannel transport opened.")}),t(s,Tr.EventType.CLOSE,function(){a||(a=!0,_r("Connection","WebChannel transport closed"),h.Xc())}),t(s,Tr.EventType.ERROR,function(t){a||(a=!0,Cr("Connection","WebChannel transport errored:",t),h.Xc(new Gr(Fr.UNAVAILABLE,"The operation could not be completed")))}),t(s,Tr.EventType.MESSAGE,function(t){var e,n,r,i;a||(xr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(_r("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Oi[r];if(void 0!==t)return Di(t)}(),i=n.message,void 0===t&&(t=Fr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,h.Xc(new Gr(t,i)),s.close()):(_r("Connection","WebChannel received:",e),h.Zc(e)))}),t(o,wr.STAT_EVENT,function(t){t.stat===br?_r("Connection","Detected buffering proxy"):t.stat===Er&&_r("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Jc()},0),h},Lc),mc=(kc.prototype.Xr=function(t){this.ha.push(t)},kc.prototype.Zo=function(){window.removeEventListener("online",this.oa),window.removeEventListener("offline",this.ca)},kc.prototype.la=function(){window.addEventListener("online",this.oa),window.addEventListener("offline",this.ca)},kc.prototype.ua=function(){_r("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(0)},kc.prototype.aa=function(){_r("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(1)},kc._a=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},kc),wc=(Rc.prototype.Xr=function(t){},Rc.prototype.Zo=function(){},Rc),bc=(Oc.prototype.initialize=function(e){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.serializer=la(e.ta.t),this.Ru=this.fa(e),this.persistence=this.da(e),[4,this.persistence.start()];case 1:return t.sent(),this.wa=this.Ea(e),this.jr=this.ma(e),[2]}})})},Oc.prototype.Ea=function(t){return null},Oc.prototype.ma=function(t){return e=this.persistence,n=new sc,r=t.Ta,t=this.serializer,new Pa(e,n,r,t);var e,n,r},Oc.prototype.da=function(t){return new fc(dc.Qc,this.serializer)},Oc.prototype.fa=function(t){return new Dh},Oc.prototype.terminate=function(){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wa&&this.wa.stop(),[4,this.Ru.Zo()];case 1:return t.sent(),[4,this.persistence.Zo()];case 2:return t.sent(),[2]}})})},Oc),Ec=(Nc.prototype.initialize=function(n,r){return v(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.jr?[3,2]:(this.jr=n.jr,this.Ru=n.Ru,this.Wr=this.Aa(r),this.Au=this.Ia(r),this.Iu=this.Ra(r),this.Pa=this.ya(r,!n.synchronizeTabs),this.Ru.Or=function(t){return Xh(e.Pa,t,1)},this.Au.Gr.Va=nc.bind(null,this.Pa),[4,function(n,r){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=n,r?(e.Hr.delete(2),[4,rh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Hr.add(2),[4,ih(e)]);case 3:t.sent(),e.Zr.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Au,this.Pa.Fu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Nc.prototype.Ra=function(t){return new Eh},Nc.prototype.Aa=function(t){var e=la(t.ta.t),n=(n=t.ta,new gc(n));return t=t.credentials,new Qa(t,n,e)},Nc.prototype.Ia=function(t){var e=this,n=this.jr,r=this.Wr,i=t.Ns,o=function(t){return Xh(e.Pa,t,0)},t=new(mc._a()?mc:wc);return new Wa(n,r,i,o,t)},Nc.prototype.ya=function(t,e){return function(t,e,n,r,i,o,s){o=new Uh(t,e,n,r,i,o);return s&&(o.xu=!0),o}(this.jr,this.Au,this.Iu,this.Ru,t.Ta,t.Pu,e)},Nc.prototype.terminate=function(){return function(n){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=n,_r("RemoteStore","RemoteStore shutting down."),e.Hr.add(5),[4,ih(e)];case 1:return t.sent(),e.Jr.Zo(),e.Zr.set("Unknown"),[2]}})})}(this.Au)},Nc),Tc=(Ac.prototype.next=function(t){this.observer.next&&this.pa(this.observer.next,t)},Ac.prototype.error=function(t){this.observer.error?this.pa(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Ac.prototype.ga=function(){this.muted=!0},Ac.prototype.pa=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Ac),Ic=function(t){this.va=t};function Ac(t){this.observer=t,this.muted=!1}function Nc(){}function Oc(){this.synchronizeTabs=!1}function Rc(){}function kc(){var t=this;this.oa=function(){return t.ua()},this.ca=function(){return t.aa()},this.ha=[],this.la()}function Lc(t){var e=this;return(e=rc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function Dc(t){this.ta=t,this.t=t.t;var e=t.ssl?"https":"http";this.na=e+"://"+t.host,this.ea="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function Sc(t){this.Gc=t.Gc,this.Kc=t.Kc}function Pc(t){this.persistence=t,this.qc=new Rh,this.Bc=null}function _c(t){var e=this;return(e=ic.call(this)||this).Bi=t,e}function Vc(){this.Mc=[]}function Cc(t,e){var n=this;this.bc={},this.Cc=new va(0),this.Sc=!1,this.Sc=!0,this.Wi=t(this),this.Ri=new cc(this),this.We=new La,this.Qe=(t=this.We,new ac(t,function(t){return n.Wi.Dc(t)})),this.serializer=new ka(e),this.pi=new lc(this.serializer)}function Uc(t){this.serializer=t,this.Rc=new Map,this.Pc=new Map}function jc(t){this.persistence=t,this.lc=new ia(bi,Ei),this.lastRemoteSnapshotVersion=oi.min(),this.highestTargetId=0,this._c=0,this.fc=new Rh,this.targetCount=0,this.dc=Sa._i()}function xc(t){var e=this;return(e=oc.call(this)||this).hc=t,e}function Mc(){this.Uu=new ia(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.rc=!1}function qc(t,e){this.We=t,this.nc=e,this.docs=new Si(hi.k),this.size=0}function Fc(t,e){this.We=t,this.Wi=e,this.je=[],this.Gu=1,this.Ku=new xi(kh.yo)}function Gc(){}function Bc(t,e,n){if(!n)throw new Gr(Fr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Wc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function zc(t,e,n,r){if(!0===e&&!0===r)throw new Gr(Fr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Hc(t){if(!hi.ot(t))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Xc(t){if(hi.ot(t))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Yc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":jr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Kc(t,e){if(t instanceof Ic&&(t=t.va),t instanceof e)return t;if(e.name===t.constructor.name)throw new Gr(Fr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=Yc(t);throw new Gr(Fr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Qc(t,e){if(e<=0)throw new Gr(Fr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Jc,$c=function(t){this.ba=t},Zc=(n(tl,Jc=$c),tl.prototype.Ca=function(t){if(2!==t.Sa)throw 1===t.Sa?t.Da(this.ba+"() can only appear at the top level of your update data"):t.Da(this.ba+"() cannot be used with set() unless you pass {merge:true}");return t.ee.push(t.path),null},tl.prototype.isEqual=function(t){return t instanceof tl},tl);function tl(){return null!==Jc&&Jc.apply(this,arguments)||this}function el(t,e,n){return new Yf({Sa:3,Na:e.settings.Na,methodName:t.ba,xa:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var nl,rl,il,ol,sl=(n(Tl,ol=$c),Tl.prototype.Ca=function(t){return new As(t.path,new cs)},Tl.prototype.isEqual=function(t){return t instanceof Tl},Tl),ul=(n(El,il=$c),El.prototype.Ca=function(t){var e=el(this,t,!0),n=this.Fa.map(function(t){return np(t,e)}),n=new ls(n);return new As(t.path,n)},El.prototype.isEqual=function(t){return this===t},El),al=(n(bl,rl=$c),bl.prototype.Ca=function(t){var e=el(this,t,!0),n=this.Fa.map(function(t){return np(t,e)}),n=new ys(n);return new As(t.path,n)},bl.prototype.isEqual=function(t){return this===t},bl),hl=(n(wl,nl=$c),wl.prototype.Ca=function(t){var e=new bs(t.serializer,qo(t.serializer,this.Oa));return new As(t.path,e)},wl.prototype.isEqual=function(t){return this===t},wl),cl=(Object.defineProperty(ml.prototype,"latitude",{get:function(){return this.La},enumerable:!1,configurable:!0}),Object.defineProperty(ml.prototype,"longitude",{get:function(){return this.$a},enumerable:!1,configurable:!0}),ml.prototype.isEqual=function(t){return this.La===t.La&&this.$a===t.$a},ml.prototype.toJSON=function(){return{latitude:this.La,longitude:this.$a}},ml.prototype.D=function(t){return ti(this.La,t.La)||ti(this.$a,t.$a)},ml),ll=(gl.fromBase64String=function(t){try{return new gl(Ii.fromBase64String(t))}catch(t){throw new Gr(Fr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},gl.fromUint8Array=function(t){return new gl(Ii.fromUint8Array(t))},gl.prototype.toBase64=function(){return this.ka.toBase64()},gl.prototype.toUint8Array=function(){return this.ka.toUint8Array()},gl.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},gl.prototype.isEqual=function(t){return this.ka.isEqual(t.ka)},gl),fl=new Map,pl=(yl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},yl),dl=(Object.defineProperty(vl.prototype,"app",{get:function(){if(!this.ja)throw new Gr(Fr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ja},enumerable:!1,configurable:!0}),Object.defineProperty(vl.prototype,"Wa",{get:function(){return this.qa},enumerable:!1,configurable:!0}),Object.defineProperty(vl.prototype,"Ga",{get:function(){return void 0!==this.Ka},enumerable:!1,configurable:!0}),vl.prototype.za=function(t){if(this.qa)throw new Gr(Fr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.Ua=new pl(t),void 0!==t.credentials&&(this.Qa=function(t){if(!t)return new Br;switch(t.type){case"gapi":var e=t.client;return xr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Hr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Gr(Fr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},vl.prototype.Ha=function(){return this.Ua},vl.prototype.Ya=function(){return this.qa=!0,this.Ua},vl.prototype._delete=function(){return this.Ka||(this.Ka=this.Ja()),this.Ka},vl.prototype.Ja=function(){return t=this,(e=fl.get(t))&&(_r("ComponentProvider","Removing Datastore"),fl.delete(t),e.terminate()),Promise.resolve();var t,e},vl);function vl(t,e){this.Ma="(lite)",this.Ua=new pl({}),this.qa=!1,t instanceof Rr?(this.Ba=t,this.Qa=new Br):(this.ja=t,this.Ba=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Gr(Fr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rr(t.options.projectId)}(t),this.Qa=new Wr(e))}function yl(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Gr(Fr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Gr(Fr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,zc("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function gl(t){this.ka=t}function ml(t,e){if(!isFinite(t)||t<-90||90<t)throw new Gr(Fr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Gr(Fr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.La=t,this.$a=e}function wl(t,e){var n=this;return(n=nl.call(this,t)||this).Oa=e,n}function bl(t,e){var n=this;return(n=rl.call(this,t)||this).Fa=e,n}function El(t,e){var n=this;return(n=il.call(this,t)||this).Fa=e,n}function Tl(){return null!==ol&&ol.apply(this,arguments)||this}function Il(){if("undefined"==typeof Uint8Array)throw new Gr(Fr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Al(){if("undefined"==typeof atob)throw new Gr(Fr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Nl,Ol,Rl,kl=(n(Ul,Rl=Ic),Ul.fromBase64String=function(t){return Al(),new Ul(ll.fromBase64String(t))},Ul.fromUint8Array=function(t){return Il(),new Ul(ll.fromUint8Array(t))},Ul.prototype.toBase64=function(){return Al(),this.va.toBase64()},Ul.prototype.toUint8Array=function(){return Il(),this.va.toUint8Array()},Ul.prototype.isEqual=function(t){return this.va.isEqual(t.va)},Ul.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Ul),Ie=(Cl.prototype.Xa=function(t,e){switch(void 0===e&&(e="none"),bo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ro(t.integerValue||t.doubleValue);case 3:return this.Za(t.timestampValue);case 4:return this.th(t,e);case 5:return t.stringValue;case 6:return this.nh(ko(t.bytesValue));case 7:return this.eh(t.referenceValue);case 8:return this.sh(t.geoPointValue);case 9:return this.ih(t.arrayValue,e);case 10:return this.rh(t.mapValue,e);default:throw jr()}},Cl.prototype.rh=function(t,n){var r=this,i={};return vo(t.fields||{},function(t,e){i[t]=r.Xa(e,n)}),i},Cl.prototype.sh=function(t){return new cl(Ro(t.latitude),Ro(t.longitude))},Cl.prototype.ih=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Xa(t,e)})},Cl.prototype.th=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return go(e)?t(e):e}(t);return null==n?null:this.Xa(n,e);case"estimate":return this.Za(mo(t));default:return null}},Cl.prototype.Za=function(t){t=Oo(t);return new ii(t.seconds,t.nanos)},Cl.prototype.oh=function(t,e){var n=si.J(t);xr(ss(n));t=new Rr(n.get(1),n.get(3)),n=new hi(n.U(5));return t.isEqual(e)||Vr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},Cl),Ll=(n(Vl,Ol=Ie),Vl.prototype.nh=function(t){return new kl(new ll(t))},Vl.prototype.eh=function(t){t=this.oh(t,this.firestore.Ba);return Hp.uh(t,this.firestore,null)},Vl),Dl=(Object.defineProperty(_l.prototype,"id",{get:function(){return this.lh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(_l.prototype,"ref",{get:function(){return new sf(this.ah,this.fh,this.lh)},enumerable:!1,configurable:!0}),_l.prototype.exists=function(){return null!==this._h},_l.prototype.data=function(){if(this._h){if(this.fh){var t=new Sl(this.ah,this.hh,this.lh,this._h,null);return this.fh.fromFirestore(t)}return this.hh.Xa(this._h.Ee())}},_l.prototype.get=function(t){if(this._h){t=this._h.data().field(jl("DocumentSnapshot.get",t));if(null!==t)return this.hh.Xa(t)}},_l),Sl=(n(Pl,Nl=Dl),Pl.prototype.data=function(){return Nl.prototype.data.call(this)},Pl);function Pl(){return null!==Nl&&Nl.apply(this,arguments)||this}function _l(t,e,n,r,i){this.ah=t,this.hh=e,this.lh=n,this._h=r,this.fh=i}function Vl(t){var e=this;return(e=Ol.call(this)||this).firestore=t,e}function Cl(){}function Ul(){return null!==Rl&&Rl.apply(this,arguments)||this}function jl(t,e){return"string"==typeof e?ap(t,e):(e instanceof Ic?e.va:e).dh}var xl,Ml=(Gl.prototype.isEqual=function(t){return this.dh.isEqual(t.dh)},Gl),ql=(n(Fl,xl=dl),Fl.prototype.Ja=function(){return this.Eh||qp(this),this.Eh.terminate()},Fl);function Fl(t,e){var n=this;return(n=xl.call(this,t,e)||this).wh=new Aa,n.Ma="name"in t?t.name:"[DEFAULT]",n}function Gl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.dh=new ai(t)}var Bl,Wl,zl=(n(Ql,Wl=Dl),Ql.prototype.exists=function(){return Wl.prototype.exists.call(this)},Ql.prototype.data=function(t){if(void 0===t&&(t={}),this._h){if(this.fh){var e=new Hl(this.ah,this.hh,this.lh,this._h,this.metadata,null);return this.fh.fromFirestore(e,t)}return this.hh.Xa(this._h.Ee(),t.serverTimestamps)}},Ql.prototype.get=function(t,e){if(void 0===e&&(e={}),this._h){t=this._h.data().field(jl("DocumentSnapshot.get",t));if(null!==t)return this.hh.Xa(t,e.serverTimestamps)}},Ql),Hl=(n(Kl,Bl=zl),Kl.prototype.data=function(t){return void 0===t&&(t={}),Bl.prototype.data.call(this,t)},Kl),Xl=(Object.defineProperty(Yl.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"size",{get:function(){return this.Th.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Yl.prototype.forEach=function(e,n){var r=this;this.Th.docs.forEach(function(t){e.call(n,new Hl(r.ah,r.hh,t.key,t,new od(r.Th.nn.has(t.key),r.Th.fromCache),r.query.fh))})},Yl.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.Th.sn)throw new Gr(Fr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ah&&this.Ih===t||(this.Ah=function(i,e){if(i.Th.tn.W()){var n=0;return i.Th.docChanges.map(function(t){var e=new Hl(i.ah,i.hh,t.doc.key,t.doc,new od(i.Th.nn.has(t.doc.key),i.Th.fromCache),i.query.fh);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Th.tn;return i.Th.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Hl(i.ah,i.hh,t.doc.key,t.doc,new od(i.Th.nn.has(t.doc.key),i.Th.fromCache),i.query.fh),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return jr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Ih=t),this.Ah},Yl);function Yl(t,e,n,r){this.ah=t,this.hh=e,this.Th=r,this.metadata=new od(r.hasPendingWrites,r.fromCache),this.query=n}function Kl(){return null!==Bl&&Bl.apply(this,arguments)||this}function Ql(t,e,n,r,i,o){var s=this;return(s=Wl.call(this,t,e,n,r,o)||this).ah=t,s.mh=t,s.metadata=i,s}function Jl(t,e){return t instanceof zl&&e instanceof zl?t.ah===e.ah&&t.lh.isEqual(e.lh)&&(null===t._h?null===e._h:t._h.isEqual(e._h))&&t.fh===e.fh:t instanceof Xl&&e instanceof Xl&&t.ah===e.ah&&qf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Th.isEqual(e.Th)}var $l,Zl=(n(tf,$l=Ie),tf.prototype.nh=function(t){return new ll(t)},tf.prototype.eh=function(t){t=this.oh(t,this.firestore.Ba);return new sf(this.firestore,null,t)},tf);function tf(t){var e=this;return(e=$l.call(this)||this).firestore=t,e}function ef(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Kc(t.firestore,ql),s=Ff(o);return e instanceof Ic&&(e=e.va),rf(o,("string"==typeof e||e instanceof Ml?tp(s,"updateDoc",t.lh,e,n,r):Zf(s,"updateDoc",t.lh,e)).Ph(t.lh,ks.exists(!0)))}function nf(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||fa(n[o])||(i=n[o],o++);var s,u,a,h,c,l={includeMetadataChanges:i.includeMetadataChanges};fa(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof sf?(s=Kc(e.firestore,ql),u=fu(e.lh.path),c={next:function(t){n[o]&&n[o](of(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=Kc(e.firestore,ql),u=e.Rh,h=new Zl(s),c={next:function(t){n[o]&&n[o](new Xl(s,h,e,t))},error:n[o+1],complete:n[o+2]},Df(e.Rh));var f=Mp(s),p=new Tc(c),d=new Oh(u,p,l);return s.wh.Ms(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=Ih,[4,Ip(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.ga(),s.wh.Ms(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=Ah,[4,Ip(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}function rf(t,e){return function(n,r){var t=this,i=new sa;return n.Ns.Ms(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=zh,[4,Tp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Mp(t),e)}function of(t,e,n){var r=n.docs.get(e.lh),i=new Zl(t);return new zl(t,i,e.lh,r,new od(n.hasPendingWrites,n.fromCache),e.fh)}var sf=(Object.defineProperty(hf.prototype,"yh",{get:function(){return this.lh.path},enumerable:!1,configurable:!0}),Object.defineProperty(hf.prototype,"id",{get:function(){return this.lh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(hf.prototype,"path",{get:function(){return this.lh.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(hf.prototype,"parent",{get:function(){return new Pf(this.firestore,this.fh,this.lh.path.q())},enumerable:!1,configurable:!0}),hf.prototype.withConverter=function(t){return new hf(this.firestore,t,this.lh)},hf),uf=(af.prototype.withConverter=function(t){return new af(this.firestore,t,this.Rh)},af),l=function(){};function af(t,e,n){this.fh=e,this.Rh=n,this.type="query",this.firestore=t}function hf(t,e,n){this.fh=e,this.lh=n,this.type="document",this.firestore=t}function cf(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].Vh(t)}return t}var lf,ff,pf,df,vf,yf=(n(Nf,vf=l),Nf.prototype.Vh=function(t){var e=Ff(t.firestore),e=function(t,e,n,r,i,o){if(r.tt()){if("array-contains"===i||"array-contains-any"===i)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){kf(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(Rf(n,t,h))}c={arrayValue:{values:s}}}else c=Rf(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||kf(o,i),c=ep(e,"where",o,"in"===i||"not-in"===i);var c=Ru.create(r,i,c);return function(t,e){if(e.Ie()){var n=yu(t);if(null!==n&&!n.isEqual(e.field))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=vu(t);null!==n&&Lf(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Gr(Fr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Gr(Fr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(t.Rh,e,t.firestore.Ba,this.ph,this.gh,this.bh);return new uf(t.firestore,t.fh,(t=t.Rh,e=t.filters.concat([e]),new au(t.path,t.collectionGroup,t.me.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Nf),gf=(n(Af,df=l),Af.prototype.Vh=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ea(e,n);return e=r,null!==vu(n=t)||null!==(t=yu(n))&&Lf(0,t,e.field),r}(t.Rh,this.ph,this.Ch);return new uf(t.firestore,t.fh,(t=t.Rh,e=t.me.concat([e]),new au(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},Af),mf=(n(If,pf=l),If.prototype.Vh=function(t){return new uf(t.firestore,t.fh,bu(t.Rh,this.Sh,this.Dh))},If),wf=(n(Tf,ff=l),Tf.prototype.Vh=function(t){var e=Of(t,this.type,this.Nh,this.xh);return new uf(t.firestore,t.fh,(t=t.Rh,e=e,new au(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Tf),bf=(n(Ef,lf=l),Ef.prototype.Vh=function(t){var e=Of(t,this.type,this.Nh,this.xh);return new uf(t.firestore,t.fh,(t=t.Rh,e=e,new au(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},Ef);function Ef(t,e,n){var r=this;return(r=lf.call(this)||this).type=t,r.Nh=e,r.xh=n,r}function Tf(t,e,n){var r=this;return(r=ff.call(this)||this).type=t,r.Nh=e,r.xh=n,r}function If(t,e,n){var r=this;return(r=pf.call(this)||this).type=t,r.Sh=e,r.Dh=n,r}function Af(t,e){var n=this;return(n=df.call(this)||this).ph=t,n.Ch=e,n.type="orderBy",n}function Nf(t,e,n){var r=this;return(r=vf.call(this)||this).ph=t,r.gh=e,r.bh=n,r.type="where",r}function Of(t,h,e,n){if(e[0]instanceof Ic&&(e[0]=e[0].va),e[0]instanceof Dl)return function(t,e,n,r){if(!n)throw new Gr(Fr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=mu(t);o<s.length;o++){var u=s[o];if(u.field.tt())i.push(Lo(e,n.key));else{var a=n.field(u.field);if(go(a))throw new Gr(Fr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.Y();throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Xu(i,r)}(t.Rh,t.firestore.Ba,e[0]._h,n);var r=Ff(t.firestore);return function(t,e,n,r,i,o){var s=t.me;if(i.length>s.length)throw new Gr(Fr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.tt()){if("string"!=typeof h)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!gu(t)&&-1!==h.indexOf("/"))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(si.J(h));if(!hi.ot(c))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new hi(c);u.push(Lo(e,c))}else{h=ep(n,r,h);u.push(h)}}return new Xu(u,o)}(t.Rh,t.firestore.Ba,r,h,e,n)}function Rf(t,e,n){if(n instanceof Ic&&(n=n.va),"string"==typeof n){if(""===n)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!gu(e)&&-1!==n.indexOf("/"))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(si.J(n));if(!hi.ot(e))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Lo(t,new hi(e))}if(n instanceof sf)return Lo(t,n.lh);throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Yc(n)+".")}function kf(t,e){if(!Array.isArray(t)||0===t.length)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Lf(t,e,n){if(!n.isEqual(e))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Df(t){if(du(t)&&0===t.me.length)throw new Gr(Fr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Sf,Pf=(n(_f,Sf=uf),Object.defineProperty(_f.prototype,"id",{get:function(){return this.Rh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(_f.prototype,"path",{get:function(){return this.Rh.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(_f.prototype,"parent",{get:function(){var t=this.yh.q();return t.W()?null:new sf(this.firestore,null,new hi(t))},enumerable:!1,configurable:!0}),_f.prototype.withConverter=function(t){return new _f(this.firestore,t,this.yh)},_f);function _f(t,e,n){var r=this;return(r=Sf.call(this,t,e,fu(n))||this).firestore=t,r.yh=n,r.type="collection",r}function Vf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(Bc("collection","path",e),t instanceof dl){var i=si.J.apply(si,s([e],n));return Xc(i),new Pf(t,null,i)}if(!(t instanceof sf||t instanceof Pf))throw new Gr(Fr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=si.J.apply(si,s([t.path],n)).child(si.J(e));return Xc(e),new Pf(t.firestore,null,e)}function Cf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=$r.S()),Bc("doc","path",e),t instanceof dl){var i=si.J.apply(si,s([e],n));return Hc(i),new sf(t,null,new hi(i))}if(!(t instanceof sf||t instanceof Pf))throw new Gr(Fr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=t.yh.child(si.J.apply(si,s([e],n)));return Hc(e),new sf(t.firestore,t instanceof Pf?t.fh:null,new hi(e))}var Uf,jf=(n(xf,Uf=Ie),xf.prototype.nh=function(t){return new ll(t)},xf.prototype.eh=function(t){t=this.oh(t,this.firestore.Ba);return new sf(this.firestore,null,t)},xf);function xf(t){var e=this;return(e=Uf.call(this)||this).firestore=t,e}function Mf(t,e){return(t instanceof sf||t instanceof Pf)&&(e instanceof sf||e instanceof Pf)&&t.firestore===e.firestore&&t.path===e.path&&t.fh===e.fh}function qf(t,e){return t instanceof uf&&e instanceof uf&&t.firestore===e.firestore&&Eu(t.Rh,e.Rh)&&t.fh===e.fh}function Ff(t){var e=t.Ya(),n=la(t.Ba);return new Kf(t.Ba,!!e.ignoreUndefinedProperties,n)}var Gf=/^__.*__$/,Bf=(Hf.prototype.Ph=function(t,e){var n=[];return null!==this.ee?n.push(new xs(t,this.data,this.ee,e)):n.push(new js(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Bs(t,this.fieldTransforms)),n},Hf),Wf=(zf.prototype.Ph=function(t,e){e=[new xs(t,this.data,this.ee,e)];return 0<this.fieldTransforms.length&&e.push(new Bs(t,this.fieldTransforms)),e},zf);function zf(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function Hf(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function Xf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw jr()}}var Yf=(Object.defineProperty(Jf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Jf.prototype,"Sa",{get:function(){return this.settings.Sa},enumerable:!1,configurable:!0}),Jf.prototype.Oh=function(t){return new Jf(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.ee)},Jf.prototype.Lh=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.Oh({path:e,xa:!1});return e.$h(t),e},Jf.prototype.kh=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.Oh({path:t,xa:!1});return t.Fh(),t},Jf.prototype.Mh=function(t){return this.Oh({path:void 0,xa:!0})},Jf.prototype.Da=function(t){return hp(t,this.settings.methodName,this.settings.Uh||!1,this.path,this.settings.Na)},Jf.prototype.contains=function(e){return void 0!==this.ee.find(function(t){return e.G(t)})||void 0!==this.fieldTransforms.find(function(t){return e.G(t.field)})},Jf.prototype.Fh=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$h(this.path.get(t))},Jf.prototype.$h=function(t){if(0===t.length)throw this.Da("Document fields must not be empty");if(Xf(this.Sa)&&Gf.test(t))throw this.Da('Document fields cannot begin and end with "__"')},Jf),Kf=(Qf.prototype.qh=function(t,e,n,r){return void 0===r&&(r=!1),new Yf({Sa:t,methodName:e,Na:n,path:ai.X(),xa:!1,Uh:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Qf);function Qf(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||la(t)}function Jf(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Fh(),this.fieldTransforms=i||[],this.ee=o||[]}function $f(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qh(o.merge||o.mergeFields?2:0,e,n,i);op("Data must be an object, but it was:",s,r);var u,a,r=rp(r,s);if(o.merge)u=new Ns(s.ee),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=sp(e,l[c],n);if(!s.contains(f))throw new Gr(Fr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");cp(h,f)||h.push(f)}u=new Ns(h),a=s.fieldTransforms.filter(function(t){return u.ue(t.field)})}else u=null,a=s.fieldTransforms;return new Bf(new Qs(r),u,a)}function Zf(t,r,i,e){var o=t.qh(1,r,i);op("Data must be an object, but it was:",o,e);var s=[],u=new Js;vo(e,function(t,e){var n=ap(r,t,i);e instanceof Ic&&(e=e.va);t=o.kh(n);e instanceof Zc?s.push(n):null!=(t=np(e,t))&&(s.push(n),u.set(n,t))});e=new Ns(s);return new Wf(u.he(),e,o.fieldTransforms)}function tp(t,e,n,r,i,o){var s=t.qh(1,e,n),u=[sp(e,r,n)],a=[i];if(o.length%2!=0)throw new Gr(Fr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(sp(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new Js,v=u.length-1;0<=v;--v){cp(p,u[v])||(c=u[v],(l=a[v])instanceof Ic&&(l=l.va),f=s.kh(c),l instanceof Zc?p.push(c):null!=(f=np(l,f))&&(p.push(c),d.set(c,f)))}i=new Ns(p);return new Wf(d.he(),i,s.fieldTransforms)}function ep(t,e,n,r){return void 0===r&&(r=!1),np(n,t.qh(r?4:3,e))}function np(s,t){if(s instanceof Ic&&(s=s.va),ip(s))return op("Unsupported field value:",t,s),rp(s,t);if(s instanceof $c)return function(t,e){if(!Xf(e.Sa))throw e.Da(t.ba+"() can only be used with update() and set()");if(!e.path)throw e.Da(t.ba+"() is not currently supported inside arrays");t=t.Ca(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.ee.push(t.path),s instanceof Array){if(t.settings.xa&&4!==t.Sa)throw t.Da("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=np(i[r],t.Mh(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Ic&&(t=t.va),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return qo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ii.fromDate(t);return{timestampValue:Fo(e.serializer,n)}}if(t instanceof ii){var r=new ii(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Fo(e.serializer,r)}}if(t instanceof cl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ll)return{bytesValue:Go(e.serializer,t.ka)};if(t instanceof sf){n=e.t,r=t.firestore.Ba;if(!r.isEqual(n))throw e.Da("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Wo(t.firestore.Ba||e.t,t.lh.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Da("Unsupported field value: "+Yc(t))}(s,t)}function rp(t,n){var r={};return yo(t)?n.path&&0<n.path.length&&n.ee.push(n.path):vo(t,function(t,e){e=np(e,n.Lh(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function ip(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ii||t instanceof cl||t instanceof ll||t instanceof sf||t instanceof $c)}function op(t,e,n){if(!ip(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=Yc(n);throw"an object"===n?e.Da(t+" a custom object"):e.Da(t+" "+n)}var r}function sp(t,e,n){if(e instanceof Ic&&(e=e.va),e instanceof Ml)return e.dh;if("string"==typeof e)return ap(t,e);throw hp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var up=new RegExp("[~\\*/\\[\\]]");function ap(e,n,r){if(0<=n.search(up))throw hp("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Ml.bind.apply(Ml,s([void 0],n.split("."))))).dh}catch(t){throw hp("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function hp(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Gr(Fr.INVALID_ARGUMENT,(e+=". ")+t+n)}function cp(t,e){return t.some(function(t){return t.isEqual(e)})}var lp=(yp.prototype.Gh=function(r){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Kh(),0<this.mutations.length)throw new Gr(Fr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return v(this,void 0,void 0,function(){var n,e,r,i,o;return y(this,function(t){switch(t.label){case 0:return e=Ko((n=s).serializer)+"/documents",r={documents:u.map(function(t){return Ho(n.serializer,t)})},[4,n.Fr("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){xr(!!e.found),e.found.name,e.found.updateTime;var n=Xo(t,e.found.name),t=Bo(e.found.updateTime),e=new Qs({mapValue:{fields:e.found.fields}});return new ou(n,t,e,{})}(e,t):"missing"in t?function(t,e){xr(!!e.missing),xr(!!e.readTime);t=Xo(t,e.missing),e=Bo(e.readTime);return new su(t,e)}(e,t):jr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());xr(!!t),o.push(t)}),o)]}})})}(this.Wr,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof su||t instanceof ou?n.zh(t):jr()}),e)]}})})},yp.prototype.set=function(t,e){this.write(e.Ph(t,this.re(t))),this.Wh.add(t.toString())},yp.prototype.update=function(t,e){try{this.write(e.Ph(t,this.Hh(t)))}catch(t){this.jh=t}this.Wh.add(t.toString())},yp.prototype.delete=function(t){this.write([new Ys(t,this.re(t))]),this.Wh.add(t.toString())},yp.prototype.commit=function(){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Kh(),this.jh)throw this.jh;return e=this.Bh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=hi.st(e);n.mutations.push(new Ks(e,n.re(e)))}),[4,function(i,o){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return n=Ko((e=i).serializer)+"/documents",r={writes:o.map(function(t){return $o(e.serializer,t)})},[4,e.Nr("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Wr,this.mutations)];case 1:return t.sent(),this.Qh=!0,[2]}})})},yp.prototype.zh=function(t){var e;if(t instanceof ou)e=t.version;else{if(!(t instanceof su))throw jr();e=oi.min()}var n=this.Bh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Gr(Fr.ABORTED,"Document version changed between two reads.")}else this.Bh.set(t.key.toString(),e)},yp.prototype.re=function(t){var e=this.Bh.get(t.toString());return!this.Wh.has(t.toString())&&e?ks.updateTime(e):ks.ce()},yp.prototype.Hh=function(t){var e=this.Bh.get(t.toString());if(this.Wh.has(t.toString())||!e)return ks.exists(!0);if(e.isEqual(oi.min()))throw new Gr(Fr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ks.updateTime(e)},yp.prototype.write=function(t){this.Kh(),this.mutations=this.mutations.concat(t)},yp.prototype.Kh=function(){},yp),fp=(vp.prototype.run=function(){this.Jh()},vp.prototype.Jh=function(){var t=this;this.Ks.vs(function(){return v(t,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){return e=new lp(this.Wr),(n=this.Xh(e))&&n.then(function(t){r.Ns.Ms(function(){return e.commit().then(function(){r.Os.resolve(t)}).catch(function(t){r.Zh(t)})})}).catch(function(t){r.Zh(t)}),[2]})})})},vp.prototype.Xh=function(t){try{var e=this.updateFunction(t);return!yi(e)&&e.catch&&e.then?e:(this.Os.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Os.reject(t),null}},vp.prototype.Zh=function(t){var e=this;0<this.Yh&&this.tl(t)?(--this.Yh,this.Ns.Ms(function(){return e.Jh(),Promise.resolve()})):this.Os.reject(t)},vp.prototype.tl=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Li(t)},vp),pp=(dp.prototype.getConfiguration=function(){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.V.promise];case 1:return[2,(t.sent(),{Ns:this.Ns,ta:this.ta,clientId:this.clientId,credentials:this.credentials,Ta:this.user,Pu:100})]}})})},dp.prototype.el=function(t){var e=this;this.nl=t,this.V.promise.then(function(){return e.nl(e.user)})},dp.prototype.sl=function(){if(this.Ns.Hs)throw new Gr(Fr.FAILED_PRECONDITION,"The client has already been terminated.")},dp.prototype.terminate=function(){var t=this;this.Ns.Zs();var n=new sa;return this.Ns.Ys(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.il?[4,this.il.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.rl?[4,this.rl.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.R(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Ra(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},dp);function dp(t,e,n){var r=this;this.credentials=t,this.Ns=e,this.ta=n,this.user=kr.UNAUTHENTICATED,this.clientId=$r.S(),this.nl=function(){},this.V=new sa,this.credentials.I(function(t){_r("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.nl(t)),r.V.resolve()})}function vp(t,e,n,r){this.Ns=t,this.Wr=e,this.updateFunction=n,this.Os=r,this.Yh=5,this.Ks=new wa(this.Ns,"transaction_retry")}function yp(t){this.Wr=t,this.Bh=new Map,this.mutations=[],this.Qh=!1,this.jh=null,this.Wh=new Set}function gp(e){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e.rl?[3,2]:(_r("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return r.Ns.si(),_r("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.el(function(e){return r.Ns.ti(function(){return v(n,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,ja(i.jr,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.xc(function(){return r.terminate()}),r.rl=i,[2]}})})}(e,new bc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.rl]}})})}function mp(e){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e.il?[3,2]:(_r("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return r.Ns.si(),[4,gp(r)];case 1:return e=t.sent(),_r("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.el(function(t){return r.Ns.ti(function(){return function(r,i){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return(e=r).Ns.si(),_r("RemoteStore","RemoteStore received new credentials"),n=lh(e),e.Hr.add(3),[4,ih(e)];case 1:return t.sent(),n&&e.Zr.set("Unknown"),[4,e.Gr.Va(i)];case 2:return t.sent(),e.Hr.delete(3),[4,rh(e)];case 3:return t.sent(),[2]}})})}(i.Au,t)})}),r.il=i,[2]}})})}(e,new Ec)]);case 1:t.sent(),t.label=2;case 2:return[2,e.il]}})})}function wp(t){return gp(t).then(function(t){return t.persistence})}function bp(t){return gp(t).then(function(t){return t.jr})}function Ep(t){return mp(t).then(function(t){return t.Au})}function Tp(t){return mp(t).then(function(t){return t.Pa})}function Ip(r){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,mp(r)];case 1:return e=t.sent(),[2,((n=e.Iu).ho=Wh.bind(null,e.Pa),n.fo=function(i,o){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return n=(e=i).Vu.get(o),1<(r=e.pu.get(n.targetId)).length?[2,(e.pu.set(n.targetId,r.filter(function(t){return!Eu(t,o)})),void e.Vu.delete(o))]:e.Fu?(e.Ru.Go(n.targetId),e.Ru.Yo(n.targetId)?[3,2]:[4,Fa(e.jr,n.targetId,!1).then(function(){e.Ru.zo(n.targetId),sh(e.Au,n.targetId),Jh(e,n.targetId)}).catch(Ba)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Jh(e,n.targetId),[4,Fa(e.jr,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.Pa),n)]}})})}function Ap(n,r,i,o,s){var t=new Tc({next:function(t){r.Ms(function(){return Ah(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Gr(Fr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Gr(Fr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Oh(fu(i.path),t,{includeMetadataChanges:!0,Ro:!0});return Ih(n,u)}function Np(e,n,t,r,i){var o=new Tc({next:function(t){n.Ms(function(){return Ah(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Gr(Fr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Oh(t,o,{includeMetadataChanges:!0,Ro:!0});return Ih(e,s)}var Op=(Rp.prototype.set=function(t,e,n){this.hl();t=kp(t,this.ah),e=bd(t.fh,e,n),n=$f(this.al,"WriteBatch.set",t.lh,e,null!==t.fh,n);return this.ul=this.ul.concat(n.Ph(t.lh,ks.ce())),this},Rp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.hl();t=kp(t,this.ah);return e instanceof Ic&&(e=e.va),e="string"==typeof e||e instanceof Ml?tp(this.al,"WriteBatch.update",t.lh,e,n,r):Zf(this.al,"WriteBatch.update",t.lh,e),this.ul=this.ul.concat(e.Ph(t.lh,ks.exists(!0))),this},Rp.prototype.delete=function(t){this.hl();t=kp(t,this.ah);return this.ul=this.ul.concat(new Ys(t.lh,ks.ce())),this},Rp.prototype.commit=function(){return this.hl(),this.cl=!0,0<this.ul.length?this.ol(this.ul):Promise.resolve()},Rp.prototype.hl=function(){if(this.cl)throw new Gr(Fr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Rp);function Rp(t,e){this.ah=t,this.ol=e,this.ul=[],this.cl=!1,this.al=Ff(t)}function kp(t,e){if(t instanceof Ic&&(t=t.va),t.firestore!==e)throw new Gr(Fr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Lp,Dp,Sp=(xp.prototype.get=function(t){var e=this,n=kp(t,this.ah),r=new jf(this.ah);return this.ll.Gh([n.lh]).then(function(t){if(!t||1!==t.length)return jr();t=t[0];if(t instanceof su)return new Dl(e.ah,r,n.lh,null,n.fh);if(t instanceof ou)return new Dl(e.ah,r,t.key,t,n.fh);throw jr()})},xp.prototype.set=function(t,e,n){t=kp(t,this.ah),e=bd(t.fh,e,n),n=$f(this.al,"Transaction.set",t.lh,e,null!==t.fh,n);return this.ll.set(t.lh,n),this},xp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=kp(t,this.ah);return e instanceof Ic&&(e=e.va),e="string"==typeof e||e instanceof Ml?tp(this.al,"Transaction.update",t.lh,e,n,r):Zf(this.al,"Transaction.update",t.lh,e),this.ll.update(t.lh,e),this},xp.prototype.delete=function(t){t=kp(t,this.ah);return this.ll.delete(t.lh),this},n(jp,Dp=xp),jp.prototype.get=function(t){var e=this,n=kp(t,this.ah),r=new Zl(this.ah);return Dp.prototype.get.call(this,t).then(function(t){return new zl(e.ah,r,n.lh,t._h,new od(!1,!1),n.fh)})},jp),Pp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",_p=(Up.prototype.enableIndexedDbPersistence=function(t,e){throw new Gr(Fr.FAILED_PRECONDITION,Pp)},Up.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Gr(Fr.FAILED_PRECONDITION,Pp)},Up.prototype.clearIndexedDbPersistence=function(t){throw new Gr(Fr.FAILED_PRECONDITION,Pp)},Up),Vp=(n(Cp,Lp=Ic),Object.defineProperty(Cp.prototype,"Ba",{get:function(){return this.va.Ba},enumerable:!1,configurable:!0}),Cp.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.va.Ha()),t)).merge,this.va.za(t)},Cp.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.va.Ha().host&&Cr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Cp.prototype.enableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return v(t,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,wp(r)];case 1:return e=t.sent(),[4,Ep(r)];case 2:return n=t.sent(),[2,(e.Fc(!0),(t=n).Hr.delete(0),rh(t))]}})})})}(Mp(this.va))},Cp.prototype.disableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return v(t,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,wp(r)];case 1:return e=t.sent(),[4,Ep(r)];case 2:return n=t.sent(),[2,(e.Fc(!1),function(n){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return(e=n).Hr.add(0),[4,ih(e)];case 1:return t.sent(),e.Zr.set("Offline"),[2]}})})}(n))]}})})})}(Mp(this.va))},Cp.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&zc("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this._l.enableMultiTabIndexedDbPersistence(this):this._l.enableIndexedDbPersistence(this,n)},Cp.prototype.clearPersistence=function(){return this._l.clearIndexedDbPersistence(this)},Cp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.va._delete()},Cp.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new sa;return n.Ns.Ms(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=Yh,[4,Tp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Mp(this.va))},Cp.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=Mp(t),e=fa(e)?e:{next:e},i=new Tc(e);return t.wh.Ms(function(){return v(n,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ao.add(e),e.next()},[4,Ip(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.ga(),t.wh.Ms(function(){return v(n,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ao.delete(e)},[4,Ip(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.va,t)},Object.defineProperty(Cp.prototype,"app",{get:function(){if(!this.fl)throw new Gr(Fr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.fl},enumerable:!1,configurable:!0}),Cp.prototype.collection=function(t){try{return new ld(this,Vf(this.va,t))}catch(t){throw Qp(t,"collection()","Firestore.collection()")}},Cp.prototype.doc=function(t){try{return new Hp(this,Cf(this.va,t))}catch(t){throw Qp(t,"doc()","Firestore.doc()")}},Cp.prototype.collectionGroup=function(t){try{return new ad(this,function(t,e){if(Bc("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Gr(Fr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new uf(t,null,(e=e,new au(si.X(),e)))}(this.va,t))}catch(t){throw Qp(t,"collectionGroup()","Firestore.collectionGroup()")}},Cp.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new sa;return n.Ns.Ms(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,mp(n).then(function(t){return t.Wr})];case 1:return e=t.sent(),new fp(n.Ns,e,r,i).run(),[2]}})})}),i.promise}(Mp(n=this.va),function(t){return t=new Sp(n,t),e(new Wp(r,t))})},Cp.prototype.batch=function(){var e=this;return Mp(this.va),new zp(new Op(this.va,function(t){return rf(e.va,t)}))},Cp);function Cp(t,e,n){var r=this;return(r=Lp.call(this,e)||this)._l=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Rr||(r.fl=t),r}function Up(){}function jp(t,e){var n=this;return(n=Dp.call(this,t,e)||this).ah=t,n}function xp(t,e){this.ah=t,this.ll=e,this.al=Ff(t)}function Mp(t){return t.Eh||qp(t),t.Eh.sl(),t.Eh}function qp(t){var e,n,r=t.Ya(),r=(e=t.Ba,n=t.Ma,new Or(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Eh=new pp(t.Qa,t.wh,r)}var Fp,Gp,Bp,Wp=(n(Kp,Bp=Ic),Kp.prototype.get=function(t){var e=this,t=wd(t);return this.va.get(t).then(function(t){return new sd(e.ah,t)})},Kp.prototype.set=function(t,e,n){t=wd(t);return n?(Wc("Transaction.set",n),this.va.set(t,e,n)):this.va.set(t,e),this},Kp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=wd(t);return 2===arguments.length?this.va.update(o,e):(t=this.va).update.apply(t,s([o,e,n],r)),this},Kp.prototype.delete=function(t){t=wd(t);return this.va.delete(t),this},Kp),zp=(n(Yp,Gp=Ic),Yp.prototype.set=function(t,e,n){t=wd(t);return n?(Wc("WriteBatch.set",n),this.va.set(t,e,n)):this.va.set(t,e),this},Yp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=wd(t);return 2===arguments.length?this.va.update(o,e):(t=this.va).update.apply(t,s([o,e,n],r)),this},Yp.prototype.delete=function(t){t=wd(t);return this.va.delete(t),this},Yp.prototype.commit=function(){return this.va.commit()},Yp),Hp=(n(Xp,Fp=Ic),Xp.dl=function(t,e,n){if(t.length%2!=0)throw new Gr(Fr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.Y()+" has "+t.length);return new Xp(e,new sf(e.va,n,new hi(t)))},Xp.uh=function(t,e,n){return new Xp(e,new sf(e.va,n,t))},Object.defineProperty(Xp.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(Xp.prototype,"parent",{get:function(){return new ld(this.firestore,this.va.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Xp.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),Xp.prototype.collection=function(t){try{return new ld(this.firestore,Vf(this.va,t))}catch(t){throw Qp(t,"collection()","DocumentReference.collection()")}},Xp.prototype.isEqual=function(t){return t instanceof Ic&&(t=t.va),t instanceof sf&&Mf(this.va,t)},Xp.prototype.set=function(t,e){e=Wc("DocumentReference.set",e);try{return n=this.va,r=t,i=e,o=Kc(n.firestore,ql),r=bd(n.fh,r,i),rf(o,$f(Ff(o),"setDoc",n.lh,r,null!==n.fh,i).Ph(n.lh,ks.ce()))}catch(t){throw Qp(t,"setDoc()","DocumentReference.set()")}var n,r,i,o},Xp.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?ef(this.va,t):ef.apply(void 0,s([this.va,t,e],n))}catch(t){throw Qp(t,"updateDoc()","DocumentReference.update()")}},Xp.prototype.delete=function(){return rf(Kc((t=this.va).firestore,ql),[new Ys(t.lh,ks.ce())]);var t},Xp.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Jp(t),i=$p(t,function(t){return new sd(e.firestore,new zl(e.firestore.va,e.hh,t.lh,t._h,t.metadata,e.va.fh))});return nf(this.va,r,i)},Xp.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Kc(e.firestore,ql),r=Mp(n),i=new Zl(n),o=new sa;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,bp(r)];case 1:return[4,function(i,o,s){return v(this,void 0,void 0,function(){var r;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.yi.Ge(t,e)}))];case 1:return(r=t.sent())instanceof ou?s.resolve(r):r instanceof su?s.resolve(null):s.reject(new Gr(Fr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Ra(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(t.sent(),e.lh,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new zl(n,i,e.lh,t,new od(t instanceof ou&&t.ae,!0),e.fh)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Kc(e.firestore,ql),r=Mp(n),i=new sa;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,Ip(r)];case 1:return[4,Ap(t.sent(),n.wh,e.lh,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return of(n,e,t)})}:function(e){var t=this,n=Kc(e.firestore,ql),r=Mp(n),i=new sa;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,Ip(r)];case 1:return[4,Ap(t.sent(),n.wh,e.lh,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return of(n,e,t)})})(this.va).then(function(t){return new sd(e.firestore,new zl(e.firestore.va,e.hh,t.lh,t._h,t.metadata,e.va.fh))})},Xp.prototype.withConverter=function(t){return new Xp(this.firestore,this.va.withConverter(t))},Xp);function Xp(t,e){var n=this;return(n=Fp.call(this,e)||this).firestore=t,n.hh=new Ll(t),n}function Yp(){return null!==Gp&&Gp.apply(this,arguments)||this}function Kp(t,e){var n=this;return(n=Bp.call(this,e)||this).ah=t,n}function Qp(t,e,n){return t.message=t.message.replace(e,n),t}function Jp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!fa(r))return r}return{}}function $p(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=fa(t[0])?t[0]:fa(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Zp,td,ed,nd,rd,id,od=(md.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},md),sd=(n(gd,id=Ic),Object.defineProperty(gd.prototype,"ref",{get:function(){return new Hp(this.ah,this.va.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"exists",{get:function(){return this.va.exists()},enumerable:!1,configurable:!0}),gd.prototype.data=function(t){return this.va.data(t)},gd.prototype.get=function(t,e){return this.va.get(t,e)},gd.prototype.isEqual=function(t){return Jl(this.va,t.va)},gd),ud=(n(yd,rd=sd),yd.prototype.data=function(t){return this.va.data(t)},yd),ad=(n(vd,nd=Ic),vd.prototype.where=function(t,e,n){try{return new vd(this.firestore,cf(this.va,(r=n,i=e,o=jl("where",t),new yf(o,i,r))))}catch(t){throw Qp(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},vd.prototype.orderBy=function(n,t){try{return new vd(this.firestore,cf(this.va,function(t){void 0===t&&(t="asc");var e=t,t=jl("orderBy",n);return new gf(t,e)}(t)))}catch(n){throw Qp(n,/(orderBy|where)\(\)/,"Query.$1()")}},vd.prototype.limit=function(t){try{return new vd(this.firestore,cf(this.va,(Qc("limit",e=t),new mf("limit",e,"F"))))}catch(t){throw Qp(t,"limit()","Query.limit()")}var e},vd.prototype.limitToLast=function(t){try{return new vd(this.firestore,cf(this.va,(Qc("limitToLast",e=t),new mf("limitToLast",e,"L"))))}catch(t){throw Qp(t,"limitToLast()","Query.limitToLast()")}var e},vd.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new vd(this.firestore,cf(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wf("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Qp(t,"startAt()","Query.startAt()")}},vd.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new vd(this.firestore,cf(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wf("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Qp(t,"startAfter()","Query.startAfter()")}},vd.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new vd(this.firestore,cf(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bf("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Qp(t,"endBefore()","Query.endBefore()")}},vd.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new vd(this.firestore,cf(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bf("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Qp(t,"endAt()","Query.endAt()")}},vd.prototype.isEqual=function(t){return qf(this.va,t.va)},vd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Kc(e.firestore,ql),r=Mp(n),i=new Zl(n),o=new sa;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,bp(r)];case 1:return[4,function(r,i,o){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ga(r,i,!0)];case 1:return n=t.sent(),e=new _h(i,n.Ji),n=e.uu(n.documents),n=e.lu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Ra(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(t.sent(),e.Rh,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Xl(n,i,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Kc(e.firestore,ql),r=Mp(n),i=new Zl(n),o=new sa;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,Ip(r)];case 1:return[4,Np(t.sent(),n.wh,e.Rh,{source:"server"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Xl(n,i,e,t)})}:function(e){var t=this,n=Kc(e.firestore,ql),r=Mp(n),i=new Zl(n);Df(e.Rh);var o=new sa;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,Ip(r)];case 1:return[4,Np(t.sent(),n.wh,e.Rh,{source:"default"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Xl(n,i,e,t)})})(this.va).then(function(t){return new cd(e.firestore,t)})},vd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Jp(t),i=$p(t,function(t){return new cd(e.firestore,t)});return nf(this.va,r,i)},vd.prototype.withConverter=function(t){return new vd(this.firestore,this.va.withConverter(t))},vd),hd=(n(dd,ed=Ic),Object.defineProperty(dd.prototype,"type",{get:function(){return this.va.type},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"doc",{get:function(){return new ud(this.ah,this.va.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"oldIndex",{get:function(){return this.va.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"newIndex",{get:function(){return this.va.newIndex},enumerable:!1,configurable:!0}),dd),cd=(n(pd,td=Ic),Object.defineProperty(pd.prototype,"query",{get:function(){return new ad(this.ah,this.va.query)},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"size",{get:function(){return this.va.size},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"empty",{get:function(){return this.va.empty},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"docs",{get:function(){var e=this;return this.va.docs.map(function(t){return new ud(e.ah,t)})},enumerable:!1,configurable:!0}),pd.prototype.docChanges=function(t){var e=this;return this.va.docChanges(t).map(function(t){return new hd(e.ah,t)})},pd.prototype.forEach=function(e,n){var r=this;this.va.forEach(function(t){e.call(n,new ud(r.ah,t))})},pd.prototype.isEqual=function(t){return Jl(this.va,t.va)},pd),ld=(n(fd,Zp=ad),Object.defineProperty(fd.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(fd.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),Object.defineProperty(fd.prototype,"parent",{get:function(){var t=this.va.parent;return t?new Hp(this.firestore,t):null},enumerable:!1,configurable:!0}),fd.prototype.doc=function(t){try{return new Hp(this.firestore,void 0===t?Cf(this.va):Cf(this.va,t))}catch(t){throw Qp(t,"doc()","CollectionReference.doc()")}},fd.prototype.add=function(t){var e,n,r,i=this;return e=this.va,n=t,t=Kc(e.firestore,ql),r=Cf(e),n=bd(e.fh,n),rf(t,$f(Ff(e.firestore),"addDoc",r.lh,n,null!==e.fh,{}).Ph(r.lh,ks.exists(!1))).then(function(){return r}).then(function(t){return new Hp(i.firestore,t)})},fd.prototype.isEqual=function(t){return Mf(this.va,t.va)},fd.prototype.withConverter=function(t){return new fd(this.firestore,this.va.withConverter(t))},fd);function fd(t,e){var n=this;return(n=Zp.call(this,t,e)||this).firestore=t,n.va=e,n}function pd(t,e){var n=this;return(n=td.call(this,e)||this).ah=t,n}function dd(t,e){var n=this;return(n=ed.call(this,e)||this).ah=t,n}function vd(t,e){var n=this;return(n=nd.call(this,e)||this).firestore=t,n}function yd(){return null!==rd&&rd.apply(this,arguments)||this}function gd(t,e){var n=this;return(n=id.call(this,e)||this).ah=t,n}function md(t,e){this.hasPendingWrites=t,this.fromCache=e}function wd(t){return t instanceof Ic&&(t=t.va),Kc(t,sf)}function bd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Ed,Td,Id,l=(n(Od,Td=Ic),Od.documentId=function(){return new Od(ai.nt().Y())},Od.prototype.isEqual=function(t){return t instanceof Ic&&(t=t.va),t instanceof Ml&&this.va.dh.isEqual(t.dh)},Od),Ie=(n(Nd,Ed=Ic),Nd.serverTimestamp=function(){var t=new sl("serverTimestamp");return t.ba="FieldValue.serverTimestamp",new Nd(t)},Nd.delete=function(){var t=new Zc("deleteField");return t.ba="FieldValue.delete",new Nd(t)},Nd.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ul("arrayUnion",t)}.apply(void 0,t);return n.ba="FieldValue.arrayUnion",new Nd(n)},Nd.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new al("arrayRemove",t)}.apply(void 0,t);return n.ba="FieldValue.arrayRemove",new Nd(n)},Nd.increment=function(t){t=new hl("increment",t);return t.ba="FieldValue.increment",new Nd(t)},Nd.prototype.isEqual=function(t){return this.va.isEqual(t.va)},Nd),Ad={Firestore:Vp,GeoPoint:cl,Timestamp:ii,Blob:kl,Transaction:Wp,WriteBatch:zp,DocumentReference:Hp,DocumentSnapshot:sd,Query:ad,QueryDocumentSnapshot:ud,QuerySnapshot:cd,CollectionReference:ld,FieldPath:l,FieldValue:Ie,setLogLevel:function(t){Sr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function Nd(){return null!==Ed&&Ed.apply(this,arguments)||this}function Od(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Td.call(this,new(Ml.bind.apply(Ml,s([void 0],t))))||this}(Id=e.default).INTERNAL.registerComponent(new Ar("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Vp(e,new ql(e,t),new _p);var e},"PUBLIC").setServiceProps(Object.assign({},Ad))),Id.registerVersion("@firebase/firestore","2.0.4")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
